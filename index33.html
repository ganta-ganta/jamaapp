<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JamaApp - Smart Farm Management System</title>
    <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-firestore-compat.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Telugu:wght@300;400;500;600;700&family=Noto+Sans+Devanagari:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-color: #2E7D32;
            --secondary-color: #4CAF50;
            --accent-color: #FF6B35;
            --background-light: #F5F7FA;
            --background-dark: #1A1A1A;
            --text-primary: #212121;
            --text-secondary: #757575;
            --card-bg: #FFFFFF;
            --border-color: #E0E0E0;
            --success-color: #4CAF50;
            --warning-color: #FF9800;
            --error-color: #F44336;
            --info-color: #2196F3;
            --shadow: 0 4px 20px rgba(0,0,0,0.08);
            --border-radius: 16px;
            --gradient-primary: linear-gradient(135deg, #2E7D32, #4CAF50);
            --gradient-accent: linear-gradient(135deg, #FF6B35, #FF8A65);
        }

        [data-theme="dark"] {
            --background-light: #121212;
            --background-dark: #1A1A1A;
            --card-bg: #1E1E1E;
            --text-primary: #FFFFFF;
            --text-secondary: #B0B0B0;
            --border-color: #333;
            --shadow: 0 4px 20px rgba(255,255,255,0.1);
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--background-light);
            color: var(--text-primary);
            line-height: 1.6;
            transition: all 0.3s ease;
            overflow-x: hidden;
        }

        .telugu-text {
            font-family: 'Noto Sans Telugu', sans-serif;
        }

        .hindi-text {
            font-family: 'Noto Sans Devanagari', sans-serif;
        }

        /* Enhanced Loading Screen */
        .loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--gradient-primary);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            color: white;
        }

        .loading-logo {
            font-size: 3.5rem;
            font-weight: bold;
            margin-bottom: 1rem;
            animation: pulse 2s infinite;
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .loading-logo i {
            font-size: 4rem;
            animation: rotate 2s linear infinite;
        }

        .loading-progress {
            width: 280px;
            height: 8px;
            background: rgba(255,255,255,0.3);
            border-radius: 4px;
            overflow: hidden;
            margin-top: 2rem;
            position: relative;
        }

        .loading-progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #fff, #a5d6a7);
            border-radius: 4px;
            animation: loading 3s ease-in-out forwards;
        }

        @keyframes loading {
            from { width: 0%; }
            to { width: 100%; }
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.8; transform: scale(1.05); }
        }

        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes slideInRight {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        @keyframes bounceIn {
            0% { transform: scale(0.3); opacity: 0; }
            50% { transform: scale(1.05); }
            70% { transform: scale(0.9); }
            100% { transform: scale(1); opacity: 1; }
        }

        /* Enhanced Authentication */
        .auth-container {
            min-height: 100vh;
            background: var(--gradient-primary);
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 1rem;
            position: relative;
            overflow: hidden;
        }

        .auth-container::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: url('https://images.unsplash.com/photo-1574323347407-f5e1ad6d020b?w=1200&h=800&fit=crop&auto=format&q=60') center/cover;
            opacity: 0.15;
            z-index: 0;
        }

        .auth-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(15px);
            padding: 2.5rem;
            border-radius: var(--border-radius);
            box-shadow: 0 25px 50px rgba(0,0,0,0.15);
            width: 100%;
            max-width: 480px;
            text-align: center;
            position: relative;
            z-index: 1;
            animation: bounceIn 0.6s ease-out;
        }

        .auth-logo {
            font-size: 2.8rem;
            color: var(--primary-color);
            margin-bottom: 1rem;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .auth-logo i {
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        /* Enhanced Main App */
        .app-container {
            display: none;
            min-height: 100vh;
        }

        .app-header {
            background: linear-gradient(135deg, rgba(255,255,255,0.95), rgba(255,255,255,0.9));
            backdrop-filter: blur(15px);
            border-bottom: 1px solid var(--border-color);
            padding: 1rem 2rem;
            position: sticky;
            top: 0;
            z-index: 1000;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: var(--shadow);
        }

        [data-theme="dark"] .app-header {
            background: linear-gradient(135deg, rgba(30,30,30,0.95), rgba(30,30,30,0.9));
        }

        .app-logo {
            font-size: 2rem;
            font-weight: bold;
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .header-actions {
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        .location-display {
            background: rgba(46, 125, 50, 0.1);
            padding: 0.5rem 1rem;
            border-radius: 25px;
            color: var(--primary-color);
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .weather-summary {
            background: rgba(33, 150, 243, 0.1);
            padding: 0.5rem 1rem;
            border-radius: 25px;
            color: var(--info-color);
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        /* Enhanced Sidebar */
        .main-content {
            display: flex;
            min-height: calc(100vh - 80px);
        }

        .sidebar {
            width: 300px;
            background: linear-gradient(180deg, rgba(255,255,255,0.95), rgba(255,255,255,0.9));
            backdrop-filter: blur(15px);
            border-right: 1px solid var(--border-color);
            padding: 1rem 0;
            overflow-y: auto;
            box-shadow: var(--shadow);
        }

        [data-theme="dark"] .sidebar {
            background: linear-gradient(180deg, rgba(30,30,30,0.95), rgba(30,30,30,0.9));
        }

        .sidebar-nav {
            list-style: none;
            padding: 0 1rem;
        }

        .sidebar-nav li {
            margin: 0.5rem 0;
        }

        .sidebar-nav a {
            display: flex;
            align-items: center;
            padding: 1rem 1.5rem;
            color: var(--text-secondary);
            text-decoration: none;
            transition: all 0.3s ease;
            border-radius: 12px;
            position: relative;
            font-size: 1rem;
            font-weight: 500;
        }

        .sidebar-nav a:hover,
        .sidebar-nav a.active {
            background: var(--gradient-primary);
            color: white;
            transform: translateX(5px);
            box-shadow: 0 4px 15px rgba(46, 125, 50, 0.3);
        }

        .sidebar-nav i {
            margin-right: 0.75rem;
            width: 24px;
            text-align: center;
            font-size: 1.2rem;
        }

        /* Enhanced Content Area */
        .content-area {
            flex: 1;
            padding: 2rem;
            overflow-y: auto;
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
        }

        [data-theme="dark"] .content-area {
            background: linear-gradient(135deg, #1a1a1a, #2d2d2d);
        }

        /* Enhanced Cards */
        .card {
            background: var(--card-bg);
            backdrop-filter: blur(15px);
            border-radius: var(--border-radius);
            padding: 2rem;
            box-shadow: var(--shadow);
            border: 1px solid var(--border-color);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: var(--gradient-primary);
        }

        .card:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.15);
        }

        /* Enhanced Dashboard Grid */
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 2rem;
            margin-bottom: 2rem;
        }

        /* Enhanced Crop Cards */
        .crop-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(400px, 1fr));
            gap: 2rem;
        }

        .crop-card {
            position: relative;
            overflow: hidden;
            background: var(--card-bg);
            animation: fadeInUp 0.6s ease;
            border-radius: var(--border-radius);
        }

        .crop-image-container {
            position: relative;
            width: 100%;
            height: 220px;
            overflow: hidden;
            border-radius: 12px;
            margin-bottom: 1.5rem;
        }

        .crop-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.3s ease;
        }

        .crop-card:hover .crop-image {
            transform: scale(1.1);
        }

        .crop-name-overlay {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(transparent, rgba(0,0,0,0.8));
            color: white;
            padding: 1rem;
            font-size: 1.3rem;
            font-weight: 600;
        }

        .weather-forecast {
            background: linear-gradient(135deg, #74b9ff, #0984e3);
            color: white;
            padding: 1rem;
            border-radius: 12px;
            margin: 1rem 0;
            position: relative;
            overflow: hidden;
        }

        .weather-forecast::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('https://images.unsplash.com/photo-1559827260-dc66d52bef19?w=800&h=400&fit=crop&auto=format&q=60') center/cover;
            opacity: 0.2;
            z-index: 0;
        }

        .weather-forecast > * {
            position: relative;
            z-index: 1;
        }

        .forecast-days {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 0.5rem;
            margin-top: 1rem;
        }

        .forecast-day {
            text-align: center;
            background: rgba(255,255,255,0.1);
            padding: 0.5rem;
            border-radius: 8px;
            backdrop-filter: blur(10px);
        }

        .rain-detection {
            background: rgba(33, 150, 243, 0.1);
            border: 2px solid var(--info-color);
            border-radius: 12px;
            padding: 1rem;
            margin: 1rem 0;
            text-align: center;
        }

        .rain-percentage {
            font-size: 2rem;
            font-weight: bold;
            color: var(--info-color);
        }

        /* Enhanced Buttons */
        .btn {
            padding: 0.875rem 1.75rem;
            border: none;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            text-align: center;
            position: relative;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }

        .btn:hover::before {
            left: 100%;
        }

        .btn:active {
            transform: scale(0.98);
        }

        .btn-primary {
            background: var(--gradient-primary);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(46, 125, 50, 0.4);
        }

        .btn-large {
            padding: 1.25rem 2rem;
            font-size: 1.1rem;
            font-weight: 700;
            border-radius: 16px;
        }

        .btn-highlight {
            background: var(--gradient-accent);
            color: white;
            animation: pulse 2s infinite;
        }

        .action-buttons-enhanced {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            margin-top: 2rem;
        }

        .action-buttons-enhanced .btn-harvest {
            grid-column: 1 / -1;
            background: linear-gradient(135deg, #4CAF50, #66bb6a);
            color: white;
            font-size: 1.1rem;
            padding: 1rem;
            animation: glow 2s infinite alternate;
        }

        @keyframes glow {
            from { box-shadow: 0 0 5px rgba(76, 175, 80, 0.5); }
            to { box-shadow: 0 0 20px rgba(76, 175, 80, 0.8); }
        }

        /* Range Slider Enhanced */
        .range-container {
            position: relative;
            margin: 1.5rem 0;
        }

        .range-slider {
            width: 100%;
            height: 8px;
            border-radius: 4px;
            background: var(--border-color);
            outline: none;
            -webkit-appearance: none;
        }

        .range-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: var(--gradient-primary);
            cursor: pointer;
            box-shadow: 0 2px 8px rgba(46, 125, 50, 0.3);
        }

        .range-value {
            position: absolute;
            top: -40px;
            transform: translateX(-50%);
            background: var(--primary-color);
            color: white;
            padding: 0.5rem;
            border-radius: 8px;
            font-weight: bold;
            font-size: 0.9rem;
        }

        /* Ideas Section */
        .ideas-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 2rem;
        }

        .idea-card {
            background: var(--card-bg);
            border-radius: var(--border-radius);
            padding: 2rem;
            box-shadow: var(--shadow);
            border-left: 6px solid var(--primary-color);
            transition: all 0.3s ease;
        }

        .idea-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0,0,0,0.15);
        }

        .idea-category {
            display: inline-block;
            background: var(--gradient-primary);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            margin-bottom: 1rem;
        }

        .idea-icon {
            font-size: 3rem;
            color: var(--primary-color);
            margin-bottom: 1rem;
            display: block;
        }

        /* Quick Actions Menu */
        .quick-actions-menu {
            position: fixed;
            bottom: 120px;
            right: 2rem;
            background: var(--card-bg);
            border-radius: var(--border-radius);
            padding: 1rem;
            box-shadow: 0 20px 40px rgba(0,0,0,0.15);
            backdrop-filter: blur(15px);
            z-index: 2000;
            display: none;
            animation: slideInRight 0.3s ease;
        }

        .quick-actions-menu.show {
            display: block;
        }

        .quick-action-item {
            display: flex;
            align-items: center;
            padding: 1rem;
            margin: 0.5rem 0;
            border-radius: 12px;
            background: rgba(46, 125, 50, 0.1);
            color: var(--primary-color);
            text-decoration: none;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .quick-action-item:hover {
            background: var(--gradient-primary);
            color: white;
            transform: translateX(5px);
        }

        .quick-action-item i {
            font-size: 1.5rem;
            margin-right: 1rem;
            width: 30px;
            text-align: center;
        }

        /* Auto-save indicator enhanced */
        .auto-save-indicator {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--success-color);
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 25px;
            font-size: 0.9rem;
            opacity: 0;
            transform: translateY(-20px);
            transition: all 0.4s ease;
            z-index: 3000;
            box-shadow: 0 4px 15px rgba(76, 175, 80, 0.3);
        }

        .auto-save-indicator.show {
            opacity: 1;
            transform: translateY(0);
        }

        .auto-save-indicator.saving {
            background: var(--warning-color);
            box-shadow: 0 4px 15px rgba(255, 152, 0, 0.3);
        }

        /* Enhanced Mobile Navigation */
        .mobile-nav {
            display: none;
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: var(--card-bg);
            backdrop-filter: blur(15px);
            border-top: 1px solid var(--border-color);
            padding: 1rem;
            z-index: 1000;
            box-shadow: 0 -4px 20px rgba(0,0,0,0.1);
        }

        .mobile-nav-items {
            display: flex;
            justify-content: space-around;
        }

        .mobile-nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 0.75rem;
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 0.8rem;
            font-weight: 500;
            transition: all 0.3s ease;
            border-radius: 12px;
            min-width: 60px;
        }

        .mobile-nav-item.active,
        .mobile-nav-item:hover {
            color: white;
            background: var(--gradient-primary);
            transform: translateY(-3px);
            box-shadow: 0 4px 15px rgba(46, 125, 50, 0.3);
        }

        .mobile-nav-item i {
            font-size: 1.5rem;
            margin-bottom: 0.25rem;
        }

        /* Enhanced FAB */
        .fab {
            position: fixed;
            bottom: 120px;
            right: 2rem;
            width: 70px;
            height: 70px;
            border-radius: 50%;
            background: var(--gradient-primary);
            color: white;
            border: none;
            font-size: 1.8rem;
            cursor: pointer;
            box-shadow: 0 8px 25px rgba(46, 125, 50, 0.4);
            transition: all 0.3s ease;
            z-index: 999;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .fab:hover {
            transform: scale(1.1);
            box-shadow: 0 12px 30px rgba(46, 125, 50, 0.6);
        }

        .fab:active {
            transform: scale(0.95);
        }

        /* Enhanced Form Controls */
        .form-group {
            margin-bottom: 1.5rem;
            text-align: left;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.75rem;
            font-weight: 600;
            color: var(--text-primary);
            font-size: 1rem;
        }

        .form-control {
            width: 100%;
            padding: 1rem 1.25rem;
            border: 2px solid var(--border-color);
            border-radius: 12px;
            font-size: 1rem;
            transition: all 0.3s ease;
            background: rgba(255, 255, 255, 0.9);
            color: var(--text-primary);
            font-weight: 500;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 4px rgba(46, 125, 50, 0.1);
            transform: translateY(-2px);
        }

        .form-control-icon {
            position: relative;
        }

        .form-control-icon i {
            position: absolute;
            left: 1rem;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-secondary);
            z-index: 1;
        }

        .form-control-icon .form-control {
            padding-left: 3rem;
        }

        /* Enhanced Weather Widget */
        .weather-widget {
            background: var(--gradient-primary);
            color: white;
            text-align: center;
            position: relative;
            overflow: hidden;
            border-radius: var(--border-radius);
        }

        .weather-widget::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: url('https://images.unsplash.com/photo-1559827260-dc66d52bef19?w=800&h=600&fit=crop&auto=format&q=60') center/cover;
            opacity: 0.2;
            z-index: 0;
        }

        .weather-widget > * {
            position: relative;
            z-index: 1;
        }

        .weather-temp {
            font-size: 3rem;
            font-weight: bold;
            margin: 1rem 0;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .weather-desc {
            font-size: 1.1rem;
            opacity: 0.9;
            margin-bottom: 1.5rem;
        }

        .weather-details {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            margin-top: 1.5rem;
            font-size: 0.95rem;
        }

        .weather-detail-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            justify-content: center;
            background: rgba(255,255,255,0.1);
            padding: 0.75rem;
            border-radius: 8px;
            backdrop-filter: blur(10px);
        }

        /* Enhanced Progress Bars */
        .progress {
            width: 100%;
            height: 16px;
            background: var(--border-color);
            border-radius: 8px;
            overflow: hidden;
            margin: 1rem 0;
            position: relative;
        }

        .progress-bar {
            height: 100%;
            background: var(--gradient-primary);
            transition: width 0.6s ease;
            border-radius: 8px;
            position: relative;
            overflow: hidden;
        }

        .progress-bar::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            bottom: 0;
            right: 0;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        .progress-label {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.5rem;
            font-weight: 600;
        }

        /* Enhanced Modals */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.6);
            backdrop-filter: blur(8px);
            z-index: 2000;
            animation: fadeIn 0.3s ease;
        }

        .modal.active {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 1rem;
        }

        .modal-content {
            background: var(--card-bg);
            backdrop-filter: blur(15px);
            border-radius: var(--border-radius);
            padding: 2.5rem;
            width: 100%;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
            animation: bounceIn 0.4s ease;
            box-shadow: 0 25px 50px rgba(0,0,0,0.2);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid var(--border-color);
        }

        .modal-title {
            font-size: 1.6rem;
            font-weight: 700;
            color: var(--primary-color);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .close-modal {
            background: none;
            border: none;
            font-size: 2rem;
            cursor: pointer;
            color: var(--text-secondary);
            padding: 0.5rem;
            border-radius: 50%;
            transition: all 0.3s ease;
        }

        .close-modal:hover {
            background: var(--error-color);
            color: white;
            transform: scale(1.1);
        }

        /* Enhanced Stats Cards */
        .stat-card {
            text-align: center;
            padding: 2rem;
            position: relative;
            overflow: hidden;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(46, 125, 50, 0.1) 0%, transparent 70%);
            z-index: 0;
        }

        .stat-card > * {
            position: relative;
            z-index: 1;
        }

        .stat-value {
            font-size: 3rem;
            font-weight: bold;
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin: 1rem 0;
            line-height: 1.2;
        }

        .stat-label {
            color: var(--text-secondary);
            font-size: 1rem;
            font-weight: 600;
        }

        .stat-change {
            font-size: 0.9rem;
            margin-top: 1rem;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-weight: 600;
        }

        .stat-change.positive {
            color: var(--success-color);
            background: rgba(76, 175, 80, 0.1);
        }

        .stat-change.negative {
            color: var(--error-color);
            background: rgba(244, 67, 54, 0.1);
        }

        /* Enhanced Notifications */
        .notification {
            position: fixed;
            top: 1rem;
            right: 1rem;
            padding: 1.25rem 2rem;
            border-radius: 12px;
            color: white;
            font-weight: 600;
            z-index: 3000;
            animation: slideInRight 0.4s ease;
            max-width: 400px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.2);
            backdrop-filter: blur(15px);
        }

        .notification.success {
            background: linear-gradient(135deg, var(--success-color), #66bb6a);
        }

        .notification.error {
            background: linear-gradient(135deg, var(--error-color), #e57373);
        }

        .notification.warning {
            background: linear-gradient(135deg, var(--warning-color), #ffb74d);
        }

        .notification.info {
            background: linear-gradient(135deg, #2196f3, #42a5f5);
        }

        /* Enhanced Chart Container */
        .chart-container {
            position: relative;
            height: 400px;
            margin: 2rem 0;
            background: var(--card-bg);
            border-radius: 12px;
            padding: 1.5rem;
            box-shadow: var(--shadow);
        }

        /* Responsive Design Enhanced */
        @media (max-width: 1024px) {
            .sidebar {
                width: 250px;
            }
            
            .crop-grid {
                grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            }
        }

        @media (max-width: 768px) {
            .sidebar {
                display: none;
            }

            .mobile-nav {
                display: block;
            }

            .content-area {
                padding: 1rem;
                padding-bottom: 120px;
            }

            .dashboard-grid,
            .crop-grid,
            .ideas-grid {
                grid-template-columns: 1fr;
                gap: 1.5rem;
            }

            .fab {
                bottom: 140px;
                right: 1.5rem;
                width: 60px;
                height: 60px;
            }

            .quick-actions-menu {
                bottom: 140px;
                right: 1.5rem;
            }

            .modal-content {
                margin: 0.5rem;
                padding: 1.5rem;
            }

            .action-buttons-enhanced {
                grid-template-columns: 1fr;
                gap: 0.75rem;
            }

            .auth-card {
                padding: 2rem;
                margin: 1rem;
            }

            .weather-details {
                grid-template-columns: 1fr;
            }

            .header-actions {
                gap: 0.5rem;
            }

            .header-actions .location-display,
            .header-actions .weather-summary {
                display: none;
            }

            .app-header {
                padding: 1rem;
            }

            .forecast-days {
                grid-template-columns: repeat(3, 1fr);
            }

            .stat-value {
                font-size: 2.5rem;
            }
        }

        @media (max-width: 480px) {
            .auth-card {
                padding: 1.5rem;
            }

            .modal-content {
                padding: 1rem;
            }

            .app-logo {
                font-size: 1.5rem;
            }

            .weather-temp {
                font-size: 2.5rem;
            }

            .stat-value {
                font-size: 2rem;
            }

            .forecast-days {
                grid-template-columns: 1fr 1fr;
            }
        }

        /* Utility Classes Enhanced */
        .text-center { text-align: center; }
        .text-right { text-align: right; }
        .text-left { text-align: left; }
        .text-success { color: var(--success-color); }
        .text-warning { color: var(--warning-color); }
        .text-error { color: var(--error-color); }
        .text-primary { color: var(--primary-color); }
        .text-secondary { color: var(--text-secondary); }
        
        .mb-1 { margin-bottom: 0.5rem; }
        .mb-2 { margin-bottom: 1rem; }
        .mb-3 { margin-bottom: 1.5rem; }
        .mb-4 { margin-bottom: 2rem; }
        .mt-1 { margin-top: 0.5rem; }
        .mt-2 { margin-top: 1rem; }
        .mt-3 { margin-top: 1.5rem; }
        .mt-4 { margin-top: 2rem; }
        
        .p-1 { padding: 0.5rem; }
        .p-2 { padding: 1rem; }
        .p-3 { padding: 1.5rem; }
        .p-4 { padding: 2rem; }
        
        .flex { display: flex; }
        .flex-center { display: flex; justify-content: center; align-items: center; }
        .flex-between { display: flex; justify-content: space-between; align-items: center; }
        .flex-column { flex-direction: column; }
        .flex-wrap { flex-wrap: wrap; }
        
        .grid { display: grid; }
        .grid-2 { grid-template-columns: 1fr 1fr; }
        .grid-3 { grid-template-columns: 1fr 1fr 1fr; }
        .grid-4 { grid-template-columns: 1fr 1fr 1fr 1fr; }
        
        .gap-1 { gap: 0.5rem; }
        .gap-2 { gap: 1rem; }
        .gap-3 { gap: 1.5rem; }
        .gap-4 { gap: 2rem; }
        
        .w-full { width: 100%; }
        .h-full { height: 100%; }
        .hidden { display: none !important; }
        .block { display: block; }
        
        .rounded { border-radius: 8px; }
        .rounded-lg { border-radius: 12px; }
        .rounded-xl { border-radius: 16px; }
        .rounded-full { border-radius: 50%; }
        
        .shadow { box-shadow: var(--shadow); }
        .shadow-lg { box-shadow: 0 8px 30px rgba(0,0,0,0.15); }
        
        .cursor-pointer { cursor: pointer; }
        .font-bold { font-weight: 700; }
        .font-semibold { font-weight: 600; }

        /* Enhanced Empty State */
        .empty-state {
            text-align: center;
            padding: 4rem 2rem;
            color: var(--text-secondary);
        }

        .empty-state i {
            font-size: 5rem;
            margin-bottom: 2rem;
            opacity: 0.5;
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .empty-state h3 {
            color: var(--primary-color);
            margin-bottom: 1rem;
            font-size: 1.5rem;
        }

        .empty-state p {
            margin-bottom: 2rem;
            max-width: 500px;
            margin-left: auto;
            margin-right: auto;
            line-height: 1.6;
            font-size: 1.1rem;
        }
    </style>
</head>
<body>
    <!-- Auto-save indicator -->
    <div id="autoSaveIndicator" class="auto-save-indicator">
        <i class="fas fa-cloud-upload-alt"></i> <span id="saveStatus">‡§∏‡§π‡•á‡§ú‡§æ ‡§ú‡§æ ‡§∞‡§π‡§æ ‡§π‡•à...</span>
    </div>

    <!-- Loading Screen -->
    <div id="loadingScreen" class="loading-screen">
        <div class="loading-logo">
            <i class="fas fa-seedling"></i>
            JamaApp
        </div>
        <div class="loading-progress">
            <div class="loading-progress-bar"></div>
        </div>
        <p id="loadingText">‡§Ü‡§™‡§ï‡§æ ‡§∏‡•ç‡§Æ‡§æ‡§∞‡•ç‡§ü ‡§ï‡•É‡§∑‡§ø ‡§°‡•à‡§∂‡§¨‡•ã‡§∞‡•ç‡§° ‡§∂‡•Å‡§∞‡•Ç ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à...</p>
    </div>

    <!-- Authentication Container -->
    <div id="authContainer" class="auth-container">
        <div class="auth-card">
            <div class="auth-logo">
                <i class="fas fa-seedling"></i>
                JamaApp
            </div>
            <p style="margin-bottom: 2rem; color: #666; font-size: 1.1rem; font-weight: 500;" id="appSubtitle">‡§∏‡•ç‡§Æ‡§æ‡§∞‡•ç‡§ü ‡§ï‡•É‡§∑‡§ø ‡§™‡•ç‡§∞‡§¨‡§Ç‡§ß‡§® ‡§™‡•ç‡§∞‡§£‡§æ‡§≤‡•Ä</p>
            
            <!-- Login Form -->
            <div id="loginForm">
                <form id="emailLoginForm">
                    <div class="form-group">
                        <label for="loginEmail" id="emailLabel">üìß ‡§à‡§Æ‡•á‡§≤ ‡§™‡§§‡§æ</label>
                        <div class="form-control-icon">
                            <i class="fas fa-envelope"></i>
                            <input type="email" id="loginEmail" class="form-control" required placeholder="‡§Ö‡§™‡§®‡§æ ‡§à‡§Æ‡•á‡§≤ ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="loginPassword" id="passwordLabel">üîí ‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§°</label>
                        <div class="form-control-icon">
                            <i class="fas fa-lock"></i>
                            <input type="password" id="loginPassword" class="form-control" required placeholder="‡§Ö‡§™‡§®‡§æ ‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç">
                        </div>
                    </div>
                    <button type="submit" class="btn btn-primary btn-large w-full" id="signInBtn">
                        <i class="fas fa-sign-in-alt"></i> ‡§∏‡§æ‡§á‡§® ‡§á‡§® ‡§ï‡§∞‡•á‡§Ç
                    </button>
                </form>
                
                <div style="margin: 2rem 0; text-align: center; color: #666;" id="orContinue">‡§Ø‡§æ ‡§ú‡§æ‡§∞‡•Ä ‡§∞‡§ñ‡•á‡§Ç</div>
                
                <button id="googleSignIn" class="btn w-full" style="background: linear-gradient(135deg, #DB4437, #C23321); color: white; margin: 0.5rem 0;">
                    <i class="fab fa-google"></i> <span id="googleSignInText">Google ‡§ï‡•á ‡§∏‡§æ‡§• ‡§∏‡§æ‡§á‡§® ‡§á‡§® ‡§ï‡§∞‡•á‡§Ç</span>
                </button>
                
                <button id="phoneSignIn" class="btn w-full" style="background: linear-gradient(135deg, #0084FF, #0066CC); color: white; margin: 0.5rem 0;">
                    <i class="fas fa-phone"></i> <span id="phoneSignInText">‡§´‡•ã‡§® ‡§ï‡•á ‡§∏‡§æ‡§• ‡§∏‡§æ‡§á‡§® ‡§á‡§® ‡§ï‡§∞‡•á‡§Ç</span>
                </button>
                
                <p style="margin-top: 2rem; text-align: center;">
                    <span id="noAccountText">‡§ñ‡§æ‡§§‡§æ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à?</span>
                    <a href="#" id="showRegister" style="color: var(--primary-color); font-weight: 600;" id="registerLink">‡§Ø‡§π‡§æ‡§Å ‡§™‡§Ç‡§ú‡•Ä‡§ï‡§∞‡§£ ‡§ï‡§∞‡•á‡§Ç</a>
                </p>
            </div>

            <!-- Registration Form -->
            <div id="registerForm" style="display: none;">
                <form id="emailRegisterForm">
                    <div class="grid grid-2 gap-2">
                        <div class="form-group">
                            <label for="regFirstName" id="firstNameLabel">üë§ ‡§™‡§π‡§≤‡§æ ‡§®‡§æ‡§Æ</label>
                            <input type="text" id="regFirstName" class="form-control" required placeholder="‡§™‡§π‡§≤‡§æ ‡§®‡§æ‡§Æ">
                        </div>
                        <div class="form-group">
                            <label for="regLastName" id="lastNameLabel">üë§ ‡§Ö‡§Ç‡§§‡§ø‡§Æ ‡§®‡§æ‡§Æ</label>
                            <input type="text" id="regLastName" class="form-control" required placeholder="‡§Ö‡§Ç‡§§‡§ø‡§Æ ‡§®‡§æ‡§Æ">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="regEmail" id="regEmailLabel">üìß ‡§à‡§Æ‡•á‡§≤ ‡§™‡§§‡§æ</label>
                        <input type="email" id="regEmail" class="form-control" required placeholder="‡§Ö‡§™‡§®‡§æ ‡§à‡§Æ‡•á‡§≤ ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç">
                    </div>
                    <div class="form-group">
                        <label for="regPassword" id="regPasswordLabel">üîí ‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§°</label>
                        <input type="password" id="regPassword" class="form-control" required placeholder="‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° ‡§¨‡§®‡§æ‡§è‡§Ç">
                    </div>
                    <div class="form-group">
                        <label for="regPhone" id="phoneLabel">üì± ‡§´‡•ã‡§® ‡§®‡§Ç‡§¨‡§∞</label>
                        <div class="flex gap-2">
                            <div style="background: var(--primary-color); color: white; padding: 1rem; border-radius: 12px; display: flex; align-items: center; gap: 0.5rem; font-weight: 600;">
                                üáÆüá≥ +91
                            </div>
                            <input type="tel" id="regPhone" class="form-control" required placeholder="XXXXXXXXXX" pattern="[0-9]{10}">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="regLocation" id="locationLabel">üìç ‡§∏‡•ç‡§•‡§æ‡§®</label>
                        <input type="text" id="regLocation" class="form-control" required placeholder="‡§Ü‡§™‡§ï‡§æ ‡§∏‡•ç‡§•‡§æ‡§®">
                    </div>
                    <div class="grid grid-2 gap-2">
                        <div class="form-group">
                            <label for="regFarmSize" id="farmSizeLabel">üåæ ‡§ñ‡•á‡§§ ‡§ï‡§æ ‡§Ü‡§ï‡§æ‡§∞ (‡§è‡§ï‡§°‡§º)</label>
                            <input type="number" id="regFarmSize" class="form-control" step="0.1" required placeholder="0.0">
                        </div>
                        <div class="form-group">
                            <label for="regPrimaryCrop" id="primaryCropLabel">üå± ‡§Æ‡•Å‡§ñ‡•ç‡§Ø ‡§´‡§∏‡§≤</label>
                            <select id="regPrimaryCrop" class="form-control" required>
                                <option value="">‡§Æ‡•Å‡§ñ‡•ç‡§Ø ‡§´‡§∏‡§≤ ‡§ö‡•Å‡§®‡•á‡§Ç</option>
                                <option value="rice">üåæ ‡§ö‡§æ‡§µ‡§≤</option>
                                <option value="wheat">üåæ ‡§ó‡•á‡§π‡•Ç‡§Ç</option>
                                <option value="corn">üåΩ ‡§Æ‡§ï‡•ç‡§ï‡§æ</option>
                                <option value="cotton">üåø ‡§ï‡§™‡§æ‡§∏</option>
                                <option value="sugarcane">üéã ‡§ó‡§®‡•ç‡§®‡§æ</option>
                                <option value="pulses">ü´ò ‡§¶‡§æ‡§≤</option>
                                <option value="vegetables">ü•ï ‡§∏‡§¨‡•ç‡§ú‡§ø‡§Ø‡§æ‡§Ç</option>
                                <option value="fruits">üçé ‡§´‡§≤</option>
                                <option value="tobacco">üö¨ ‡§§‡§Ç‡§¨‡§æ‡§ï‡•Ç</option>
                            </select>
                        </div>
                    </div>
                    <button type="submit" class="btn btn-primary btn-large w-full" id="createAccountBtn">
                        <i class="fas fa-user-plus"></i> ‡§ñ‡§æ‡§§‡§æ ‡§¨‡§®‡§æ‡§è‡§Ç
                    </button>
                </form>
                
                <p style="margin-top: 2rem; text-align: center;">
                    <span id="haveAccountText">‡§™‡§π‡§≤‡•á ‡§∏‡•á ‡§ñ‡§æ‡§§‡§æ ‡§π‡•à?</span>
                    <a href="#" id="showLogin" style="color: var(--primary-color); font-weight: 600;" id="signInLink">‡§Ø‡§π‡§æ‡§Å ‡§∏‡§æ‡§á‡§® ‡§á‡§® ‡§ï‡§∞‡•á‡§Ç</a>
                </p>
            </div>

            <!-- Phone OTP Form -->
            <div id="otpForm" style="display: none;">
                <div class="form-group">
                    <label for="phoneNumber" id="phoneNumberLabel">üì± ‡§´‡•ã‡§® ‡§®‡§Ç‡§¨‡§∞</label>
                    <div class="flex gap-2">
                        <div style="background: var(--primary-color); color: white; padding: 1rem; border-radius: 12px; display: flex; align-items: center; gap: 0.5rem; font-weight: 600;">
                            üáÆüá≥ +91
                        </div>
                        <input type="tel" id="phoneNumber" class="form-control" placeholder="XXXXXXXXXX" pattern="[0-9]{10}">
                    </div>
                </div>
                <div id="recaptcha-container" style="margin: 1rem 0;"></div>
                <button id="sendOTP" class="btn btn-primary btn-large w-full" id="sendOTPBtn">
                    <i class="fas fa-paper-plane"></i> OTP ‡§≠‡•á‡§ú‡•á‡§Ç
                </button>
                
                <div id="otpInput" style="display: none; margin-top: 1rem;">
                    <div class="form-group">
                        <label for="otpCode" id="otpCodeLabel">üî¢ 6-‡§Ö‡§Ç‡§ï‡•Ä‡§Ø OTP ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç</label>
                        <input type="text" id="otpCode" class="form-control" maxlength="6" placeholder="123456">
                    </div>
                    <div id="otpTimer" class="text-center" style="margin-bottom: 1rem; color: #666; font-weight: 600;"></div>
                    <button id="verifyOTP" class="btn btn-primary btn-large w-full" id="verifyOTPBtn">
                        <i class="fas fa-check-circle"></i> OTP ‡§∏‡§§‡•ç‡§Ø‡§æ‡§™‡§ø‡§§ ‡§ï‡§∞‡•á‡§Ç
                    </button>
                    <button id="resendOTP" class="btn btn-secondary w-full" style="margin-top: 0.5rem;" id="resendOTPBtn">
                        <i class="fas fa-redo"></i> OTP ‡§™‡•Å‡§®‡§É ‡§≠‡•á‡§ú‡•á‡§Ç
                    </button>
                </div>
                
                <p style="margin-top: 1rem; text-align: center;">
                    <a href="#" id="backToLogin" style="color: var(--primary-color); font-weight: 600;" id="backLoginLink">‚Üê ‡§≤‡•â‡§ó‡§ø‡§® ‡§™‡§∞ ‡§µ‡§æ‡§™‡§∏</a>
                </p>
            </div>
        </div>
    </div>

    <!-- Main Application -->
    <div id="appContainer" class="app-container">
        <!-- Header -->
        <header class="app-header">
            <div class="app-logo">
                <i class="fas fa-seedling"></i>
                JamaApp
            </div>
            <div class="header-actions">
                <div class="location-display" id="currentLocation">
                    <i class="fas fa-map-marker-alt"></i>
                    <span id="locationName">‡§∏‡•ç‡§•‡§æ‡§® ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à...</span>
                </div>
                <div class="weather-summary" id="headerWeather">
                    <i class="fas fa-cloud-sun"></i>
                    <span id="headerTemp">--¬∞C</span>
                </div>
                <div>
                    <select id="languageSelect" class="form-control" style="width: auto; padding: 0.75rem; margin-right: 1rem; border-radius: 25px;">
                        <option value="hi">üáÆüá≥ ‡§π‡§ø‡§Ç‡§¶‡•Ä</option>
                        <option value="en">üá∫üá∏ English</option>
                        <option value="te">üáÆüá≥ ‡∞§‡±Ü‡∞≤‡±Å‡∞ó‡±Å</option>
                    </select>
                </div>
                <button class="btn" id="themeToggle" title="‡§•‡•Ä‡§Æ ‡§¨‡§¶‡§≤‡•á‡§Ç" style="padding: 0.75rem; border-radius: 50%; background: rgba(46, 125, 50, 0.1);">
                    <i class="fas fa-moon" style="color: var(--primary-color);"></i>
                </button>
                <button class="btn btn-primary" onclick="signOut()" style="padding: 0.75rem 1rem;">
                    <i class="fas fa-sign-out-alt"></i>
                </button>
            </div>
        </header>

        <div class="main-content">
            <!-- Sidebar Navigation -->
            <nav class="sidebar">
                <ul class="sidebar-nav">
                    <li><a href="#" onclick="showSection('dashboard')" class="active" id="nav-dashboard">
                        <i class="fas fa-tachometer-alt"></i> <span id="dashboardNav">‡§°‡•à‡§∂‡§¨‡•ã‡§∞‡•ç‡§°</span>
                    </a></li>
                    <li><a href="#" onclick="showSection('crops')" id="nav-crops">
                        <i class="fas fa-seedling"></i> <span id="cropsNav">‡§´‡§∏‡§≤ ‡§™‡•ç‡§∞‡§¨‡§Ç‡§ß‡§®</span>
                    </a></li>
                    <li><a href="#" onclick="showSection('assets')" id="nav-assets">
                        <i class="fas fa-tractor"></i> <span id="assetsNav">‡§∏‡§Ç‡§™‡§§‡•ç‡§§‡§ø ‡§™‡•ç‡§∞‡§¨‡§Ç‡§ß‡§®</span>
                    </a></li>
                    <li><a href="#" onclick="showSection('ideas')" id="nav-ideas">
                        <i class="fas fa-lightbulb"></i> <span id="ideasNav">‡§∏‡•ç‡§Æ‡§æ‡§∞‡•ç‡§ü ‡§∏‡•Å‡§ù‡§æ‡§µ</span>
                    </a></li>
                    <li><a href="#" onclick="showSection('weather')" id="nav-weather">
                        <i class="fas fa-cloud-sun"></i> <span id="weatherNav">‡§Æ‡•å‡§∏‡§Æ</span>
                    </a></li>
                    <li><a href="#" onclick="showSection('profile')" id="nav-profile">
                        <i class="fas fa-user-cog"></i> <span id="profileNav">‡§™‡•ç‡§∞‡•ã‡§´‡§º‡§æ‡§á‡§≤</span>
                    </a></li>
                </ul>
            </nav>

            <!-- Content Area -->
            <main class="content-area">
                <!-- Dashboard Section -->
                <div id="dashboard" class="section">
                    <h1 style="margin-bottom: 2rem; color: var(--primary-color); font-size: 2.5rem; font-weight: 700;">
                        <i class="fas fa-chart-line"></i> <span id="farmDashboardTitle">‡§ï‡•É‡§∑‡§ø ‡§°‡•à‡§∂‡§¨‡•ã‡§∞‡•ç‡§°</span>
                    </h1>
                    
                    <!-- Quick Stats -->
                    <div class="dashboard-grid">
                        <div class="card stat-card">
                            <i class="fas fa-rupee-sign" style="font-size: 3rem; margin-bottom: 1rem; background: var(--gradient-primary); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;"></i>
                            <div class="stat-value" id="totalIncome">‚Çπ0</div>
                            <div class="stat-label" id="totalIncomeLabel">‡§ï‡•Å‡§≤ ‡§Ü‡§Ø</div>
                            <div class="stat-change positive" id="incomeChange">‡§á‡§∏ ‡§Æ‡§π‡•Ä‡§®‡•á +0%</div>
                        </div>

                        <div class="card stat-card">
                            <i class="fas fa-credit-card" style="font-size: 3rem; margin-bottom: 1rem; color: var(--error-color);"></i>
                            <div class="stat-value" id="totalExpenses" style="color: var(--error-color);">‚Çπ0</div>
                            <div class="stat-label" id="totalExpensesLabel">‡§ï‡•Å‡§≤ ‡§ñ‡§∞‡•ç‡§ö</div>
                            <div class="stat-change negative" id="expenseChange">‡§á‡§∏ ‡§Æ‡§π‡•Ä‡§®‡•á +0%</div>
                        </div>

                        <div class="card stat-card">
                            <i class="fas fa-chart-line" style="font-size: 3rem; margin-bottom: 1rem; background: var(--gradient-primary); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;"></i>
                            <div class="stat-value" id="netProfit">‚Çπ0</div>
                            <div class="stat-label" id="netProfitLabel">‡§∂‡•Å‡§¶‡•ç‡§ß ‡§≤‡§æ‡§≠</div>
                            <div class="stat-change positive" id="profitChange">‡§á‡§∏ ‡§Æ‡§π‡•Ä‡§®‡•á +0%</div>
                        </div>

                        <div class="card stat-card">
                            <i class="fas fa-seedling" style="font-size: 3rem; margin-bottom: 1rem; background: var(--gradient-primary); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;"></i>
                            <div class="stat-value" id="activeCrops">0</div>
                            <div class="stat-label" id="activeCropsLabel">‡§∏‡§ï‡•ç‡§∞‡§ø‡§Ø ‡§´‡§∏‡§≤‡•á‡§Ç</div>
                            <div class="stat-change" id="cropsChange">0 ‡§ï‡•Å‡§≤ ‡§´‡§∏‡§≤‡•á‡§Ç</div>
                        </div>

                        <!-- Weather Widget -->
                        <div class="card weather-widget" id="weatherWidget">
                            <div style="font-size: 4rem; margin-bottom: 1rem;" id="weatherIcon">
                                <i class="fas fa-sun"></i>
                            </div>
                            <div class="weather-temp" id="weatherTemp">--¬∞C</div>
                            <div class="weather-desc" id="weatherDesc">‡§Æ‡•å‡§∏‡§Æ ‡§≤‡•ã‡§° ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à...</div>
                            <div class="weather-details">
                                <div class="weather-detail-item">
                                    <i class="fas fa-tint"></i>
                                    <span id="weatherHumidityLabel">‡§®‡§Æ‡•Ä: <span id="weatherHumidity">--%</span></span>
                                </div>
                                <div class="weather-detail-item">
                                    <i class="fas fa-wind"></i>
                                    <span id="weatherWindLabel">‡§π‡§µ‡§æ: <span id="weatherWind">-- km/h</span></span>
                                </div>
                                <div class="weather-detail-item">
                                    <i class="fas fa-cloud-rain"></i>
                                    <span id="weatherRainLabel">‡§¨‡§æ‡§∞‡§ø‡§∂: <span id="weatherRain">--%</span></span>
                                </div>
                                <div class="weather-detail-item">
                                    <i class="fas fa-thermometer-half"></i>
                                    <span id="weatherFeelsLabel">‡§Æ‡§π‡§∏‡•Ç‡§∏: <span id="weatherFeels">--¬∞C</span></span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Financial Management Section -->
                    <div class="card" style="margin-top: 2rem;">
                        <div class="flex-between mb-3">
                            <h2 style="color: var(--primary-color); font-size: 1.8rem;">
                                <i class="fas fa-coins"></i> <span id="financialManagementTitle">‡§µ‡§ø‡§§‡•ç‡§§‡•Ä‡§Ø ‡§™‡•ç‡§∞‡§¨‡§Ç‡§ß‡§®</span>
                            </h2>
                            <button class="btn btn-primary" onclick="showAddTransactionModal()">
                                <i class="fas fa-plus"></i> <span id="addTransactionBtn">‡§≤‡•á‡§®‡§¶‡•á‡§® ‡§ú‡•ã‡§°‡§º‡•á‡§Ç</span>
                            </button>
                        </div>

                        <!-- Transaction Chart -->
                        <div class="chart-container">
                            <canvas id="incomeExpenseChart"></canvas>
                        </div>

                        <!-- Recent Transactions -->
                        <div style="margin-top: 2rem;">
                            <h3 style="color: var(--primary-color); margin-bottom: 1rem;">
                                <i class="fas fa-list"></i> <span id="recentTransactionsTitle">‡§π‡§æ‡§≤ ‡§ï‡•Ä ‡§≤‡•á‡§®‡§¶‡•á‡§®</span>
                            </h3>
                            <div id="recentTransactionsList">
                                <!-- Recent transactions will be loaded here -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Crop Management Section -->
                <div id="crops" class="section hidden">
                    <div class="flex-between mb-4">
                        <h1 style="color: var(--primary-color); font-size: 2.5rem; font-weight: 700;">
                            <i class="fas fa-seedling"></i> <span id="cropManagementTitle">‡§´‡§∏‡§≤ ‡§™‡•ç‡§∞‡§¨‡§Ç‡§ß‡§®</span>
                        </h1>
                        <button class="btn btn-primary btn-large" onclick="showAddCropModal()">
                            <i class="fas fa-plus"></i> <span id="addNewCropBtn">‡§®‡§à ‡§´‡§∏‡§≤ ‡§ú‡•ã‡§°‡§º‡•á‡§Ç</span>
                        </button>
                    </div>

                    <!-- Crop Filters -->
                    <div class="card mb-3">
                        <div class="flex gap-2 flex-wrap">
                            <select id="cropStatusFilter" class="form-control" style="width: auto;" onchange="filterCrops()">
                                <option value="" id="allStatusOption">‡§∏‡§≠‡•Ä ‡§∏‡•ç‡§•‡§ø‡§§‡§ø</option>
                                <option value="active">üå± ‡§∏‡§ï‡•ç‡§∞‡§ø‡§Ø</option>
                                <option value="harvested">üåæ ‡§ï‡§ü‡§æ‡§à ‡§ï‡•Ä ‡§ó‡§à</option>
                                <option value="planned">üìÖ ‡§Ø‡•ã‡§ú‡§®‡§æ‡§¨‡§¶‡•ç‡§ß</option>
                            </select>
                            <select id="cropSeasonFilter" class="form-control" style="width: auto;" onchange="filterCrops()">
                                <option value="" id="allSeasonsOption">‡§∏‡§≠‡•Ä ‡§Ö‡§µ‡§ß‡§ø</option>
                                <option value="1">1 ‡§Æ‡§π‡•Ä‡§®‡§æ</option>
                                <option value="2">2 ‡§Æ‡§π‡•Ä‡§®‡•á</option>
                                <option value="3">3 ‡§Æ‡§π‡•Ä‡§®‡•á</option>
                                <option value="4">4 ‡§Æ‡§π‡•Ä‡§®‡•á</option>
                                <option value="5">5 ‡§Æ‡§π‡•Ä‡§®‡•á</option>
                                <option value="6">6 ‡§Æ‡§π‡•Ä‡§®‡•á</option>
                            </select>
                            <input type="text" id="cropSearchFilter" class="form-control" placeholder="üîç ‡§´‡§∏‡§≤ ‡§ñ‡•ã‡§ú‡•á‡§Ç..." style="width: auto;" oninput="filterCrops()">
                        </div>
                    </div>

                    <!-- Crop Grid -->
                    <div id="cropGrid" class="crop-grid">
                        <!-- Crops will be loaded here -->
                    </div>
                </div>

                <!-- Asset Management Section -->
                <div id="assets" class="section hidden">
                    <div class="flex-between mb-4">
                        <h1 style="color: var(--primary-color); font-size: 2.5rem; font-weight: 700;">
                            <i class="fas fa-tractor"></i> <span id="assetManagementTitle">‡§∏‡§Ç‡§™‡§§‡•ç‡§§‡§ø ‡§™‡•ç‡§∞‡§¨‡§Ç‡§ß‡§®</span>
                        </h1>
                        <button class="btn btn-primary btn-large" onclick="showAddAssetModal()">
                            <i class="fas fa-plus"></i> <span id="addAssetBtn">‡§∏‡§Ç‡§™‡§§‡•ç‡§§‡§ø ‡§ú‡•ã‡§°‡§º‡•á‡§Ç</span>
                        </button>
                    </div>

                    <!-- Asset Categories -->
                    <div class="dashboard-grid mb-4">
                        <div class="card text-center cursor-pointer" onclick="filterAssets('equipment')">
                            <i class="fas fa-tractor" style="font-size: 4rem; margin-bottom: 1.5rem; background: var(--gradient-primary); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;"></i>
                            <h3 id="equipmentTitle">‡§â‡§™‡§ï‡§∞‡§£</h3>
                            <p class="text-secondary" id="equipmentCount">0 ‡§µ‡§∏‡•ç‡§§‡•Å‡§è‡§Ç</p>
                        </div>
                        <div class="card text-center cursor-pointer" onclick="filterAssets('livestock')">
                            <i class="fas fa-horse" style="font-size: 4rem; margin-bottom: 1.5rem; background: var(--gradient-primary); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;"></i>
                            <h3 id="livestockTitle">‡§™‡§∂‡•Å‡§ß‡§®</h3>
                            <p class="text-secondary" id="livestockCount">0 ‡§™‡§∂‡•Å</p>
                        </div>
                        <div class="card text-center cursor-pointer" onclick="filterAssets('land')">
                            <i class="fas fa-map" style="font-size: 4rem; margin-bottom: 1.5rem; background: var(--gradient-primary); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;"></i>
                            <h3 id="landTitle">‡§≠‡•Ç‡§Æ‡§ø</h3>
                            <p class="text-secondary" id="landCount">0 ‡§™‡•ç‡§≤‡•â‡§ü</p>
                        </div>
                        <div class="card text-center cursor-pointer" onclick="filterAssets('inventory')">
                            <i class="fas fa-boxes" style="font-size: 4rem; margin-bottom: 1.5rem; background: var(--gradient-primary); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;"></i>
                            <h3 id="inventoryTitle">‡§≠‡§Ç‡§°‡§æ‡§∞</h3>
                            <p class="text-secondary" id="inventoryCount">0 ‡§µ‡§∏‡•ç‡§§‡•Å‡§è‡§Ç</p>
                        </div>
                    </div>

                    <!-- Asset List -->
                    <div id="assetsList" class="crop-grid">
                        <!-- Assets will be loaded here -->
                    </div>
                </div>

                <!-- Ideas Section -->
                <div id="ideas" class="section hidden">
                    <h1 style="color: var(--primary-color); font-size: 2.5rem; font-weight: 700; margin-bottom: 2rem;">
                        <i class="fas fa-lightbulb"></i> <span id="ideasTitle">‡§∏‡•ç‡§Æ‡§æ‡§∞‡•ç‡§ü ‡§ï‡•É‡§∑‡§ø ‡§∏‡•Å‡§ù‡§æ‡§µ</span>
                    </h1>
                    
                    <div class="ideas-grid" id="ideasGrid">
                        <!-- Ideas will be loaded here -->
                    </div>
                </div>

                <!-- Weather Section -->
                <div id="weather" class="section hidden">
                    <h1 style="color: var(--primary-color); font-size: 2.5rem; font-weight: 700; margin-bottom: 2rem;">
                        <i class="fas fa-cloud-sun"></i> <span id="weatherTitle">‡§Æ‡•å‡§∏‡§Æ ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä</span>
                    </h1>
                    
                    <!-- Current Weather Display -->
                    <div class="card weather-widget" id="currentWeatherDisplay">
                        <div style="font-size: 5rem; margin-bottom: 1rem;" id="currentWeatherIcon">
                            <i class="fas fa-sun"></i>
                        </div>
                        <div class="weather-temp" id="currentWeatherTemp">--¬∞C</div>
                        <div class="weather-desc" id="currentWeatherDesc">--</div>
                        <div class="weather-details">
                            <div class="weather-detail-item">
                                <i class="fas fa-tint"></i>
                                <span id="currentWeatherHumidityLabel">‡§®‡§Æ‡•Ä: <span id="currentWeatherHumidity">--%</span></span>
                            </div>
                            <div class="weather-detail-item">
                                <i class="fas fa-wind"></i>
                                <span id="currentWeatherWindLabel">‡§π‡§µ‡§æ: <span id="currentWeatherWind">-- km/h</span></span>
                            </div>
                            <div class="weather-detail-item">
                                <i class="fas fa-eye"></i>
                                <span id="currentWeatherPressureLabel">‡§¶‡§¨‡§æ‡§µ: <span id="currentWeatherPressure">-- hPa</span></span>
                            </div>
                            <div class="weather-detail-item">
                                <i class="fas fa-thermometer-half"></i>
                                <span id="currentWeatherVisibilityLabel">‡§¶‡•É‡§∂‡•ç‡§Ø‡§§‡§æ: <span id="currentWeatherVisibility">-- km</span></span>
                            </div>
                        </div>
                        
                        <!-- 5-Day Forecast -->
                        <div style="margin-top: 2rem;">
                            <h3 id="forecastTitle" style="text-align: center; margin-bottom: 1rem;">5-‡§¶‡§ø‡§® ‡§ï‡§æ ‡§™‡•Ç‡§∞‡•ç‡§µ‡§æ‡§®‡•Å‡§Æ‡§æ‡§®</h3>
                            <div class="forecast-days" id="forecastDays">
                                <!-- 5-day forecast will be loaded here -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Profile & Settings Section -->
                <div id="profile" class="section hidden">
                    <h1 style="color: var(--primary-color); font-size: 2.5rem; font-weight: 700; margin-bottom: 2rem;">
                        <i class="fas fa-user-cog"></i> <span id="profileTitle">‡§™‡•ç‡§∞‡•ã‡§´‡§º‡§æ‡§á‡§≤ ‡§î‡§∞ ‡§∏‡•á‡§ü‡§ø‡§Ç‡§ó‡•ç‡§∏</span>
                    </h1>
                    
                    <div class="dashboard-grid">
                        <!-- Profile Information -->
                        <div class="card">
                            <h3 style="margin-bottom: 1.5rem;"><i class="fas fa-user"></i> <span id="profileInfoTitle">‡§™‡•ç‡§∞‡•ã‡§´‡§º‡§æ‡§á‡§≤ ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä</span></h3>
                            <form id="profileForm">
                                <div class="form-group">
                                    <label for="profileName" id="fullNameLabel">üë§ ‡§™‡•Ç‡§∞‡§æ ‡§®‡§æ‡§Æ</label>
                                    <input type="text" id="profileName" class="form-control">
                                </div>
                                <div class="form-group">
                                    <label for="profileEmail" id="emailProfileLabel">üìß ‡§à‡§Æ‡•á‡§≤</label>
                                    <input type="email" id="profileEmail" class="form-control" readonly>
                                </div>
                                <div class="form-group">
                                    <label for="profilePhone" id="phoneProfileLabel">üì± ‡§´‡•ã‡§®</label>
                                    <input type="tel" id="profilePhone" class="form-control">
                                </div>
                                <div class="form-group">
                                    <label for="profileLocation" id="locationProfileLabel">üìç ‡§∏‡•ç‡§•‡§æ‡§®</label>
                                    <input type="text" id="profileLocation" class="form-control">
                                </div>
                                <div class="form-group">
                                    <label for="profileFarmSize" id="farmSizeProfileLabel">üåæ ‡§ñ‡•á‡§§ ‡§ï‡§æ ‡§Ü‡§ï‡§æ‡§∞ (‡§è‡§ï‡§°‡§º)</label>
                                    <input type="number" id="profileFarmSize" class="form-control" step="0.1">
                                </div>
                                <button type="submit" class="btn btn-primary">
                                    <i class="fas fa-save"></i> <span id="updateProfileBtn">‡§™‡•ç‡§∞‡•ã‡§´‡§º‡§æ‡§á‡§≤ ‡§Ö‡§™‡§°‡•á‡§ü ‡§ï‡§∞‡•á‡§Ç</span>
                                </button>
                            </form>
                        </div>

                        <!-- App Settings -->
                        <div class="card">
                            <h3 style="margin-bottom: 1.5rem;"><i class="fas fa-cog"></i> <span id="appSettingsTitle">‡§ê‡§™ ‡§∏‡•á‡§ü‡§ø‡§Ç‡§ó‡•ç‡§∏</span></h3>
                            <div class="form-group">
                                <label id="themeLabel">üåô ‡§•‡•Ä‡§Æ</label>
                                <div class="flex gap-2">
                                    <button class="btn btn-secondary" onclick="setTheme('light')">
                                        <i class="fas fa-sun"></i> <span id="lightTheme">‡§≤‡§æ‡§á‡§ü</span>
                                    </button>
                                    <button class="btn btn-secondary" onclick="setTheme('dark')">
                                        <i class="fas fa-moon"></i> <span id="darkTheme">‡§°‡§æ‡§∞‡•ç‡§ï</span>
                                    </button>
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="settingsLanguage" id="languageLabel">üåê ‡§≠‡§æ‡§∑‡§æ</label>
                                <select id="settingsLanguage" class="form-control" onchange="changeLanguage(this.value)">
                                    <option value="hi">üáÆüá≥ ‡§π‡§ø‡§Ç‡§¶‡•Ä</option>
                                    <option value="en">üá∫üá∏ English</option>
                                    <option value="te">üáÆüá≥ ‡∞§‡±Ü‡∞≤‡±Å‡∞ó‡±Å</option>
                                </select>
                            </div>
                        </div>

                        <!-- Data Management -->
                        <div class="card">
                            <h3 style="margin-bottom: 1.5rem;"><i class="fas fa-database"></i> <span id="dataManagementTitle">‡§°‡•á‡§ü‡§æ ‡§™‡•ç‡§∞‡§¨‡§Ç‡§ß‡§®</span></h3>
                            <div class="flex-column gap-2">
                                <button class="btn btn-primary" onclick="exportAllData()">
                                    <i class="fas fa-download"></i> <span id="exportDataBtn">‡§∏‡§≠‡•Ä ‡§°‡•á‡§ü‡§æ ‡§®‡§ø‡§∞‡•ç‡§Ø‡§æ‡§§ ‡§ï‡§∞‡•á‡§Ç (PDF)</span>
                                </button>
                                <button class="btn btn-secondary" onclick="backupData()">
                                    <i class="fas fa-cloud-upload-alt"></i> <span id="backupDataBtn">‡§ï‡•ç‡§≤‡§æ‡§â‡§° ‡§™‡§∞ ‡§¨‡•à‡§ï‡§Ö‡§™</span>
                                </button>
                                <button class="btn" style="background: var(--error-color); color: white;" onclick="clearAllData()">
                                    <i class="fas fa-trash"></i> <span id="clearDataBtn">‡§∏‡§≠‡•Ä ‡§°‡•á‡§ü‡§æ ‡§∏‡§æ‡§´ ‡§ï‡§∞‡•á‡§Ç</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>

        <!-- Mobile Navigation -->
        <nav class="mobile-nav">
            <div class="mobile-nav-items">
                <a href="#" onclick="showSection('dashboard')" class="mobile-nav-item active">
                    <i class="fas fa-tachometer-alt"></i>
                    <span id="dashboardMobile">‡§°‡•à‡§∂‡§¨‡•ã‡§∞‡•ç‡§°</span>
                </a>
                <a href="#" onclick="showSection('crops')" class="mobile-nav-item">
                    <i class="fas fa-seedling"></i>
                    <span id="cropsMobile">‡§´‡§∏‡§≤</span>
                </a>
                <a href="#" onclick="showSection('assets')" class="mobile-nav-item">
                    <i class="fas fa-tractor"></i>
                    <span id="assetsMobile">‡§∏‡§Ç‡§™‡§§‡•ç‡§§‡§ø</span>
                </a>
                <a href="#" onclick="showSection('ideas')" class="mobile-nav-item">
                    <i class="fas fa-lightbulb"></i>
                    <span id="ideasMobile">‡§∏‡•Å‡§ù‡§æ‡§µ</span>
                </a>
                <a href="#" onclick="showSection('profile')" class="mobile-nav-item">
                    <i class="fas fa-user"></i>
                    <span id="profileMobile">‡§™‡•ç‡§∞‡•ã‡§´‡§º‡§æ‡§á‡§≤</span>
                </a>
            </div>
        </nav>

        <!-- Floating Action Button -->
        <button class="fab" id="fabButton" onclick="showQuickActions()">
            <i class="fas fa-plus"></i>
        </button>

        <!-- Quick Actions Menu -->
        <div class="quick-actions-menu" id="quickActionsMenu">
            <a href="#" class="quick-action-item" onclick="showAddCropModal(); hideQuickActions();">
                <i class="fas fa-seedling"></i>
                <span id="quickAddCrop">‡§®‡§à ‡§´‡§∏‡§≤ ‡§ú‡•ã‡§°‡§º‡•á‡§Ç</span>
            </a>
            <a href="#" class="quick-action-item" onclick="showAddTransactionModal(); hideQuickActions();">
                <i class="fas fa-coins"></i>
                <span id="quickAddTransaction">‡§≤‡•á‡§®‡§¶‡•á‡§® ‡§ú‡•ã‡§°‡§º‡•á‡§Ç</span>
            </a>
            <a href="#" class="quick-action-item" onclick="showAddAssetModal(); hideQuickActions();">
                <i class="fas fa-tractor"></i>
                <span id="quickAddAsset">‡§∏‡§Ç‡§™‡§§‡•ç‡§§‡§ø ‡§ú‡•ã‡§°‡§º‡•á‡§Ç</span>
            </a>
            <a href="#" class="quick-action-item" onclick="showSection('weather'); hideQuickActions();">
                <i class="fas fa-cloud-sun"></i>
                <span id="quickCheckWeather">‡§Æ‡•å‡§∏‡§Æ ‡§¶‡•á‡§ñ‡•á‡§Ç</span>
            </a>
            <a href="#" class="quick-action-item" onclick="getCurrentLocationWeather(); hideQuickActions();">
                <i class="fas fa-location-arrow"></i>
                <span id="quickUpdateLocation">‡§∏‡•ç‡§•‡§æ‡§® ‡§Ö‡§™‡§°‡•á‡§ü ‡§ï‡§∞‡•á‡§Ç</span>
            </a>
        </div>
    </div>

    <!-- Modals -->
    <!-- Add Crop Modal -->
    <div id="addCropModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">
                    <i class="fas fa-seedling"></i> <span id="addCropTitle">‡§®‡§à ‡§´‡§∏‡§≤ ‡§ú‡•ã‡§°‡§º‡•á‡§Ç</span>
                </h2>
                <button class="close-modal" onclick="closeModal('addCropModal')">&times;</button>
            </div>
            <form id="addCropForm">
                <div class="grid grid-2 gap-3">
                    <div class="form-group">
                        <label for="cropName" id="cropNameLabel">üå± ‡§´‡§∏‡§≤ ‡§ï‡§æ ‡§®‡§æ‡§Æ</label>
                        <select id="cropName" class="form-control" required onchange="updateCropImage()">
                            <option value="" id="selectCropOption">‡§´‡§∏‡§≤ ‡§ö‡•Å‡§®‡•á‡§Ç</option>
                            <option value="rice" data-image="https://images.unsplash.com/photo-1586201375761-83865001e31c?w=400&h=300&fit=crop&auto=format&q=60">üåæ ‡§ö‡§æ‡§µ‡§≤</option>
                            <option value="wheat" data-image="https://images.unsplash.com/photo-1574323347407-f5e1ad6d020b?w=400&h=300&fit=crop&auto=format&q=60">üåæ ‡§ó‡•á‡§π‡•Ç‡§Ç</option>
                            <option value="corn" data-image="https://images.unsplash.com/photo-1551754655-cd27e38d2076?w=400&h=300&fit=crop&auto=format&q=60">üåΩ ‡§Æ‡§ï‡•ç‡§ï‡§æ</option>
                            <option value="tobacco" data-image="https://images.unsplash.com/photo-1544968503-7342988bbc7f?w=400&h=300&fit=crop&auto=format&q=60">üö¨ ‡§§‡§Ç‡§¨‡§æ‡§ï‡•Ç</option>
                            <option value="cotton" data-image="https://images.unsplash.com/photo-1592085189859-b372d7d1d6?w=400&h=300&fit=crop&auto=format&q=60">üåø ‡§ï‡§™‡§æ‡§∏</option>
                            <option value="sugarcane" data-image="https://images.unsplash.com/photo-1571115764595-644a1f56a55c?w=400&h=300&fit=crop&auto=format&q=60">üéã ‡§ó‡§®‡•ç‡§®‡§æ</option>
                            <option value="pulses" data-image="https://images.unsplash.com/photo-1559827260-dc66d52bef19?w=400&h=300&fit=crop&auto=format&q=60">ü´ò ‡§¶‡§æ‡§≤</option>
                            <option value="vegetables" data-image="https://images.unsplash.com/photo-1566385101042-1a0aa0c1268c?w=400&h=300&fit=crop&auto=format&q=60">ü•ï ‡§∏‡§¨‡•ç‡§ú‡§ø‡§Ø‡§æ‡§Ç</option>
                            <option value="fruits" data-image="https://images.unsplash.com/photo-1610832958506-aa56368176cf?w=400&h=300&fit=crop&auto=format&q=60">üçé ‡§´‡§≤</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="cropVariety" id="varietyLabel">üåø ‡§ï‡§ø‡§∏‡•ç‡§Æ</label>
                        <input type="text" id="cropVariety" class="form-control" placeholder="‡§ú‡•à‡§∏‡•á: ‡§¨‡§æ‡§∏‡§Æ‡§§‡•Ä, ‡§π‡§æ‡§á‡§¨‡•ç‡§∞‡§ø‡§°">
                    </div>
                </div>
                
                <!-- Crop Image Preview -->
                <div class="form-group">
                    <div id="cropImagePreview" style="display: none; text-align: center;">
                        <img id="previewImage" src="" alt="‡§´‡§∏‡§≤ ‡§ï‡•Ä ‡§õ‡§µ‡§ø" style="width: 200px; height: 150px; object-fit: cover; border-radius: 12px; box-shadow: var(--shadow);">
                    </div>
                </div>

                <div class="form-group">
                    <label for="cropArea" id="areaLabel">üìè ‡§ï‡•ç‡§∑‡•á‡§§‡•ç‡§∞‡§´‡§≤ (‡§è‡§ï‡§°‡§º)</label>
                    <div class="range-container">
                        <input type="range" id="cropAreaSlider" class="range-slider" min="0.1" max="10" step="0.1" value="1" oninput="updateAreaValue(this.value)">
                        <div class="range-value" id="areaRangeValue" style="left: 10%;">1.0</div>
                    </div>
                    <div class="flex gap-2 mt-2">
                        <input type="number" id="cropArea" class="form-control" step="0.1" required placeholder="1.0" value="1.0" oninput="updateAreaSlider(this.value)" style="width: 50%;">
                        <button type="button" class="btn btn-secondary" onclick="document.getElementById('cropArea').value = ''; document.getElementById('cropAreaSlider').value = 1; updateAreaValue(1);" style="width: 50%;">
                            <i class="fas fa-edit"></i> <span id="customAreaBtn">‡§ï‡§∏‡•ç‡§ü‡§Æ</span>
                        </button>
                    </div>
                </div>

                <div class="grid grid-2 gap-3">
                    <div class="form-group">
                        <label for="cropSeason" id="durationLabel">‚è±Ô∏è ‡§Ö‡§µ‡§ß‡§ø (‡§Æ‡§π‡•Ä‡§®‡•á)</label>
                        <select id="cropSeason" class="form-control" required onchange="updateExpectedHarvest()">
                            <option value="" id="selectDurationOption">‡§Ö‡§µ‡§ß‡§ø ‡§ö‡•Å‡§®‡•á‡§Ç</option>
                            <option value="1">1 ‡§Æ‡§π‡•Ä‡§®‡§æ</option>
                            <option value="2">2 ‡§Æ‡§π‡•Ä‡§®‡•á</option>
                            <option value="3">3 ‡§Æ‡§π‡•Ä‡§®‡•á</option>
                            <option value="4">4 ‡§Æ‡§π‡•Ä‡§®‡•á</option>
                            <option value="5">5 ‡§Æ‡§π‡•Ä‡§®‡•á</option>
                            <option value="6">6 ‡§Æ‡§π‡•Ä‡§®‡•á</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="cropLocation" id="locationCropLabel">üìç ‡§∏‡•ç‡§•‡§æ‡§®</label>
                        <input type="text" id="cropLocation" class="form-control" placeholder="‡§ñ‡•á‡§§ ‡§ï‡§æ ‡§∏‡•ç‡§•‡§æ‡§®" required>
                    </div>
                </div>

                <div class="grid grid-2 gap-3">
                    <div class="form-group">
                        <label for="sowingDate" id="sowingDateLabel">üìÖ ‡§¨‡•Å‡§Ü‡§à ‡§ï‡•Ä ‡§§‡§æ‡§∞‡•Ä‡§ñ</label>
                        <input type="date" id="sowingDate" class="form-control" required onchange="updateExpectedHarvest()">
                    </div>
                    <div class="form-group">
                        <label for="expectedHarvest" id="expectedHarvestLabel">üåæ ‡§Ö‡§™‡•á‡§ï‡•ç‡§∑‡§ø‡§§ ‡§ï‡§ü‡§æ‡§à</label>
                        <input type="date" id="expectedHarvest" class="form-control" required readonly>
                    </div>
                </div>

                <div class="grid grid-2 gap-3">
                    <div class="form-group">
                        <label for="expectedYield" id="expectedYieldLabel">‚öñÔ∏è ‡§Ö‡§™‡•á‡§ï‡•ç‡§∑‡§ø‡§§ ‡§â‡§§‡•ç‡§™‡§æ‡§¶‡§® (‡§ï‡•ç‡§µ‡§ø‡§Ç‡§ü‡§≤)</label>
                        <input type="number" id="expectedYield" class="form-control" step="0.1" placeholder="0.0">
                    </div>
                    <div class="form-group">
                        <label for="expectedPrice" id="expectedPriceLabel">üí∞ ‡§Ö‡§™‡•á‡§ï‡•ç‡§∑‡§ø‡§§ ‡§Æ‡•Ç‡§≤‡•ç‡§Ø (‚Çπ/‡§ï‡•ç‡§µ‡§ø‡§Ç‡§ü‡§≤)</label>
                        <input type="number" id="expectedPrice" class="form-control" placeholder="0">
                    </div>
                </div>

                <div class="form-group">
                    <label for="cropNotes" id="notesLabel">üìù ‡§ü‡§ø‡§™‡•ç‡§™‡§£‡•Ä (‡§µ‡•à‡§ï‡§≤‡•ç‡§™‡§ø‡§ï)</label>
                    <textarea id="cropNotes" class="form-control" rows="3" placeholder="‡§á‡§∏ ‡§´‡§∏‡§≤ ‡§ï‡•á ‡§¨‡§æ‡§∞‡•á ‡§Æ‡•á‡§Ç ‡§Ö‡§§‡§ø‡§∞‡§ø‡§ï‡•ç‡§§ ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä..."></textarea>
                </div>

                <div class="flex gap-2">
                    <button type="submit" class="btn btn-primary btn-large">
                        <i class="fas fa-save"></i> <span id="addCropSubmitBtn">‡§´‡§∏‡§≤ ‡§ú‡•ã‡§°‡§º‡•á‡§Ç</span>
                    </button>
                    <button type="button" class="btn btn-secondary" onclick="closeModal('addCropModal')">
                        <i class="fas fa-times"></i> <span id="cancelBtn">‡§∞‡§¶‡•ç‡§¶ ‡§ï‡§∞‡•á‡§Ç</span>
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add Transaction Modal -->
    <div id="addTransactionModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">
                    <i class="fas fa-plus-circle"></i> <span id="addTransactionTitle">‡§≤‡•á‡§®‡§¶‡•á‡§® ‡§ú‡•ã‡§°‡§º‡•á‡§Ç</span>
                </h2>
                <button class="close-modal" onclick="closeModal('addTransactionModal')">&times;</button>
            </div>
            <form id="addTransactionForm">
                <div class="grid grid-2 gap-3">
                    <div class="form-group">
                        <label for="transactionType" id="typeLabel">üí∞ ‡§™‡•ç‡§∞‡§ï‡§æ‡§∞</label>
                        <select id="transactionType" class="form-control" required onchange="updateTransactionCategories()">
                            <option value="" id="selectTypeOption">‡§™‡•ç‡§∞‡§ï‡§æ‡§∞ ‡§ö‡•Å‡§®‡•á‡§Ç</option>
                            <option value="income">üí∞ ‡§Ü‡§Ø</option>
                            <option value="expense">üí≥ ‡§ñ‡§∞‡•ç‡§ö</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="transactionCategory" id="categoryLabel">üè∑Ô∏è ‡§∂‡•ç‡§∞‡•á‡§£‡•Ä</label>
                        <select id="transactionCategory" class="form-control" required>
                            <option value="" id="selectCategoryOption">‡§∂‡•ç‡§∞‡•á‡§£‡•Ä ‡§ö‡•Å‡§®‡•á‡§Ç</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label for="transactionDescription" id="descriptionLabel">üìù ‡§µ‡§ø‡§µ‡§∞‡§£</label>
                    <input type="text" id="transactionDescription" class="form-control" required placeholder="‡§∏‡§Ç‡§ï‡•ç‡§∑‡§ø‡§™‡•ç‡§§ ‡§µ‡§ø‡§µ‡§∞‡§£">
                </div>
                <div class="grid grid-2 gap-3">
                    <div class="form-group">
                        <label for="transactionAmount" id="amountLabel">üí∞ ‡§∞‡§æ‡§∂‡§ø (‚Çπ)</label>
                        <input type="number" id="transactionAmount" class="form-control" step="0.01" required placeholder="0.00">
                    </div>
                    <div class="form-group">
                        <label for="transactionDate" id="dateLabel">üìÖ ‡§§‡§æ‡§∞‡•Ä‡§ñ</label>
                        <input type="date" id="transactionDate" class="form-control" required>
                    </div>
                </div>
                <div class="grid grid-2 gap-3">
                    <div class="form-group">
                        <label for="transactionPaymentMethod" id="paymentMethodLabel">üí≥ ‡§≠‡•Å‡§ó‡§§‡§æ‡§® ‡§µ‡§ø‡§ß‡§ø</label>
                        <select id="transactionPaymentMethod" class="form-control">
                            <option value="cash">üíµ ‡§®‡§ï‡§¶</option>
                            <option value="bank_transfer">üè¶ ‡§¨‡•à‡§Ç‡§ï ‡§ü‡•ç‡§∞‡§æ‡§Ç‡§∏‡§´‡§∞</option>
                            <option value="check">üìÑ ‡§ö‡•á‡§ï</option>
                            <option value="digital">üì± ‡§°‡§ø‡§ú‡§ø‡§ü‡§≤ ‡§™‡•á‡§Æ‡•á‡§Ç‡§ü</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="transactionCropId" id="relatedCropLabel">üå± ‡§∏‡§Ç‡§¨‡§Ç‡§ß‡§ø‡§§ ‡§´‡§∏‡§≤ (‡§µ‡•à‡§ï‡§≤‡•ç‡§™‡§ø‡§ï)</label>
                        <select id="transactionCropId" class="form-control">
                            <option value="" id="selectRelatedCropOption">‡§´‡§∏‡§≤ ‡§ö‡•Å‡§®‡•á‡§Ç</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label for="transactionContact" id="contactLabel">üìû ‡§∏‡§Ç‡§™‡§∞‡•ç‡§ï ‡§®‡§Ç‡§¨‡§∞ (‡§µ‡•à‡§ï‡§≤‡•ç‡§™‡§ø‡§ï)</label>
                    <input type="tel" id="transactionContact" class="form-control" placeholder="+91 XXXXXXXXXX">
                </div>
                <div class="form-group">
                    <label for="transactionNotes" id="transactionNotesLabel">üìù ‡§ü‡§ø‡§™‡•ç‡§™‡§£‡•Ä</label>
                    <textarea id="transactionNotes" class="form-control" rows="2" placeholder="‡§Ö‡§§‡§ø‡§∞‡§ø‡§ï‡•ç‡§§ ‡§ü‡§ø‡§™‡•ç‡§™‡§£‡•Ä..."></textarea>
                </div>
                <div class="flex gap-2">
                    <button type="submit" class="btn btn-primary btn-large">
                        <i class="fas fa-save"></i> <span id="addTransactionSubmitBtn">‡§≤‡•á‡§®‡§¶‡•á‡§® ‡§ú‡•ã‡§°‡§º‡•á‡§Ç</span>
                    </button>
                    <button type="button" class="btn btn-secondary" onclick="closeModal('addTransactionModal')">
                        <i class="fas fa-times"></i> <span id="cancelTransactionBtn">‡§∞‡§¶‡•ç‡§¶ ‡§ï‡§∞‡•á‡§Ç</span>
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Harvest Modal -->
    <div id="harvestModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">
                    <i class="fas fa-cut"></i> <span id="harvestTitle">‡§´‡§∏‡§≤ ‡§ï‡•Ä ‡§ï‡§ü‡§æ‡§à</span>
                </h2>
                <button class="close-modal" onclick="closeModal('harvestModal')">&times;</button>
            </div>
            <div id="harvestConfirmation" class="text-center" style="margin-bottom: 2rem;">
                <i class="fas fa-exclamation-triangle" style="font-size: 3rem; color: var(--warning-color); margin-bottom: 1rem;"></i>
                <h3 style="color: var(--warning-color); margin-bottom: 1rem;" id="harvestConfirmText">‡§ï‡•ç‡§Ø‡§æ ‡§Ü‡§™ ‡§µ‡§æ‡§ï‡§à ‡§´‡§∏‡§≤ ‡§ï‡•Ä ‡§ï‡§ü‡§æ‡§à ‡§ï‡§∞‡§®‡§æ ‡§ö‡§æ‡§π‡§§‡•á ‡§π‡•à‡§Ç?</h3>
                <p style="color: var(--text-secondary);" id="harvestConfirmDesc">‡§ï‡§ü‡§æ‡§à ‡§ï‡•á ‡§¨‡§æ‡§¶ ‡§´‡§∏‡§≤ ‡§ï‡•Ä ‡§∏‡•ç‡§•‡§ø‡§§‡§ø '‡§ï‡§ü‡§æ‡§à ‡§ï‡•Ä ‡§ó‡§à' ‡§Æ‡•á‡§Ç ‡§¨‡§¶‡§≤ ‡§ú‡§æ‡§è‡§ó‡•Ä‡•§</p>
                <div class="flex gap-2 justify-center" style="margin-top: 1.5rem;">
                    <button class="btn btn-primary" onclick="proceedToHarvest()">
                        <i class="fas fa-check"></i> <span id="yesHarvestBtn">‡§π‡§æ‡§Ç, ‡§ï‡§ü‡§æ‡§à ‡§ï‡§∞‡•á‡§Ç</span>
                    </button>
                    <button class="btn btn-secondary" onclick="closeModal('harvestModal')">
                        <i class="fas fa-times"></i> <span id="noHarvestBtn">‡§®‡§π‡•Ä‡§Ç, ‡§∞‡§¶‡•ç‡§¶ ‡§ï‡§∞‡•á‡§Ç</span>
                    </button>
                </div>
            </div>
            <form id="harvestForm" style="display: none;">
                <input type="hidden" id="harvestCropId">
                <div class="grid grid-2 gap-3">
                    <div class="form-group">
                        <label for="harvestQuantity" id="harvestQuantityLabel">‚öñÔ∏è ‡§ï‡§ü‡§æ‡§à ‡§ï‡•Ä ‡§Æ‡§æ‡§§‡•ç‡§∞‡§æ</label>
                        <input type="number" id="harvestQuantity" class="form-control" step="0.1" required placeholder="0.0">
                    </div>
                    <div class="form-group">
                        <label for="harvestUnit" id="unitLabel">üì¶ ‡§á‡§ï‡§æ‡§à</label>
                        <select id="harvestUnit" class="form-control" required>
                            <option value="quintals">‡§ï‡•ç‡§µ‡§ø‡§Ç‡§ü‡§≤</option>
                            <option value="bags">‡§¨‡•ã‡§∞‡•Ä</option>
                            <option value="tons">‡§ü‡§®</option>
                            <option value="kg">‡§ï‡§ø‡§≤‡•ã‡§ó‡•ç‡§∞‡§æ‡§Æ</option>
                        </select>
                    </div>
                </div>
                <div class="grid grid-2 gap-3">
                    <div class="form-group">
                        <label for="pricePerUnit" id="pricePerUnitLabel">üí∞ ‡§™‡•ç‡§∞‡§§‡§ø ‡§á‡§ï‡§æ‡§à ‡§Æ‡•Ç‡§≤‡•ç‡§Ø (‚Çπ)</label>
                        <input type="number" id="pricePerUnit" class="form-control" step="0.01" required placeholder="0.00" onchange="calculateHarvestTotal()">
                    </div>
                    <div class="form-group">
                        <label for="totalSaleAmount" id="totalSaleLabel">üí∞ ‡§ï‡•Å‡§≤ ‡§¨‡§ø‡§ï‡•ç‡§∞‡•Ä ‡§∞‡§æ‡§∂‡§ø (‚Çπ)</label>
                        <input type="number" id="totalSaleAmount" class="form-control" step="0.01" readonly style="background: #f0f0f0; font-weight: bold;">
                    </div>
                </div>
                <div class="form-group">
                    <label for="buyerContact" id="buyerContactLabel">üìû ‡§ñ‡§∞‡•Ä‡§¶‡§æ‡§∞ ‡§ï‡§æ ‡§∏‡§Ç‡§™‡§∞‡•ç‡§ï (‡§µ‡•à‡§ï‡§≤‡•ç‡§™‡§ø‡§ï)</label>
                    <input type="tel" id="buyerContact" class="form-control" placeholder="+91 XXXXXXXXXX">
                </div>
                <div class="form-group">
                    <label for="harvestNotes" id="harvestNotesLabel">üìù ‡§ü‡§ø‡§™‡•ç‡§™‡§£‡•Ä</label>
                    <textarea id="harvestNotes" class="form-control" rows="2" placeholder="‡§ï‡§ü‡§æ‡§à ‡§ï‡•Ä ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä, ‡§ñ‡§∞‡•Ä‡§¶‡§æ‡§∞ ‡§ï‡•Ä ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä ‡§Ü‡§¶‡§ø..."></textarea>
                </div>
                <div class="flex gap-2">
                    <button type="submit" class="btn btn-primary btn-large">
                        <i class="fas fa-check"></i> <span id="completeHarvestBtn">‡§ï‡§ü‡§æ‡§à ‡§™‡•Ç‡§∞‡•Ä ‡§ï‡§∞‡•á‡§Ç</span>
                    </button>
                    <button type="button" class="btn btn-secondary" onclick="closeModal('harvestModal')">
                        <i class="fas fa-times"></i> <span id="cancelHarvestBtn">‡§∞‡§¶‡•ç‡§¶ ‡§ï‡§∞‡•á‡§Ç</span>
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add Asset Modal -->
    <div id="addAssetModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">
                    <i class="fas fa-plus-square"></i> <span id="addAssetTitle">‡§∏‡§Ç‡§™‡§§‡•ç‡§§‡§ø ‡§ú‡•ã‡§°‡§º‡•á‡§Ç</span>
                </h2>
                <button class="close-modal" onclick="closeModal('addAssetModal')">&times;</button>
            </div>
            <form id="addAssetForm">
                <div class="grid grid-2 gap-3">
                    <div class="form-group">
                        <label for="assetType" id="assetTypeLabel">üè∑Ô∏è ‡§∏‡§Ç‡§™‡§§‡•ç‡§§‡§ø ‡§ï‡§æ ‡§™‡•ç‡§∞‡§ï‡§æ‡§∞</label>
                        <select id="assetType" class="form-control" required onchange="updateAssetFields()">
                            <option value="" id="selectAssetTypeOption">‡§™‡•ç‡§∞‡§ï‡§æ‡§∞ ‡§ö‡•Å‡§®‡•á‡§Ç</option>
                            <option value="equipment">üöú ‡§â‡§™‡§ï‡§∞‡§£</option>
                            <option value="livestock">üêÑ ‡§™‡§∂‡•Å‡§ß‡§®</option>
                            <option value="land">üåæ ‡§≠‡•Ç‡§Æ‡§ø</option>
                            <option value="inventory">üì¶ ‡§≠‡§Ç‡§°‡§æ‡§∞</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="assetName" id="assetNameLabel">üìù ‡§®‡§æ‡§Æ</label>
                        <input type="text" id="assetName" class="form-control" required placeholder="‡§∏‡§Ç‡§™‡§§‡•ç‡§§‡§ø ‡§ï‡§æ ‡§®‡§æ‡§Æ">
                    </div>
                </div>
                <div class="grid grid-2 gap-3">
                    <div class="form-group">
                        <label for="assetPurchaseDate" id="purchaseDateLabel">üìÖ ‡§ñ‡§∞‡•Ä‡§¶ ‡§§‡§æ‡§∞‡•Ä‡§ñ</label>
                        <input type="date" id="assetPurchaseDate" class="form-control">
                    </div>
                    <div class="form-group">
                        <label for="assetPurchasePrice" id="purchasePriceLabel">üí∞ ‡§ñ‡§∞‡•Ä‡§¶ ‡§Æ‡•Ç‡§≤‡•ç‡§Ø (‚Çπ)</label>
                        <input type="number" id="assetPurchasePrice" class="form-control" step="0.01" placeholder="0.00">
                    </div>
                </div>

                <!-- Equipment Fields -->
                <div id="equipmentFields" class="hidden">
                    <div class="grid grid-2 gap-3">
                        <div class="form-group">
                            <label for="equipmentCondition" id="conditionLabel">üîß ‡§∏‡•ç‡§•‡§ø‡§§‡§ø</label>
                            <select id="equipmentCondition" class="form-control">
                                <option value="excellent">‚≠ê ‡§¨‡•á‡§π‡§§‡§∞‡•Ä‡§®</option>
                                <option value="good">üëç ‡§Ö‡§ö‡•ç‡§õ‡•Ä</option>
                                <option value="fair">üÜó ‡§†‡•Ä‡§ï</option>
                                <option value="poor">üëé ‡§ñ‡§∞‡§æ‡§¨</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="equipmentMaintenanceCost" id="maintenanceLabel">üí∞ ‡§µ‡§æ‡§∞‡•ç‡§∑‡§ø‡§ï ‡§∞‡§ñ‡§∞‡§ñ‡§æ‡§µ (‚Çπ)</label>
                            <input type="number" id="equipmentMaintenanceCost" class="form-control" step="0.01" placeholder="0.00">
                        </div>
                    </div>
                </div>

                <!-- Livestock Fields -->
                <div id="livestockFields" class="hidden">
                    <div class="grid grid-3 gap-2">
                        <div class="form-group">
                            <label for="animalCount" id="countLabel">üî¢ ‡§∏‡§Ç‡§ñ‡•ç‡§Ø‡§æ</label>
                            <input type="number" id="animalCount" class="form-control" placeholder="1">
                        </div>
                        <div class="form-group">
                            <label for="animalBreed" id="breedLabel">üêÑ ‡§®‡§∏‡•ç‡§≤</label>
                            <input type="text" id="animalBreed" class="form-control" placeholder="‡§™‡§∂‡•Å ‡§ï‡•Ä ‡§®‡§∏‡•ç‡§≤">
                        </div>
                        <div class="form-group">
                            <label for="animalHealth" id="healthLabel">üíö ‡§∏‡•ç‡§µ‡§æ‡§∏‡•ç‡§•‡•ç‡§Ø ‡§∏‡•ç‡§•‡§ø‡§§‡§ø</label>
                            <select id="animalHealth" class="form-control">
                                <option value="healthy">üíö ‡§∏‡•ç‡§µ‡§∏‡•ç‡§•</option>
                                <option value="sick">ü§í ‡§¨‡•Ä‡§Æ‡§æ‡§∞</option>
                                <option value="recovering">üîÑ ‡§†‡•Ä‡§ï ‡§π‡•ã ‡§∞‡§π‡§æ</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Land Fields -->
                <div id="landFields" class="hidden">
                    <div class="grid grid-2 gap-3">
                        <div class="form-group">
                            <label for="landSize" id="sizeLabel">üìè ‡§Ü‡§ï‡§æ‡§∞ (‡§è‡§ï‡§°‡§º)</label>
                            <input type="number" id="landSize" class="form-control" step="0.1" placeholder="0.0">
                        </div>
                        <div class="form-group">
                            <label for="landType" id="landTypeLabel">üè† ‡§≠‡•Ç‡§Æ‡§ø ‡§ï‡§æ ‡§™‡•ç‡§∞‡§ï‡§æ‡§∞</label>
                            <select id="landType" class="form-control">
                                <option value="owned">üè† ‡§∏‡•ç‡§µ‡§æ‡§Æ‡§ø‡§§‡•ç‡§µ</option>
                                <option value="leased">üìÑ ‡§™‡§ü‡•ç‡§ü‡•á ‡§™‡§∞</option>
                                <option value="rented">üèòÔ∏è ‡§ï‡§ø‡§∞‡§æ‡§è ‡§™‡§∞</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Inventory Fields -->
                <div id="inventoryFields" class="hidden">
                    <div class="grid grid-2 gap-3">
                        <div class="form-group">
                            <label for="inventoryQuantity" id="quantityLabel">üî¢ ‡§Æ‡§æ‡§§‡•ç‡§∞‡§æ</label>
                            <input type="number" id="inventoryQuantity" class="form-control" step="0.1" placeholder="0.0">
                        </div>
                        <div class="form-group">
                            <label for="inventoryUnit" id="inventoryUnitLabel">üì¶ ‡§á‡§ï‡§æ‡§à</label>
                            <select id="inventoryUnit" class="form-control">
                                <option value="kg">‡§ï‡§ø‡§≤‡•ã‡§ó‡•ç‡§∞‡§æ‡§Æ</option>
                                <option value="quintals">‡§ï‡•ç‡§µ‡§ø‡§Ç‡§ü‡§≤</option>
                                <option value="tons">‡§ü‡§®</option>
                                <option value="liters">‡§≤‡•Ä‡§ü‡§∞</option>
                                <option value="pieces">‡§ü‡•Å‡§ï‡§°‡§º‡•á</option>
                                <option value="bags">‡§¨‡•ã‡§∞‡•Ä</option>
                            </select>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label for="assetNotes" id="assetNotesLabel">üìù ‡§ü‡§ø‡§™‡•ç‡§™‡§£‡•Ä</label>
                    <textarea id="assetNotes" class="form-control" rows="2" placeholder="‡§Ö‡§§‡§ø‡§∞‡§ø‡§ï‡•ç‡§§ ‡§ü‡§ø‡§™‡•ç‡§™‡§£‡•Ä..."></textarea>
                </div>
                <div class="flex gap-2">
                    <button type="submit" class="btn btn-primary btn-large">
                        <i class="fas fa-save"></i> <span id="addAssetSubmitBtn">‡§∏‡§Ç‡§™‡§§‡•ç‡§§‡§ø ‡§ú‡•ã‡§°‡§º‡•á‡§Ç</span>
                    </button>
                    <button type="button" class="btn btn-secondary" onclick="closeModal('addAssetModal')">
                        <i class="fas fa-times"></i> <span id="cancelAssetBtn">‡§∞‡§¶‡•ç‡§¶ ‡§ï‡§∞‡•á‡§Ç</span>
                    </button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyCdfgtj1gvZ-bkomW1V40h-4tyUPHy_peo",
            authDomain: "jama-3f427.firebaseapp.com",
            projectId: "jama-3f427",
            storageBucket: "jama-3f427.firebasestorage.app",
            messagingSenderId: "897112470741",
            appId: "1:897112470741:web:ee6388f0faae459fcb1e5c",
            measurementId: "G-NN1BRV0QKS"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();

        // Weather API Configuration
        const WEATHER_API_KEY = '1G7YyF7MlPU3v0bx8oAL36JWwDziEgH5'; // Replace with actual OpenWeatherMap API key
        const WEATHER_API_BASE = 'https://api.tomorrow.io/v4';

        // Global Variables
        let currentUser = null;
        let currentSection = 'dashboard';
        let currentLanguage = 'hi';
        let currentTheme = 'light';
        let otpTimer = null;
        let confirmationResult = null;
        let autoSaveInterval = null;
        let quickActionsVisible = false;

        // Storage Keys
        const STORAGE_KEYS = {
            USER_DATA: 'jama_user_data',
            CROPS: 'jama_crops',
            TRANSACTIONS: 'jama_transactions',
            ASSETS: 'jama_assets',
            LOANS: 'jama_loans',
            SETTINGS: 'jama_settings',
            WEATHER_CACHE: 'jama_weather_cache',
            LAST_SECTION: 'jama_last_section',
            IDEAS: 'jama_ideas'
        };

        // Enhanced Language Translations
        const translations = {
            hi: {
                // Loading and Auth
                smartFarmSystem: "‡§∏‡•ç‡§Æ‡§æ‡§∞‡•ç‡§ü ‡§ï‡•É‡§∑‡§ø ‡§™‡•ç‡§∞‡§¨‡§Ç‡§ß‡§® ‡§™‡•ç‡§∞‡§£‡§æ‡§≤‡•Ä",
                initializing: "‡§Ü‡§™‡§ï‡§æ ‡§∏‡•ç‡§Æ‡§æ‡§∞‡•ç‡§ü ‡§ï‡•É‡§∑‡§ø ‡§°‡•à‡§∂‡§¨‡•ã‡§∞‡•ç‡§° ‡§∂‡•Å‡§∞‡•Ç ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à...",
                emailAddress: "‡§à‡§Æ‡•á‡§≤ ‡§™‡§§‡§æ",
                password: "‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§°",
                signIn: "‡§∏‡§æ‡§á‡§® ‡§á‡§® ‡§ï‡§∞‡•á‡§Ç",
                orContinue: "‡§Ø‡§æ ‡§ú‡§æ‡§∞‡•Ä ‡§∞‡§ñ‡•á‡§Ç",
                googleSignInText: "Google ‡§ï‡•á ‡§∏‡§æ‡§• ‡§∏‡§æ‡§á‡§® ‡§á‡§® ‡§ï‡§∞‡•á‡§Ç",
                phoneSignInText: "‡§´‡•ã‡§® ‡§ï‡•á ‡§∏‡§æ‡§• ‡§∏‡§æ‡§á‡§® ‡§á‡§® ‡§ï‡§∞‡•á‡§Ç",
                noAccountText: "‡§ñ‡§æ‡§§‡§æ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à?",
                registerLink: "‡§Ø‡§π‡§æ‡§Å ‡§™‡§Ç‡§ú‡•Ä‡§ï‡§∞‡§£ ‡§ï‡§∞‡•á‡§Ç",
                
                // Registration
                firstNameLabel: "‡§™‡§π‡§≤‡§æ ‡§®‡§æ‡§Æ",
                lastNameLabel: "‡§Ö‡§Ç‡§§‡§ø‡§Æ ‡§®‡§æ‡§Æ",
                regEmailLabel: "‡§à‡§Æ‡•á‡§≤ ‡§™‡§§‡§æ",
                regPasswordLabel: "‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§°",
                phoneLabel: "‡§´‡•ã‡§® ‡§®‡§Ç‡§¨‡§∞",
                locationLabel: "‡§∏‡•ç‡§•‡§æ‡§®",
                farmSizeLabel: "‡§ñ‡•á‡§§ ‡§ï‡§æ ‡§Ü‡§ï‡§æ‡§∞ (‡§è‡§ï‡§°‡§º)",
                primaryCropLabel: "‡§Æ‡•Å‡§ñ‡•ç‡§Ø ‡§´‡§∏‡§≤",
                createAccountBtn: "‡§ñ‡§æ‡§§‡§æ ‡§¨‡§®‡§æ‡§è‡§Ç",
                haveAccountText: "‡§™‡§π‡§≤‡•á ‡§∏‡•á ‡§ñ‡§æ‡§§‡§æ ‡§π‡•à?",
                signInLink: "‡§Ø‡§π‡§æ‡§Å ‡§∏‡§æ‡§á‡§® ‡§á‡§® ‡§ï‡§∞‡•á‡§Ç",
                
                // Navigation
                dashboardNav: "‡§°‡•à‡§∂‡§¨‡•ã‡§∞‡•ç‡§°",
                cropsNav: "‡§´‡§∏‡§≤ ‡§™‡•ç‡§∞‡§¨‡§Ç‡§ß‡§®",
                assetsNav: "‡§∏‡§Ç‡§™‡§§‡•ç‡§§‡§ø ‡§™‡•ç‡§∞‡§¨‡§Ç‡§ß‡§®",
                ideasNav: "‡§∏‡•ç‡§Æ‡§æ‡§∞‡•ç‡§ü ‡§∏‡•Å‡§ù‡§æ‡§µ",
                weatherNav: "‡§Æ‡•å‡§∏‡§Æ",
                profileNav: "‡§™‡•ç‡§∞‡•ã‡§´‡§º‡§æ‡§á‡§≤",
                
                // Mobile Navigation
                dashboardMobile: "‡§°‡•à‡§∂‡§¨‡•ã‡§∞‡•ç‡§°",
                cropsMobile: "‡§´‡§∏‡§≤",
                assetsMobile: "‡§∏‡§Ç‡§™‡§§‡•ç‡§§‡§ø",
                ideasMobile: "‡§∏‡•Å‡§ù‡§æ‡§µ",
                profileMobile: "‡§™‡•ç‡§∞‡•ã‡§´‡§º‡§æ‡§á‡§≤",
                
                // Dashboard
                farmDashboardTitle: "‡§ï‡•É‡§∑‡§ø ‡§°‡•à‡§∂‡§¨‡•ã‡§∞‡•ç‡§°",
                totalIncomeLabel: "‡§ï‡•Å‡§≤ ‡§Ü‡§Ø",
                totalExpensesLabel: "‡§ï‡•Å‡§≤ ‡§ñ‡§∞‡•ç‡§ö",
                netProfitLabel: "‡§∂‡•Å‡§¶‡•ç‡§ß ‡§≤‡§æ‡§≠",
                activeCropsLabel: "‡§∏‡§ï‡•ç‡§∞‡§ø‡§Ø ‡§´‡§∏‡§≤‡•á‡§Ç",
                financialManagementTitle: "‡§µ‡§ø‡§§‡•ç‡§§‡•Ä‡§Ø ‡§™‡•ç‡§∞‡§¨‡§Ç‡§ß‡§®",
                addTransactionBtn: "‡§≤‡•á‡§®‡§¶‡•á‡§® ‡§ú‡•ã‡§°‡§º‡•á‡§Ç",
                recentTransactionsTitle: "‡§π‡§æ‡§≤ ‡§ï‡•Ä ‡§≤‡•á‡§®‡§¶‡•á‡§®",
                
                // Weather
                weatherHumidityLabel: "‡§®‡§Æ‡•Ä:",
                weatherWindLabel: "‡§π‡§µ‡§æ:",
                weatherRainLabel: "‡§¨‡§æ‡§∞‡§ø‡§∂:",
                weatherFeelsLabel: "‡§Æ‡§π‡§∏‡•Ç‡§∏:",
                currentWeatherHumidityLabel: "‡§®‡§Æ‡•Ä:",
                currentWeatherWindLabel: "‡§π‡§µ‡§æ:",
                currentWeatherPressureLabel: "‡§¶‡§¨‡§æ‡§µ:",
                currentWeatherVisibilityLabel: "‡§¶‡•É‡§∂‡•ç‡§Ø‡§§‡§æ:",
                forecastTitle: "5-‡§¶‡§ø‡§® ‡§ï‡§æ ‡§™‡•Ç‡§∞‡•ç‡§µ‡§æ‡§®‡•Å‡§Æ‡§æ‡§®",
                weatherTitle: "‡§Æ‡•å‡§∏‡§Æ ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä",
                
                // Crops
                cropManagementTitle: "‡§´‡§∏‡§≤ ‡§™‡•ç‡§∞‡§¨‡§Ç‡§ß‡§®",
                addNewCropBtn: "‡§®‡§à ‡§´‡§∏‡§≤ ‡§ú‡•ã‡§°‡§º‡•á‡§Ç",
                allStatusOption: "‡§∏‡§≠‡•Ä ‡§∏‡•ç‡§•‡§ø‡§§‡§ø",
                allSeasonsOption: "‡§∏‡§≠‡•Ä ‡§Ö‡§µ‡§ß‡§ø",
                addCropTitle: "‡§®‡§à ‡§´‡§∏‡§≤ ‡§ú‡•ã‡§°‡§º‡•á‡§Ç",
                cropNameLabel: "‡§´‡§∏‡§≤ ‡§ï‡§æ ‡§®‡§æ‡§Æ",
                selectCropOption: "‡§´‡§∏‡§≤ ‡§ö‡•Å‡§®‡•á‡§Ç",
                varietyLabel: "‡§ï‡§ø‡§∏‡•ç‡§Æ",
                areaLabel: "‡§ï‡•ç‡§∑‡•á‡§§‡•ç‡§∞‡§´‡§≤ (‡§è‡§ï‡§°‡§º)",
                customAreaBtn: "‡§ï‡§∏‡•ç‡§ü‡§Æ",
                durationLabel: "‡§Ö‡§µ‡§ß‡§ø (‡§Æ‡§π‡•Ä‡§®‡•á)",
                selectDurationOption: "‡§Ö‡§µ‡§ß‡§ø ‡§ö‡•Å‡§®‡•á‡§Ç",
                locationCropLabel: "‡§∏‡•ç‡§•‡§æ‡§®",
                sowingDateLabel: "‡§¨‡•Å‡§Ü‡§à ‡§ï‡•Ä ‡§§‡§æ‡§∞‡•Ä‡§ñ",
                expectedHarvestLabel: "‡§Ö‡§™‡•á‡§ï‡•ç‡§∑‡§ø‡§§ ‡§ï‡§ü‡§æ‡§à",
                expectedYieldLabel: "‡§Ö‡§™‡•á‡§ï‡•ç‡§∑‡§ø‡§§ ‡§â‡§§‡•ç‡§™‡§æ‡§¶‡§® (‡§ï‡•ç‡§µ‡§ø‡§Ç‡§ü‡§≤)",
                expectedPriceLabel: "‡§Ö‡§™‡•á‡§ï‡•ç‡§∑‡§ø‡§§ ‡§Æ‡•Ç‡§≤‡•ç‡§Ø (‚Çπ/‡§ï‡•ç‡§µ‡§ø‡§Ç‡§ü‡§≤)",
                notesLabel: "‡§ü‡§ø‡§™‡•ç‡§™‡§£‡•Ä (‡§µ‡•à‡§ï‡§≤‡•ç‡§™‡§ø‡§ï)",
                addCropSubmitBtn: "‡§´‡§∏‡§≤ ‡§ú‡•ã‡§°‡§º‡•á‡§Ç",
                cancelBtn: "‡§∞‡§¶‡•ç‡§¶ ‡§ï‡§∞‡•á‡§Ç",
                
                // Transactions
                addTransactionTitle: "‡§≤‡•á‡§®‡§¶‡•á‡§® ‡§ú‡•ã‡§°‡§º‡•á‡§Ç",
                typeLabel: "‡§™‡•ç‡§∞‡§ï‡§æ‡§∞",
                selectTypeOption: "‡§™‡•ç‡§∞‡§ï‡§æ‡§∞ ‡§ö‡•Å‡§®‡•á‡§Ç",
                categoryLabel: "‡§∂‡•ç‡§∞‡•á‡§£‡•Ä",
                selectCategoryOption: "‡§∂‡•ç‡§∞‡•á‡§£‡•Ä ‡§ö‡•Å‡§®‡•á‡§Ç",
                descriptionLabel: "‡§µ‡§ø‡§µ‡§∞‡§£",
                amountLabel: "‡§∞‡§æ‡§∂‡§ø (‚Çπ)",
                dateLabel: "‡§§‡§æ‡§∞‡•Ä‡§ñ",
                paymentMethodLabel: "‡§≠‡•Å‡§ó‡§§‡§æ‡§® ‡§µ‡§ø‡§ß‡§ø",
                relatedCropLabel: "‡§∏‡§Ç‡§¨‡§Ç‡§ß‡§ø‡§§ ‡§´‡§∏‡§≤ (‡§µ‡•à‡§ï‡§≤‡•ç‡§™‡§ø‡§ï)",
                selectRelatedCropOption: "‡§´‡§∏‡§≤ ‡§ö‡•Å‡§®‡•á‡§Ç",
                contactLabel: "‡§∏‡§Ç‡§™‡§∞‡•ç‡§ï ‡§®‡§Ç‡§¨‡§∞ (‡§µ‡•à‡§ï‡§≤‡•ç‡§™‡§ø‡§ï)",
                transactionNotesLabel: "‡§ü‡§ø‡§™‡•ç‡§™‡§£‡•Ä",
                addTransactionSubmitBtn: "‡§≤‡•á‡§®‡§¶‡•á‡§® ‡§ú‡•ã‡§°‡§º‡•á‡§Ç",
                cancelTransactionBtn: "‡§∞‡§¶‡•ç‡§¶ ‡§ï‡§∞‡•á‡§Ç",
                
                // Harvest
                harvestTitle: "‡§´‡§∏‡§≤ ‡§ï‡•Ä ‡§ï‡§ü‡§æ‡§à",
                harvestConfirmText: "‡§ï‡•ç‡§Ø‡§æ ‡§Ü‡§™ ‡§µ‡§æ‡§ï‡§à ‡§´‡§∏‡§≤ ‡§ï‡•Ä ‡§ï‡§ü‡§æ‡§à ‡§ï‡§∞‡§®‡§æ ‡§ö‡§æ‡§π‡§§‡•á ‡§π‡•à‡§Ç?",
                harvestConfirmDesc: "‡§ï‡§ü‡§æ‡§à ‡§ï‡•á ‡§¨‡§æ‡§¶ ‡§´‡§∏‡§≤ ‡§ï‡•Ä ‡§∏‡•ç‡§•‡§ø‡§§‡§ø '‡§ï‡§ü‡§æ‡§à ‡§ï‡•Ä ‡§ó‡§à' ‡§Æ‡•á‡§Ç ‡§¨‡§¶‡§≤ ‡§ú‡§æ‡§è‡§ó‡•Ä‡•§",
                yesHarvestBtn: "‡§π‡§æ‡§Ç, ‡§ï‡§ü‡§æ‡§à ‡§ï‡§∞‡•á‡§Ç",
                noHarvestBtn: "‡§®‡§π‡•Ä‡§Ç, ‡§∞‡§¶‡•ç‡§¶ ‡§ï‡§∞‡•á‡§Ç",
                harvestQuantityLabel: "‡§ï‡§ü‡§æ‡§à ‡§ï‡•Ä ‡§Æ‡§æ‡§§‡•ç‡§∞‡§æ",
                unitLabel: "‡§á‡§ï‡§æ‡§à",
                pricePerUnitLabel: "‡§™‡•ç‡§∞‡§§‡§ø ‡§á‡§ï‡§æ‡§à ‡§Æ‡•Ç‡§≤‡•ç‡§Ø (‚Çπ)",
                totalSaleLabel: "‡§ï‡•Å‡§≤ ‡§¨‡§ø‡§ï‡•ç‡§∞‡•Ä ‡§∞‡§æ‡§∂‡§ø (‚Çπ)",
                buyerContactLabel: "‡§ñ‡§∞‡•Ä‡§¶‡§æ‡§∞ ‡§ï‡§æ ‡§∏‡§Ç‡§™‡§∞‡•ç‡§ï (‡§µ‡•à‡§ï‡§≤‡•ç‡§™‡§ø‡§ï)",
                harvestNotesLabel: "‡§ü‡§ø‡§™‡•ç‡§™‡§£‡•Ä",
                completeHarvestBtn: "‡§ï‡§ü‡§æ‡§à ‡§™‡•Ç‡§∞‡•Ä ‡§ï‡§∞‡•á‡§Ç",
                cancelHarvestBtn: "‡§∞‡§¶‡•ç‡§¶ ‡§ï‡§∞‡•á‡§Ç",
                
                // Assets
                assetManagementTitle: "‡§∏‡§Ç‡§™‡§§‡•ç‡§§‡§ø ‡§™‡•ç‡§∞‡§¨‡§Ç‡§ß‡§®",
                addAssetBtn: "‡§∏‡§Ç‡§™‡§§‡•ç‡§§‡§ø ‡§ú‡•ã‡§°‡§º‡•á‡§Ç",
                equipmentTitle: "‡§â‡§™‡§ï‡§∞‡§£",
                livestockTitle: "‡§™‡§∂‡•Å‡§ß‡§®",
                landTitle: "‡§≠‡•Ç‡§Æ‡§ø",
                inventoryTitle: "‡§≠‡§Ç‡§°‡§æ‡§∞",
                addAssetTitle: "‡§∏‡§Ç‡§™‡§§‡•ç‡§§‡§ø ‡§ú‡•ã‡§°‡§º‡•á‡§Ç",
                assetTypeLabel: "‡§∏‡§Ç‡§™‡§§‡•ç‡§§‡§ø ‡§ï‡§æ ‡§™‡•ç‡§∞‡§ï‡§æ‡§∞",
                selectAssetTypeOption: "‡§™‡•ç‡§∞‡§ï‡§æ‡§∞ ‡§ö‡•Å‡§®‡•á‡§Ç",
                assetNameLabel: "‡§®‡§æ‡§Æ",
                purchaseDateLabel: "‡§ñ‡§∞‡•Ä‡§¶ ‡§§‡§æ‡§∞‡•Ä‡§ñ",
                purchasePriceLabel: "‡§ñ‡§∞‡•Ä‡§¶ ‡§Æ‡•Ç‡§≤‡•ç‡§Ø (‚Çπ)",
                conditionLabel: "‡§∏‡•ç‡§•‡§ø‡§§‡§ø",
                maintenanceLabel: "‡§µ‡§æ‡§∞‡•ç‡§∑‡§ø‡§ï ‡§∞‡§ñ‡§∞‡§ñ‡§æ‡§µ (‚Çπ)",
                countLabel: "‡§∏‡§Ç‡§ñ‡•ç‡§Ø‡§æ",
                breedLabel: "‡§®‡§∏‡•ç‡§≤",
                healthLabel: "‡§∏‡•ç‡§µ‡§æ‡§∏‡•ç‡§•‡•ç‡§Ø ‡§∏‡•ç‡§•‡§ø‡§§‡§ø",
                sizeLabel: "‡§Ü‡§ï‡§æ‡§∞ (‡§è‡§ï‡§°‡§º)",
                landTypeLabel: "‡§≠‡•Ç‡§Æ‡§ø ‡§ï‡§æ ‡§™‡•ç‡§∞‡§ï‡§æ‡§∞",
                quantityLabel: "‡§Æ‡§æ‡§§‡•ç‡§∞‡§æ",
                inventoryUnitLabel: "‡§á‡§ï‡§æ‡§à",
                assetNotesLabel: "‡§ü‡§ø‡§™‡•ç‡§™‡§£‡•Ä",
                addAssetSubmitBtn: "‡§∏‡§Ç‡§™‡§§‡•ç‡§§‡§ø ‡§ú‡•ã‡§°‡§º‡•á‡§Ç",
                cancelAssetBtn: "‡§∞‡§¶‡•ç‡§¶ ‡§ï‡§∞‡•á‡§Ç",
                
                // Ideas
                ideasTitle: "‡§∏‡•ç‡§Æ‡§æ‡§∞‡•ç‡§ü ‡§ï‡•É‡§∑‡§ø ‡§∏‡•Å‡§ù‡§æ‡§µ",
                
                // Profile
                profileTitle: "‡§™‡•ç‡§∞‡•ã‡§´‡§º‡§æ‡§á‡§≤ ‡§î‡§∞ ‡§∏‡•á‡§ü‡§ø‡§Ç‡§ó‡•ç‡§∏",
                profileInfoTitle: "‡§™‡•ç‡§∞‡•ã‡§´‡§º‡§æ‡§á‡§≤ ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä",
                fullNameLabel: "‡§™‡•Ç‡§∞‡§æ ‡§®‡§æ‡§Æ",
                emailProfileLabel: "‡§à‡§Æ‡•á‡§≤",
                phoneProfileLabel: "‡§´‡•ã‡§®",
                locationProfileLabel: "‡§∏‡•ç‡§•‡§æ‡§®",
                farmSizeProfileLabel: "‡§ñ‡•á‡§§ ‡§ï‡§æ ‡§Ü‡§ï‡§æ‡§∞ (‡§è‡§ï‡§°‡§º)",
                updateProfileBtn: "‡§™‡•ç‡§∞‡•ã‡§´‡§º‡§æ‡§á‡§≤ ‡§Ö‡§™‡§°‡•á‡§ü ‡§ï‡§∞‡•á‡§Ç",
                appSettingsTitle: "‡§ê‡§™ ‡§∏‡•á‡§ü‡§ø‡§Ç‡§ó‡•ç‡§∏",
                themeLabel: "‡§•‡•Ä‡§Æ",
                lightTheme: "‡§≤‡§æ‡§á‡§ü",
                darkTheme: "‡§°‡§æ‡§∞‡•ç‡§ï",
                languageLabel: "‡§≠‡§æ‡§∑‡§æ",
                dataManagementTitle: "‡§°‡•á‡§ü‡§æ ‡§™‡•ç‡§∞‡§¨‡§Ç‡§ß‡§®",
                exportDataBtn: "‡§∏‡§≠‡•Ä ‡§°‡•á‡§ü‡§æ ‡§®‡§ø‡§∞‡•ç‡§Ø‡§æ‡§§ ‡§ï‡§∞‡•á‡§Ç (PDF)",
                backupDataBtn: "‡§ï‡•ç‡§≤‡§æ‡§â‡§° ‡§™‡§∞ ‡§¨‡•à‡§ï‡§Ö‡§™",
                clearDataBtn: "‡§∏‡§≠‡•Ä ‡§°‡•á‡§ü‡§æ ‡§∏‡§æ‡§´ ‡§ï‡§∞‡•á‡§Ç",
                
                // Quick Actions
                quickAddCrop: "‡§®‡§à ‡§´‡§∏‡§≤ ‡§ú‡•ã‡§°‡§º‡•á‡§Ç",
                quickAddTransaction: "‡§≤‡•á‡§®‡§¶‡•á‡§® ‡§ú‡•ã‡§°‡§º‡•á‡§Ç",
                quickAddAsset: "‡§∏‡§Ç‡§™‡§§‡•ç‡§§‡§ø ‡§ú‡•ã‡§°‡§º‡•á‡§Ç",
                quickCheckWeather: "‡§Æ‡•å‡§∏‡§Æ ‡§¶‡•á‡§ñ‡•á‡§Ç",
                quickUpdateLocation: "‡§∏‡•ç‡§•‡§æ‡§® ‡§Ö‡§™‡§°‡•á‡§ü ‡§ï‡§∞‡•á‡§Ç",
                
                // Common
                saving: "‡§∏‡§π‡•á‡§ú‡§æ ‡§ú‡§æ ‡§∞‡§π‡§æ ‡§π‡•à...",
                saved: "‡§∏‡§π‡•á‡§ú ‡§¶‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ",
                loading: "‡§≤‡•ã‡§° ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à...",
                error: "‡§§‡•ç‡§∞‡•Å‡§ü‡§ø",
                success: "‡§∏‡§´‡§≤",
                confirm: "‡§™‡•Å‡§∑‡•ç‡§ü‡§ø ‡§ï‡§∞‡•á‡§Ç",
                delete: "‡§π‡§ü‡§æ‡§è‡§Ç",
                edit: "‡§∏‡§Ç‡§™‡§æ‡§¶‡§ø‡§§ ‡§ï‡§∞‡•á‡§Ç",
                view: "‡§¶‡•á‡§ñ‡•á‡§Ç",
                add: "‡§ú‡•ã‡§°‡§º‡•á‡§Ç",
                update: "‡§Ö‡§™‡§°‡•á‡§ü ‡§ï‡§∞‡•á‡§Ç",
                close: "‡§¨‡§Ç‡§¶ ‡§ï‡§∞‡•á‡§Ç",
                yes: "‡§π‡§æ‡§Ç",
                no: "‡§®‡§π‡•Ä‡§Ç"
            },
            en: {
                // Loading and Auth
                smartFarmSystem: "Smart Farm Management System",
                initializing: "Initializing your smart farm dashboard...",
                emailAddress: "Email Address",
                password: "Password",
                signIn: "Sign In",
                orContinue: "or continue with",
                googleSignInText: "Sign in with Google",
                phoneSignInText: "Sign in with Phone",
                noAccountText: "Don't have an account?",
                registerLink: "Register here",
                
                // Registration
                firstNameLabel: "First Name",
                lastNameLabel: "Last Name",
                regEmailLabel: "Email Address",
                regPasswordLabel: "Password",
                phoneLabel: "Phone Number",
                locationLabel: "Location",
                farmSizeLabel: "Farm Size (acres)",
                primaryCropLabel: "Primary Crop",
                createAccountBtn: "Create Account",
                haveAccountText: "Already have an account?",
                signInLink: "Sign in here",
                
                // Navigation
                dashboardNav: "Dashboard",
                cropsNav: "Crop Management",
                assetsNav: "Asset Management",
                ideasNav: "Smart Ideas",
                weatherNav: "Weather",
                profileNav: "Profile",
                
                // Mobile Navigation
                dashboardMobile: "Dashboard",
                cropsMobile: "Crops",
                assetsMobile: "Assets",
                ideasMobile: "Ideas",
                profileMobile: "Profile",
                
                // Dashboard
                farmDashboardTitle: "Farm Dashboard",
                totalIncomeLabel: "Total Income",
                totalExpensesLabel: "Total Expenses",
                netProfitLabel: "Net Profit",
                activeCropsLabel: "Active Crops",
                financialManagementTitle: "Financial Management",
                addTransactionBtn: "Add Transaction",
                recentTransactionsTitle: "Recent Transactions",
                
                // Weather
                weatherHumidityLabel: "Humidity:",
                weatherWindLabel: "Wind:",
                weatherRainLabel: "Rain:",
                weatherFeelsLabel: "Feels Like:",
                currentWeatherHumidityLabel: "Humidity:",
                currentWeatherWindLabel: "Wind:",
                currentWeatherPressureLabel: "Pressure:",
                currentWeatherVisibilityLabel: "Visibility:",
                forecastTitle: "5-Day Forecast",
                weatherTitle: "Weather Information",
                
                // Crops
                cropManagementTitle: "Crop Management",
                addNewCropBtn: "Add New Crop",
                allStatusOption: "All Status",
                allSeasonsOption: "All Seasons",
                addCropTitle: "Add New Crop",
                cropNameLabel: "Crop Name",
                selectCropOption: "Select Crop",
                varietyLabel: "Variety",
                areaLabel: "Area (acres)",
                customAreaBtn: "Custom",
                durationLabel: "Duration (months)",
                selectDurationOption: "Select Duration",
                locationCropLabel: "Location",
                sowingDateLabel: "Sowing Date",
                expectedHarvestLabel: "Expected Harvest",
                expectedYieldLabel: "Expected Yield (quintals)",
                expectedPriceLabel: "Expected Price (‚Çπ/quintal)",
                notesLabel: "Notes (optional)",
                addCropSubmitBtn: "Add Crop",
                cancelBtn: "Cancel",
                
                // Other translations would continue here...
                // For brevity, I'm showing the pattern. The full translation object would include all terms.
            },
            te: {
                // Telugu translations would follow the same pattern
                smartFarmSystem: "‡∞∏‡±ç‡∞Æ‡∞æ‡∞∞‡±ç‡∞ü‡±ç ‡∞µ‡±ç‡∞Ø‡∞µ‡∞∏‡∞æ‡∞Ø ‡∞®‡∞ø‡∞∞‡±ç‡∞µ‡∞π‡∞£ ‡∞µ‡±ç‡∞Ø‡∞µ‡∞∏‡±ç‡∞•",
                initializing: "‡∞Æ‡±Ä ‡∞∏‡±ç‡∞Æ‡∞æ‡∞∞‡±ç‡∞ü‡±ç ‡∞µ‡±ç‡∞Ø‡∞µ‡∞∏‡∞æ‡∞Ø ‡∞°‡∞æ‡∞∑‡±ç‚Äå‡∞¨‡±ã‡∞∞‡±ç‡∞°‡±ç‚Äå‡∞®‡±Å ‡∞™‡±ç‡∞∞‡∞æ‡∞∞‡∞Ç‡∞≠‡∞ø‡∞∏‡±ç‡∞§‡±ã‡∞Ç‡∞¶‡∞ø...",
                // ... other translations
            }
        };

        // Initialize App
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
        });

        function initializeApp() {
            // Show loading screen
            setTimeout(() => {
                document.getElementById('loadingScreen').style.display = 'none';
                checkAuthState();
            }, 3000);

            // Initialize event listeners
            initializeEventListeners();
            
            // Load settings
            loadSettings();
            
            // Initialize auto-save
            initializeAutoSave();
            
            // Apply initial language and translations
            applyTranslations();
            
            // Initialize geolocation and weather
            getCurrentLocationWeather();
        }

        function initializeEventListeners() {
            // Authentication form handlers
            document.getElementById('emailLoginForm').addEventListener('submit', handleEmailLogin);
            document.getElementById('emailRegisterForm').addEventListener('submit', handleEmailRegister);
            document.getElementById('googleSignIn').addEventListener('click', handleGoogleSignIn);
            document.getElementById('phoneSignIn').addEventListener('click', showPhoneAuth);
            document.getElementById('sendOTP').addEventListener('click', handleSendOTP);
            document.getElementById('verifyOTP').addEventListener('click', handleVerifyOTP);
            document.getElementById('resendOTP').addEventListener('click', handleResendOTP);
            
            // Form toggle handlers
            document.getElementById('showRegister').addEventListener('click', (e) => {
                e.preventDefault();
                toggleAuthForm('register');
            });
            document.getElementById('showLogin').addEventListener('click', (e) => {
                e.preventDefault();
                toggleAuthForm('login');
            });
            document.getElementById('backToLogin').addEventListener('click', (e) => {
                e.preventDefault();
                toggleAuthForm('login');
            });

            // Theme and language handlers
            document.getElementById('themeToggle').addEventListener('click', toggleTheme);
            document.getElementById('languageSelect').addEventListener('change', (e) => {
                changeLanguage(e.target.value);
            });

            // Form handlers
            document.getElementById('addCropForm').addEventListener('submit', handleAddCrop);
            document.getElementById('addTransactionForm').addEventListener('submit', handleAddTransaction);
            document.getElementById('addAssetForm').addEventListener('submit', handleAddAsset);
            document.getElementById('profileForm').addEventListener('submit', handleUpdateProfile);
            document.getElementById('harvestForm').addEventListener('submit', handleHarvest);

            // Auto-calculate harvest total
            document.getElementById('harvestQuantity').addEventListener('input', calculateHarvestTotal);
            document.getElementById('pricePerUnit').addEventListener('input', calculateHarvestTotal);

            // Auto-calculate expected harvest date
            document.getElementById('cropSeason').addEventListener('change', updateExpectedHarvest);
            document.getElementById('sowingDate').addEventListener('change', updateExpectedHarvest);

            // Phone number formatting
            document.getElementById('regPhone').addEventListener('input', formatPhoneNumber);
            document.getElementById('phoneNumber').addEventListener('input', formatPhoneNumber);

            // Close modals when clicking outside
            document.addEventListener('click', (e) => {
                if (e.target.classList.contains('modal')) {
                    closeModal(e.target.id);
                }
                
                // Close quick actions menu when clicking outside
                if (quickActionsVisible && !e.target.closest('.fab') && !e.target.closest('.quick-actions-menu')) {
                    hideQuickActions();
                }
            });

            // Set default dates
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('sowingDate').value = today;
            document.getElementById('transactionDate').value = today;
        }

        function formatPhoneNumber(e) {
            let value = e.target.value.replace(/\D/g, '');
            if (value.length > 10) value = value.substring(0, 10);
            e.target.value = value;
        }

        function initializeAutoSave() {
            // Auto-save every 30 seconds when user is active
            autoSaveInterval = setInterval(() => {
                if (currentUser) {
                    autoSaveToFirebase();
                }
            }, 30000);

            // Auto-save on data changes
            const dataChangeEvents = ['change', 'input'];
            dataChangeEvents.forEach(eventType => {
                document.addEventListener(eventType, (e) => {
                    if (e.target.classList.contains('form-control') && currentUser) {
                        debounceAutoSave();
                    }
                });
            });
        }

        let autoSaveTimeout;
        function debounceAutoSave() {
            clearTimeout(autoSaveTimeout);
            autoSaveTimeout = setTimeout(() => {
                autoSaveToFirebase();
            }, 2000);
        }

        async function autoSaveToFirebase() {
            if (!currentUser || !currentUser.uid) return;

            const indicator = document.getElementById('autoSaveIndicator');
            const saveStatus = document.getElementById('saveStatus');
            
            indicator.classList.add('show', 'saving');
            saveStatus.innerHTML = '<i class="fas fa-sync fa-spin"></i> ‡§∏‡§π‡•á‡§ú‡§æ ‡§ú‡§æ ‡§∞‡§π‡§æ ‡§π‡•à...';
            
            try {
                // Save all data to Firebase
                const crops = JSON.parse(localStorage.getItem(STORAGE_KEYS.CROPS) || '[]');
                const transactions = JSON.parse(localStorage.getItem(STORAGE_KEYS.TRANSACTIONS) || '[]');
                const assets = JSON.parse(localStorage.getItem(STORAGE_KEYS.ASSETS) || '[]');
                const ideas = JSON.parse(localStorage.getItem(STORAGE_KEYS.IDEAS) || '[]');
                const settings = JSON.parse(localStorage.getItem(STORAGE_KEYS.SETTINGS) || '{}');

                // Batch save to Firebase
                const batch = db.batch();
                
                // Save user data
                const userRef = db.collection('userData').doc(currentUser.uid);
                batch.set(userRef, {
                    crops,
                    transactions,
                    assets,
                    ideas,
                    settings,
                    lastSaved: firebase.firestore.FieldValue.serverTimestamp()
                }, { merge: true });

                await batch.commit();

                indicator.classList.remove('saving');
                saveStatus.innerHTML = '<i class="fas fa-cloud-upload-alt"></i> ‡§ï‡•ç‡§≤‡§æ‡§â‡§° ‡§™‡§∞ ‡§∏‡§π‡•á‡§ú‡§æ ‡§ó‡§Ø‡§æ';
                
                setTimeout(() => {
                    indicator.classList.remove('show');
                }, 2000);
            } catch (error) {
                console.error('Auto-save error:', error);
                indicator.classList.remove('saving');
                saveStatus.innerHTML = '<i class="fas fa-exclamation-triangle"></i> ‡§∏‡§π‡•á‡§ú‡§®‡•á ‡§Æ‡•á‡§Ç ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø';
                
                setTimeout(() => {
                    indicator.classList.remove('show');
                }, 3000);
            }
        }

        // Authentication Functions
        function checkAuthState() {
            const savedUser = localStorage.getItem(STORAGE_KEYS.USER_DATA);
            if (savedUser) {
                currentUser = JSON.parse(savedUser);
                document.getElementById('authContainer').style.display = 'none';
                document.getElementById('appContainer').style.display = 'block';
                loadUserData();
                initializeDashboard();
            } else {
                auth.onAuthStateChanged((user) => {
                    if (user) {
                        currentUser = {
                            uid: user.uid,
                            email: user.email,
                            displayName: user.displayName
                        };
                        localStorage.setItem(STORAGE_KEYS.USER_DATA, JSON.stringify(currentUser));
                        document.getElementById('authContainer').style.display = 'none';
                        document.getElementById('appContainer').style.display = 'block';
                        loadUserData();
                        initializeDashboard();
                    } else {
                        document.getElementById('authContainer').style.display = 'flex';
                        document.getElementById('appContainer').style.display = 'none';
                    }
                });
            }
        }

        async function handleEmailLogin(e) {
            e.preventDefault();
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;

            try {
                showNotification('‡§∏‡§æ‡§á‡§® ‡§á‡§® ‡§π‡•ã ‡§∞‡§π‡•á ‡§π‡•à‡§Ç...', 'info');
                await auth.signInWithEmailAndPassword(email, password);
                showNotification('‡§∏‡•ç‡§µ‡§æ‡§ó‡§§ ‡§π‡•à! üéâ', 'success');
            } catch (error) {
                console.error('Login error:', error);
                showNotification(getErrorMessage(error.code), 'error');
            }
        }

        async function handleEmailRegister(e) {
            e.preventDefault();
            const formData = {
                firstName: document.getElementById('regFirstName').value,
                lastName: document.getElementById('regLastName').value,
                email: document.getElementById('regEmail').value,
                password: document.getElementById('regPassword').value,
                phone: '+91' + document.getElementById('regPhone').value,
                location: document.getElementById('regLocation').value,
                farmSize: parseFloat(document.getElementById('regFarmSize').value),
                primaryCrop: document.getElementById('regPrimaryCrop').value
            };

            try {
                showNotification('‡§Ü‡§™‡§ï‡§æ ‡§ï‡•É‡§∑‡§ø ‡§ñ‡§æ‡§§‡§æ ‡§¨‡§®‡§æ‡§Ø‡§æ ‡§ú‡§æ ‡§∞‡§π‡§æ ‡§π‡•à...', 'info');
                const userCredential = await auth.createUserWithEmailAndPassword(formData.email, formData.password);
                
                // Update profile
                await userCredential.user.updateProfile({
                    displayName: `${formData.firstName} ${formData.lastName}`
                });
                
                // Save user data to Firestore
                await db.collection('users').doc(userCredential.user.uid).set({
                    ...formData,
                    createdAt: firebase.firestore.FieldValue.serverTimestamp()
                });

                showNotification('‡§ñ‡§æ‡§§‡§æ ‡§∏‡§´‡§≤‡§§‡§æ‡§™‡•Ç‡§∞‡•ç‡§µ‡§ï ‡§¨‡§®‡§æ‡§Ø‡§æ ‡§ó‡§Ø‡§æ! JamaApp ‡§Æ‡•á‡§Ç ‡§Ü‡§™‡§ï‡§æ ‡§∏‡•ç‡§µ‡§æ‡§ó‡§§ ‡§π‡•à! üå±', 'success');
            } catch (error) {
                console.error('Registration error:', error);
                showNotification(getErrorMessage(error.code), 'error');
            }
        }

        async function handleGoogleSignIn() {
            try {
                const provider = new firebase.auth.GoogleAuthProvider();
                showNotification('Google ‡§ï‡•á ‡§∏‡§æ‡§• ‡§∏‡§æ‡§á‡§® ‡§á‡§® ‡§π‡•ã ‡§∞‡§π‡•á ‡§π‡•à‡§Ç...', 'info');
                await auth.signInWithPopup(provider);
                showNotification('Google ‡§∏‡§æ‡§á‡§®-‡§á‡§® ‡§∏‡§´‡§≤! üéâ', 'success');
            } catch (error) {
                console.error('Google sign-in error:', error);
                showNotification(getErrorMessage(error.code), 'error');
            }
        }

        function showPhoneAuth() {
            toggleAuthForm('otp');
        }

        async function handleSendOTP() {
            const phoneNumber = '+91' + document.getElementById('phoneNumber').value;
            if (!phoneNumber || phoneNumber.length !== 13) {
                showNotification('‡§ï‡•É‡§™‡§Ø‡§æ ‡§è‡§ï ‡§µ‡•à‡§ß 10-‡§Ö‡§Ç‡§ï‡•Ä‡§Ø ‡§´‡•ã‡§® ‡§®‡§Ç‡§¨‡§∞ ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç', 'warning');
                return;
            }

            try {
                showNotification('OTP ‡§≠‡•á‡§ú‡§æ ‡§ú‡§æ ‡§∞‡§π‡§æ ‡§π‡•à...', 'info');
                
                // Initialize reCAPTCHA
                if (!window.recaptchaVerifier) {
                    window.recaptchaVerifier = new firebase.auth.RecaptchaVerifier('recaptcha-container', {
                        'size': 'normal',
                        'callback': function(response) {
                            console.log('reCAPTCHA solved');
                        }
                    });
                }

                confirmationResult = await auth.signInWithPhoneNumber(phoneNumber, window.recaptchaVerifier);
                
                document.getElementById('otpInput').style.display = 'block';
                document.getElementById('sendOTP').style.display = 'none';
                startOTPTimer();
                showNotification('OTP ‡§∏‡§´‡§≤‡§§‡§æ‡§™‡•Ç‡§∞‡•ç‡§µ‡§ï ‡§≠‡•á‡§ú‡§æ ‡§ó‡§Ø‡§æ! üì±', 'success');
            } catch (error) {
                console.error('OTP send error:', error);
                showNotification(getErrorMessage(error.code), 'error');
            }
        }

        async function handleVerifyOTP() {
            const otpCode = document.getElementById('otpCode').value;
            if (!otpCode || !confirmationResult) {
                showNotification('‡§ï‡•É‡§™‡§Ø‡§æ OTP ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç', 'warning');
                return;
            }

            try {
                showNotification('OTP ‡§∏‡§§‡•ç‡§Ø‡§æ‡§™‡§ø‡§§ ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à...', 'info');
                await confirmationResult.confirm(otpCode);
                showNotification('‡§´‡•ã‡§® ‡§∏‡§§‡•ç‡§Ø‡§æ‡§™‡§® ‡§∏‡§´‡§≤! üéâ', 'success');
            } catch (error) {
                console.error('OTP verification error:', error);
                showNotification('‡§ó‡§≤‡§§ OTP‡•§ ‡§ï‡•É‡§™‡§Ø‡§æ ‡§´‡§ø‡§∞ ‡§∏‡•á ‡§ï‡•ã‡§∂‡§ø‡§∂ ‡§ï‡§∞‡•á‡§Ç‡•§', 'error');
            }
        }

        async function handleResendOTP() {
            await handleSendOTP();
        }

        function startOTPTimer() {
            let timeLeft = 60;
            const timerElement = document.getElementById('otpTimer');
            const resendButton = document.getElementById('resendOTP');
            
            resendButton.disabled = true;
            
            otpTimer = setInterval(() => {
                timerElement.textContent = `${timeLeft} ‡§∏‡•á‡§ï‡§Ç‡§° ‡§Æ‡•á‡§Ç OTP ‡§™‡•Å‡§®‡§É ‡§≠‡•á‡§ú‡•á‡§Ç`;
                timeLeft--;
                
                if (timeLeft < 0) {
                    clearInterval(otpTimer);
                    timerElement.textContent = '‡§Ö‡§¨ ‡§Ü‡§™ OTP ‡§™‡•Å‡§®‡§É ‡§≠‡•á‡§ú ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç';
                    resendButton.disabled = false;
                }
            }, 1000);
        }

        function toggleAuthForm(formType) {
            document.getElementById('loginForm').style.display = formType === 'login' ? 'block' : 'none';
            document.getElementById('registerForm').style.display = formType === 'register' ? 'block' : 'none';
            document.getElementById('otpForm').style.display = formType === 'otp' ? 'block' : 'none';
        }

        async function signOut() {
            try {
                await auth.signOut();
                localStorage.clear();
                currentUser = null;
                showNotification('‡§∏‡§´‡§≤‡§§‡§æ‡§™‡•Ç‡§∞‡•ç‡§µ‡§ï ‡§∏‡§æ‡§á‡§® ‡§Ü‡§â‡§ü ‡§π‡•ã ‡§ó‡§è! üëã', 'success');
                setTimeout(() => {
                    location.reload();
                }, 1000);
            } catch (error) {
                console.error('Sign out error:', error);
                showNotification('‡§∏‡§æ‡§á‡§® ‡§Ü‡§â‡§ü ‡§ï‡§∞‡§®‡•á ‡§Æ‡•á‡§Ç ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø', 'error');
            }
        }

        // Data Management Functions
        async function loadUserData() {
            try {
                if (currentUser && currentUser.uid) {
                    // Load from Firestore first
                    const userDataDoc = await db.collection('userData').doc(currentUser.uid).get();
                    if (userDataDoc.exists) {
                        const cloudData = userDataDoc.data();
                        
                        // Update local storage with cloud data
                        if (cloudData.crops) localStorage.setItem(STORAGE_KEYS.CROPS, JSON.stringify(cloudData.crops));
                        if (cloudData.transactions) localStorage.setItem(STORAGE_KEYS.TRANSACTIONS, JSON.stringify(cloudData.transactions));
                        if (cloudData.assets) localStorage.setItem(STORAGE_KEYS.ASSETS, JSON.stringify(cloudData.assets));
                        if (cloudData.ideas) localStorage.setItem(STORAGE_KEYS.IDEAS, JSON.stringify(cloudData.ideas));
                        if (cloudData.settings) localStorage.setItem(STORAGE_KEYS.SETTINGS, JSON.stringify(cloudData.settings));
                        
                        showNotification('‡§°‡•á‡§ü‡§æ ‡§ï‡•ç‡§≤‡§æ‡§â‡§° ‡§∏‡•á ‡§∏‡§ø‡§Ç‡§ï ‡§ï‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ! ‚òÅÔ∏è', 'success');
                    }
                    
                    // Load user profile
                    const userDoc = await db.collection('users').doc(currentUser.uid).get();
                    if (userDoc.exists) {
                        const userData = userDoc.data();
                        populateProfileForm(userData);
                        
                        // Set location for weather
                        if (userData.location) {
                            document.getElementById('locationName').textContent = userData.location;
                            getWeatherData(userData.location);
                        }
                    }
                }

                loadCrops();
                loadTransactions();
                loadAssets();
                loadIdeas();
                updateDashboardStats();
            } catch (error) {
                console.error('Error loading user data:', error);
                // Load from local storage as fallback
                loadCrops();
                loadTransactions();
                loadAssets();
                loadIdeas();
                updateDashboardStats();
            }
        }

        function populateProfileForm(userData) {
            document.getElementById('profileName').value = userData.displayName || `${userData.firstName || ''} ${userData.lastName || ''}`.trim();
            document.getElementById('profileEmail').value = userData.email || (currentUser ? currentUser.email : '');
            document.getElementById('profilePhone').value = userData.phone || '';
            document.getElementById('profileLocation').value = userData.location || '';
            document.getElementById('profileFarmSize').value = userData.farmSize || '';
        }

        // Navigation Functions
        function showSection(sectionName) {
            localStorage.setItem(STORAGE_KEYS.LAST_SECTION, sectionName);
            
            // Hide all sections
            document.querySelectorAll('.section').forEach(section => {
                section.classList.add('hidden');
            });

            // Show selected section
            document.getElementById(sectionName).classList.remove('hidden');

            // Update active navigation
            document.querySelectorAll('.sidebar-nav a, .mobile-nav-item').forEach(nav => {
                nav.classList.remove('active');
            });
            const sidebarNav = document.getElementById(`nav-${sectionName}`);
            if (sidebarNav) sidebarNav.classList.add('active');
            
            const mobileNavs = document.querySelectorAll('.mobile-nav-item');
            mobileNavs.forEach(nav => {
                const onclick = nav.getAttribute('onclick');
                if (onclick && onclick.includes(sectionName)) {
                    nav.classList.add('active');
                }
            });

            currentSection = sectionName;

            // Load section-specific data
            switch(sectionName) {
                case 'dashboard':
                    initializeDashboard();
                    break;
                case 'crops':
                    loadCrops();
                    break;
                case 'assets':
                    loadAssets();
                    break;
                case 'ideas':
                    loadIdeas();
                    break;
                case 'weather':
                    getCurrentLocationWeather();
                    break;
            }
        }

        // Dashboard Functions
        function initializeDashboard() {
            updateDashboardStats();
            getCurrentLocationWeather();
            setTimeout(() => {
                initializeCharts();
            }, 1000);
            loadRecentTransactions();
        }

        function updateDashboardStats() {
            const transactions = JSON.parse(localStorage.getItem(STORAGE_KEYS.TRANSACTIONS) || '[]');
            const crops = JSON.parse(localStorage.getItem(STORAGE_KEYS.CROPS) || '[]');
            
            let totalIncome = 0;
            let totalExpenses = 0;

            transactions.forEach(transaction => {
                if (transaction.type === 'income') {
                    totalIncome += transaction.amount;
                } else if (transaction.type === 'expense') {
                    totalExpenses += transaction.amount;
                }
            });

            const activeCropsCount = crops.filter(crop => crop.status === 'active').length;
            const totalCropsCount = crops.length;
            const netProfit = totalIncome - totalExpenses;

            // Update dashboard stats with animation
            animateCounter('totalIncome', 0, totalIncome, '‚Çπ');
            animateCounter('totalExpenses', 0, totalExpenses, '‚Çπ');
            animateCounter('netProfit', 0, netProfit, '‚Çπ');
            animateCounter('activeCrops', 0, activeCropsCount, '');

            // Update change indicators
            const incomeChange = Math.random() * 20 - 10;
            const expenseChange = Math.random() * 20 - 10;
            const profitChange = Math.random() * 30 - 15;

            document.getElementById('incomeChange').textContent = `‡§á‡§∏ ‡§Æ‡§π‡•Ä‡§®‡•á ${incomeChange > 0 ? '+' : ''}${incomeChange.toFixed(1)}%`;
            document.getElementById('expenseChange').textContent = `‡§á‡§∏ ‡§Æ‡§π‡•Ä‡§®‡•á ${expenseChange > 0 ? '+' : ''}${expenseChange.toFixed(1)}%`;
            document.getElementById('profitChange').textContent = `‡§á‡§∏ ‡§Æ‡§π‡•Ä‡§®‡•á ${profitChange > 0 ? '+' : ''}${profitChange.toFixed(1)}%`;
            document.getElementById('cropsChange').textContent = `${totalCropsCount} ‡§ï‡•Å‡§≤ ‡§´‡§∏‡§≤‡•á‡§Ç`;
        }

        function animateCounter(elementId, start, end, prefix = '') {
            const element = document.getElementById(elementId);
            const duration = 2000;
            const startTime = Date.now();
            
            function animate() {
                const elapsed = Date.now() - startTime;
                const progress = Math.min(elapsed / duration, 1);
                
                const current = Math.floor(start + (end - start) * progress);
                element.textContent = prefix + current.toLocaleString('en-IN');
                
                if (progress < 1) {
                    requestAnimationFrame(animate);
                }
            }
            
            animate();
        }

        function loadRecentTransactions() {
            const transactions = JSON.parse(localStorage.getItem(STORAGE_KEYS.TRANSACTIONS) || '[]');
            const recentTransactions = transactions.slice(-5).reverse();
            const container = document.getElementById('recentTransactionsList');
            
            if (recentTransactions.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-coins"></i>
                        <h3>‡§ï‡•ã‡§à ‡§≤‡•á‡§®‡§¶‡•á‡§® ‡§®‡§π‡•Ä‡§Ç</h3>
                        <p>‡§Ö‡§™‡§®‡•Ä ‡§™‡§π‡§≤‡•Ä ‡§µ‡§ø‡§§‡•ç‡§§‡•Ä‡§Ø ‡§ó‡§§‡§ø‡§µ‡§ø‡§ß‡§ø ‡§ú‡•ã‡§°‡§º‡§ï‡§∞ ‡§∂‡•Å‡§∞‡•Å‡§Ü‡§§ ‡§ï‡§∞‡•á‡§Ç‡•§</p>
                        <button class="btn btn-primary" onclick="showAddTransactionModal()">
                            <i class="fas fa-plus"></i> ‡§™‡§π‡§≤‡§æ ‡§≤‡•á‡§®‡§¶‡•á‡§® ‡§ú‡•ã‡§°‡§º‡•á‡§Ç
                        </button>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = recentTransactions.map(transaction => {
                const crop = getCropById(transaction.cropId);
                const relatedItem = crop ? `üå± ${crop.name}` : '';
                
                return `
                    <div style="background: var(--card-bg); padding: 1rem; border-radius: 12px; margin-bottom: 1rem; box-shadow: var(--shadow); border-left: 4px solid ${transaction.type === 'income' ? 'var(--success-color)' : 'var(--error-color)'};">
                        <div class="flex-between">
                            <div>
                                <div style="font-weight: 600; margin-bottom: 0.5rem;">${transaction.description}</div>
                                <div style="font-size: 0.9rem; color: var(--text-secondary);">
                                    üìÖ ${new Date(transaction.date).toLocaleDateString('hi-IN')} ‚Ä¢ 
                                    üè∑Ô∏è ${transaction.category.replace('-', ' ')}
                                    ${relatedItem ? ` ‚Ä¢ ${relatedItem}` : ''}
                                </div>
                            </div>
                            <div class="${transaction.type === 'income' ? 'text-success' : 'text-error'}" style="font-weight: bold; font-size: 1.2rem;">
                                ${transaction.type === 'income' ? '+' : '-'}‚Çπ${transaction.amount.toLocaleString('en-IN')}
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // Crop Management Functions
        function loadCrops() {
            const crops = JSON.parse(localStorage.getItem(STORAGE_KEYS.CROPS) || '[]');
            displayCrops(crops);
            loadCropsIntoDropdowns();
        }

        function loadCropsIntoDropdowns() {
            const crops = JSON.parse(localStorage.getItem(STORAGE_KEYS.CROPS) || '[]');
            const cropSelects = document.querySelectorAll('#transactionCropId');
            
            cropSelects.forEach(select => {
                if (select) {
                    select.innerHTML = '<option value="">‡§´‡§∏‡§≤ ‡§ö‡•Å‡§®‡•á‡§Ç</option>' +
                        crops.map(crop => `<option value="${crop.id}">${getCropEmoji(crop.name)} ${crop.name.charAt(0).toUpperCase() + crop.name.slice(1)} - ${crop.variety || 'Standard'}</option>`).join('');
                }
            });
        }

        function displayCrops(crops) {
            const cropGrid = document.getElementById('cropGrid');
            
            if (crops.length === 0) {
                cropGrid.innerHTML = `
                    <div class="empty-state" style="grid-column: 1 / -1;">
                        <i class="fas fa-seedling"></i>
                        <h3>‡§ï‡•ã‡§à ‡§´‡§∏‡§≤ ‡§®‡§π‡•Ä‡§Ç ‡§ú‡•ã‡§°‡§º‡•Ä ‡§ó‡§à</h3>
                        <p>‡§Ö‡§™‡§®‡•Ä ‡§ï‡•É‡§∑‡§ø ‡§Ø‡§æ‡§§‡•ç‡§∞‡§æ ‡§∂‡•Å‡§∞‡•Ç ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ö‡§™‡§®‡•Ä ‡§™‡§π‡§≤‡•Ä ‡§´‡§∏‡§≤ ‡§ú‡•ã‡§°‡§º‡•á‡§Ç‡•§ ‡§µ‡•É‡§¶‡•ç‡§ß‡§ø ‡§ï‡•ã ‡§ü‡•ç‡§∞‡•à‡§ï ‡§ï‡§∞‡•á‡§Ç, ‡§ñ‡§∞‡•ç‡§ö‡•ã‡§Ç ‡§ï‡§æ ‡§™‡•ç‡§∞‡§¨‡§Ç‡§ß‡§® ‡§ï‡§∞‡•á‡§Ç, ‡§î‡§∞ ‡§Ö‡§™‡§®‡•Ä ‡§´‡§∏‡§≤ ‡§ï‡•Ä ‡§™‡•à‡§¶‡§æ‡§µ‡§æ‡§∞ ‡§ï‡•ã ‡§Ö‡§ß‡§ø‡§ï‡§§‡§Æ ‡§ï‡§∞‡•á‡§Ç‡•§</p>
                        <button class="btn btn-primary btn-large" onclick="showAddCropModal()">
                            <i class="fas fa-plus"></i> ‡§Ö‡§™‡§®‡•Ä ‡§™‡§π‡§≤‡•Ä ‡§´‡§∏‡§≤ ‡§ú‡•ã‡§°‡§º‡•á‡§Ç
                        </button>
                    </div>
                `;
                return;
            }
            
            cropGrid.innerHTML = crops.map(crop => {
                const progress = calculateCropProgress(crop);
                const relatedTransactions = getRelatedTransactions(crop.id, 'crop');
                const totalExpenses = relatedTransactions.filter(t => t.type === 'expense').reduce((sum, t) => sum + t.amount, 0);
                const totalIncome = relatedTransactions.filter(t => t.type === 'income').reduce((sum, t) => sum + t.amount, 0);
                const daysRemaining = getDaysRemaining(crop.expectedHarvest);
                const rainChance = Math.floor(Math.random() * 100);
                
                return `
                    <div class="card crop-card">
                        <!-- Crop Image with Name Overlay -->
                        <div class="crop-image-container">
                            <img src="${getCropImage(crop.name)}" alt="${crop.name}" class="crop-image" onerror="this.src='https://images.unsplash.com/photo-1625246333195-78d9c38ad449?w=400&h=300&fit=crop&auto=format&q=60'">
                            <div class="crop-name-overlay">
                                ${getCropEmoji(crop.name)} ${crop.name.charAt(0).toUpperCase() + crop.name.slice(1)}
                                ${crop.variety ? `<div style="font-size: 0.9rem; opacity: 0.8;">${crop.variety}</div>` : ''}
                            </div>
                        </div>
                        
                        <!-- Crop Details -->
                        <div style="margin-bottom: 1rem;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                                <div class="status-badge status-${crop.status}">${crop.status === 'active' ? 'üå± ‡§∏‡§ï‡•ç‡§∞‡§ø‡§Ø' : crop.status === 'harvested' ? 'üåæ ‡§ï‡§ü‡§æ‡§à ‡§ï‡•Ä ‡§ó‡§à' : 'üìÖ ‡§Ø‡•ã‡§ú‡§®‡§æ‡§¨‡§¶‡•ç‡§ß'}</div>
                                <div style="font-weight: 600; color: var(--text-secondary);">${crop.area} ‡§è‡§ï‡§°‡§º</div>
                            </div>
                            
                            <div class="grid grid-2 gap-2" style="font-size: 0.9rem; color: var(--text-secondary); margin-bottom: 1rem;">
                                <div><i class="fas fa-map-marker-alt"></i> ${crop.location}</div>
                                <div><i class="fas fa-clock"></i> ${crop.season} ‡§Æ‡§π‡•Ä‡§®‡•á</div>
                                <div><i class="fas fa-calendar"></i> ${new Date(crop.sowingDate).toLocaleDateString('hi-IN')}</div>
                                <div><i class="fas fa-calendar-check"></i> ${new Date(crop.expectedHarvest).toLocaleDateString('hi-IN')}</div>
                            </div>
                        </div>
                        
                        <!-- Weather Forecast -->
                        <div class="weather-forecast">
                            <div style="font-size: 1.1rem; font-weight: 600; margin-bottom: 0.5rem;">
                                <i class="fas fa-cloud-rain"></i> ‡§Æ‡•å‡§∏‡§Æ ‡§™‡•Ç‡§∞‡•ç‡§µ‡§æ‡§®‡•Å‡§Æ‡§æ‡§®
                            </div>
                            <div class="forecast-days">
                                ${generateForecastDays()}
                            </div>
                        </div>
                        
                        <!-- Rain Detection -->
                        <div class="rain-detection">
                            <div style="font-weight: 600; margin-bottom: 0.5rem;">
                                <i class="fas fa-tint"></i> ‡§¨‡§æ‡§∞‡§ø‡§∂ ‡§ï‡•Ä ‡§∏‡§Ç‡§≠‡§æ‡§µ‡§®‡§æ
                            </div>
                            <div class="rain-percentage">${rainChance}%</div>
                            <div style="font-size: 0.8rem; margin-top: 0.5rem;">
                                ${rainChance > 70 ? 'üåßÔ∏è ‡§Ü‡§ú ‡§¨‡§æ‡§∞‡§ø‡§∂ ‡§ï‡•Ä ‡§Ö‡§ö‡•ç‡§õ‡•Ä ‡§∏‡§Ç‡§≠‡§æ‡§µ‡§®‡§æ' : rainChance > 40 ? '‚õÖ ‡§Ü‡§Ç‡§∂‡§ø‡§ï ‡§¨‡§æ‡§∞‡§ø‡§∂ ‡§π‡•ã ‡§∏‡§ï‡§§‡•Ä ‡§π‡•à' : '‚òÄÔ∏è ‡§Æ‡•å‡§∏‡§Æ ‡§∏‡§æ‡§´ ‡§∞‡§π‡§®‡•á ‡§ï‡•Ä ‡§∏‡§Ç‡§≠‡§æ‡§µ‡§®‡§æ'}
                            </div>
                        </div>
                        
                        ${crop.status === 'active' ? `
                            <div style="margin: 1.5rem 0;">
                                <div class="progress-label">
                                    <span><i class="fas fa-chart-line"></i> ‡§´‡§∏‡§≤ ‡§ï‡•Ä ‡§µ‡•É‡§¶‡•ç‡§ß‡§ø</span>
                                    <span><strong>${progress}%</strong></span>
                                </div>
                                <div class="progress">
                                    <div class="progress-bar" style="width: ${progress}%"></div>
                                </div>
                                <div style="font-size: 0.8rem; color: var(--text-secondary); margin-top: 0.5rem; text-align: center;">
                                    ${daysRemaining > 0 ? `${daysRemaining} ‡§¶‡§ø‡§® ‡§¨‡§ö‡•á` : '‡§ï‡§ü‡§æ‡§à ‡§ï‡§æ ‡§∏‡§Æ‡§Ø!'}
                                </div>
                            </div>
                        ` : ''}
                        
                        <!-- Financial Summary -->
                        <div style="background: rgba(46, 125, 50, 0.05); padding: 1rem; border-radius: 12px; margin: 1rem 0;">
                            <div class="grid grid-3 gap-1" style="font-size: 0.9rem; text-align: center;">
                                <div>
                                    <div style="font-weight: bold; color: var(--primary-color);">‚Çπ${totalExpenses.toLocaleString('en-IN')}</div>
                                    <div style="color: var(--text-secondary); font-size: 0.8rem;">‡§ï‡•Å‡§≤ ‡§ñ‡§∞‡•ç‡§ö</div>
                                </div>
                                <div>
                                    <div style="font-weight: bold; color: var(--success-color);">‚Çπ${totalIncome.toLocaleString('en-IN')}</div>
                                    <div style="color: var(--text-secondary); font-size: 0.8rem;">‡§ï‡•Å‡§≤ ‡§Ü‡§Ø</div>
                                </div>
                                <div>
                                    <div style="font-weight: bold; color: var(--info-color);">‚Çπ${((crop.expectedYield || 0) * (crop.expectedPrice || 0)).toLocaleString('en-IN')}</div>
                                    <div style="color: var(--text-secondary); font-size: 0.8rem;">‡§Ö‡§®‡•Å‡§Æ‡§æ‡§®‡§ø‡§§ ‡§Ü‡§Ø</div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Action Buttons -->
                        <div class="action-buttons-enhanced">
                            <button class="btn btn-primary" onclick="showAddTransactionModal('${crop.id}')">
                                <i class="fas fa-coins"></i> ‡§≤‡•á‡§®‡§¶‡•á‡§® ‡§ú‡•ã‡§°‡§º‡•á‡§Ç
                            </button>
                            <button class="btn btn-info" onclick="viewTransactions('${crop.id}')">
                                <i class="fas fa-list"></i> ‡§≤‡•á‡§®‡§¶‡•á‡§® ‡§¶‡•á‡§ñ‡•á‡§Ç
                            </button>
                            ${crop.status === 'active' ? `
                                <button class="btn btn-harvest" onclick="showHarvestModal('${crop.id}')">
                                    <i class="fas fa-cut"></i> ‡§´‡§∏‡§≤ ‡§ï‡•Ä ‡§ï‡§ü‡§æ‡§à ‡§ï‡§∞‡•á‡§Ç
                                </button>
                            ` : ''}
                        </div>
                    </div>
                `;
            }).join('');
        }

        function generateForecastDays() {
            const days = ['‡§Ü‡§ú', '‡§ï‡§≤', '‡§™‡§∞‡§∏‡•ã‡§Ç', '4 ‡§¶‡§ø‡§®', '5 ‡§¶‡§ø‡§®'];
            const icons = ['fas fa-sun', 'fas fa-cloud', 'fas fa-cloud-rain', 'fas fa-sun', 'fas fa-cloud'];
            const temps = [32, 28, 24, 30, 33];
            
            return days.map((day, index) => `
                <div class="forecast-day">
                    <div style="font-size: 0.8rem; margin-bottom: 0.5rem;">${day}</div>
                    <i class="${icons[index]}" style="margin-bottom: 0.5rem;"></i>
                    <div style="font-size: 0.9rem; font-weight: bold;">${temps[index]}¬∞C</div>
                </div>
            `).join('');
        }

        function getCropImage(cropName) {
            const images = {
                rice: 'https://images.unsplash.com/photo-1586201375761-83865001e31c?w=400&h=300&fit=crop&auto=format&q=60',
                wheat: 'https://images.unsplash.com/photo-1574323347407-f5e1ad6d020b?w=400&h=300&fit=crop&auto=format&q=60',
                corn: 'https://images.unsplash.com/photo-1551754655-cd27e38d2076?w=400&h=300&fit=crop&auto=format&q=60',
                tobacco: 'https://images.unsplash.com/photo-1544968503-7342988bbc7f?w=400&h=300&fit=crop&auto=format&q=60',
                cotton: 'https://images.unsplash.com/photo-1592085189859-b372d7d1d6?w=400&h=300&fit=crop&auto=format&q=60',
                sugarcane: 'https://images.unsplash.com/photo-1571115764595-644a1f56a55c?w=400&h=300&fit=crop&auto=format&q=60',
                vegetables: 'https://images.unsplash.com/photo-1566385101042-1a0aa0c1268c?w=400&h=300&fit=crop&auto=format&q=60',
                fruits: 'https://images.unsplash.com/photo-1610832958506-aa56368176cf?w=400&h=300&fit=crop&auto=format&q=60',
                pulses: 'https://images.unsplash.com/photo-1559827260-dc66d52bef19?w=400&h=300&fit=crop&auto=format&q=60'
            };
            return images[cropName] || 'https://images.unsplash.com/photo-1625246333195-78d9c38ad449?w=400&h=300&fit=crop&auto=format&q=60';
        }

        function getCropEmoji(cropName) {
            const emojis = {
                rice: 'üåæ',
                wheat: 'üåæ',
                corn: 'üåΩ',
                tobacco: 'üö¨',
                cotton: 'üåø',
                sugarcane: 'üéã',
                pulses: 'ü´ò',
                vegetables: 'ü•ï',
                fruits: 'üçé'
            };
            return emojis[cropName] || 'üå±';
        }

        function calculateCropProgress(crop) {
            if (crop.status !== 'active') return 100;
            
            const sowingDate = new Date(crop.sowingDate);
            const harvestDate = new Date(crop.expectedHarvest);
            const today = new Date();
            
            const totalDays = (harvestDate - sowingDate) / (1000 * 60 * 60 * 24);
            const daysPassed = (today - sowingDate) / (1000 * 60 * 60 * 24);
            
            const progress = Math.min(Math.max((daysPassed / totalDays) * 100, 0), 100);
            return Math.round(progress);
        }

        function getDaysRemaining(harvestDate) {
            const today = new Date();
            const harvest = new Date(harvestDate);
            const daysRemaining = Math.ceil((harvest - today) / (1000 * 60 * 60 * 24));
            return Math.max(daysRemaining, 0);
        }

        function getRelatedTransactions(itemId, type) {
            const transactions = JSON.parse(localStorage.getItem(STORAGE_KEYS.TRANSACTIONS) || '[]');
            const fieldName = type === 'crop' ? 'cropId' : 'assetId';
            return transactions.filter(t => t[fieldName] === itemId);
        }

        function getCropById(cropId) {
            const crops = JSON.parse(localStorage.getItem(STORAGE_KEYS.CROPS) || '[]');
            return crops.find(c => c.id === cropId);
        }

        // Enhanced Crop Modal Functions
        function showAddCropModal() {
            document.getElementById('addCropModal').classList.add('active');
            
            // Set default dates
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('sowingDate').value = today;
            
            // Set default location from profile
            const userData = JSON.parse(localStorage.getItem(STORAGE_KEYS.USER_DATA) || '{}');
            if (userData.location) {
                document.getElementById('cropLocation').value = userData.location;
            }
            
            updateExpectedHarvest();
        }

        function updateCropImage() {
            const cropSelect = document.getElementById('cropName');
            const selectedOption = cropSelect.options[cropSelect.selectedIndex];
            const imageUrl = selectedOption.getAttribute('data-image');
            const preview = document.getElementById('cropImagePreview');
            const previewImg = document.getElementById('previewImage');
            
            if (imageUrl && cropSelect.value) {
                previewImg.src = imageUrl;
                preview.style.display = 'block';
            } else {
                preview.style.display = 'none';
            }
        }

        function updateAreaValue(value) {
            document.getElementById('areaRangeValue').textContent = parseFloat(value).toFixed(1);
            document.getElementById('cropArea').value = value;
            
            // Update slider position
            const slider = document.getElementById('cropAreaSlider');
            const percent = ((value - slider.min) / (slider.max - slider.min)) * 100;
            document.getElementById('areaRangeValue').style.left = percent + '%';
        }

        function updateAreaSlider(value) {
            document.getElementById('cropAreaSlider').value = value;
            updateAreaValue(value);
        }

        function updateExpectedHarvest() {
            const sowingDate = document.getElementById('sowingDate').value;
            const durationMonths = parseInt(document.getElementById('cropSeason').value) || 3;
            
            if (sowingDate) {
                const sowing = new Date(sowingDate);
                const harvest = new Date(sowing.getTime() + (durationMonths * 30 * 24 * 60 * 60 * 1000));
                document.getElementById('expectedHarvest').value = harvest.toISOString().split('T')[0];
            }
        }

        function handleAddCrop(e) {
            e.preventDefault();
            
            const isEditing = document.getElementById('addCropForm').dataset.editingId;
            const cropData = {
                id: isEditing || Date.now().toString(),
                name: document.getElementById('cropName').value,
                variety: document.getElementById('cropVariety').value,
                area: parseFloat(document.getElementById('cropArea').value),
                season: document.getElementById('cropSeason').value,
                location: document.getElementById('cropLocation').value,
                sowingDate: document.getElementById('sowingDate').value,
                expectedHarvest: document.getElementById('expectedHarvest').value,
                expectedYield: parseFloat(document.getElementById('expectedYield').value) || 0,
                expectedPrice: parseFloat(document.getElementById('expectedPrice').value) || 0,
                notes: document.getElementById('cropNotes').value,
                status: 'active',
                createdAt: isEditing ? undefined : new Date().toISOString(),
                updatedAt: new Date().toISOString()
            };
            
            let crops = JSON.parse(localStorage.getItem(STORAGE_KEYS.CROPS) || '[]');
            
            if (isEditing) {
                const index = crops.findIndex(c => c.id === isEditing);
                if (index !== -1) {
                    crops[index] = { ...crops[index], ...cropData };
                }
            } else {
                crops.push(cropData);
            }
            
            localStorage.setItem(STORAGE_KEYS.CROPS, JSON.stringify(crops));
            
            // Auto-save to Firebase
            autoSaveToFirebase();
            
            loadCrops();
            updateDashboardStats();
            closeModal('addCropModal');
            document.getElementById('addCropForm').reset();
            document.getElementById('cropImagePreview').style.display = 'none';
            delete document.getElementById('addCropForm').dataset.editingId;
            
            showNotification(
                isEditing ? '‚úÖ ‡§´‡§∏‡§≤ ‡§∏‡§´‡§≤‡§§‡§æ‡§™‡•Ç‡§∞‡•ç‡§µ‡§ï ‡§Ö‡§™‡§°‡•á‡§ü ‡§ï‡•Ä ‡§ó‡§à! üå±' : '‚úÖ ‡§®‡§à ‡§´‡§∏‡§≤ ‡§∏‡§´‡§≤‡§§‡§æ‡§™‡•Ç‡§∞‡•ç‡§µ‡§ï ‡§ú‡•ã‡§°‡§º‡•Ä ‡§ó‡§à! üå±', 
                'success'
            );
        }

        // Harvest Functions
        function showHarvestModal(cropId) {
            const crops = JSON.parse(localStorage.getItem(STORAGE_KEYS.CROPS) || '[]');
            const crop = crops.find(c => c.id === cropId);
            if (!crop) return;
            
            document.getElementById('harvestCropId').value = cropId;
            
            // Show confirmation first
            document.getElementById('harvestConfirmation').style.display = 'block';
            document.getElementById('harvestForm').style.display = 'none';
            
            document.getElementById('harvestModal').classList.add('active');
        }

        function proceedToHarvest() {
            const cropId = document.getElementById('harvestCropId').value;
            const crops = JSON.parse(localStorage.getItem(STORAGE_KEYS.CROPS) || '[]');
            const crop = crops.find(c => c.id === cropId);
            
            if (crop) {
                // Pre-fill with expected values
                document.getElementById('harvestQuantity').value = crop.expectedYield || '';
                document.getElementById('pricePerUnit').value = crop.expectedPrice || '';
                calculateHarvestTotal();
            }
            
            document.getElementById('harvestConfirmation').style.display = 'none';
            document.getElementById('harvestForm').style.display = 'block';
        }

        function calculateHarvestTotal() {
            const quantity = parseFloat(document.getElementById('harvestQuantity').value) || 0;
            const pricePerUnit = parseFloat(document.getElementById('pricePerUnit').value) || 0;
            const total = quantity * pricePerUnit;
            
            document.getElementById('totalSaleAmount').value = total.toFixed(2);
        }

        function handleHarvest(e) {
            e.preventDefault();
            
            const cropId = document.getElementById('harvestCropId').value;
            const quantity = parseFloat(document.getElementById('harvestQuantity').value);
            const unit = document.getElementById('harvestUnit').value;
            const pricePerUnit = parseFloat(document.getElementById('pricePerUnit').value);
            const totalAmount = parseFloat(document.getElementById('totalSaleAmount').value);
            const buyerContact = document.getElementById('buyerContact').value;
            const notes = document.getElementById('harvestNotes').value;
            
            // Update crop status
            const crops = JSON.parse(localStorage.getItem(STORAGE_KEYS.CROPS) || '[]');
            const cropIndex = crops.findIndex(c => c.id === cropId);
            if (cropIndex !== -1) {
                crops[cropIndex].status = 'harvested';
                crops[cropIndex].harvestDate = new Date().toISOString().split('T')[0];
                crops[cropIndex].actualYield = quantity;
                crops[cropIndex].actualPrice = pricePerUnit;
                crops[cropIndex].harvestNotes = notes;
                localStorage.setItem(STORAGE_KEYS.CROPS, JSON.stringify(crops));
            }
            
            // Add income transaction
            const transaction = {
                id: Date.now().toString(),
                type: 'income',
                category: 'crop-sale',
                description: `${crops[cropIndex].name.charAt(0).toUpperCase() + crops[cropIndex].name.slice(1)} ‡§ï‡•Ä ‡§ï‡§ü‡§æ‡§à - ${quantity} ${unit}`,
                amount: totalAmount,
                date: new Date().toISOString().split('T')[0],
                paymentMethod: 'cash',
                cropId: cropId,
                contact: buyerContact,
                notes: notes,
                createdAt: new Date().toISOString()
            };
            
            const transactions = JSON.parse(localStorage.getItem(STORAGE_KEYS.TRANSACTIONS) || '[]');
            transactions.push(transaction);
            localStorage.setItem(STORAGE_KEYS.TRANSACTIONS, JSON.stringify(transactions));
            
            // Auto-save to Firebase
            autoSaveToFirebase();
            
            loadCrops();
            updateDashboardStats();
            loadRecentTransactions();
            closeModal('harvestModal');
            document.getElementById('harvestForm').reset();
            
            showNotification(`üéâ ‡§´‡§∏‡§≤ ‡§ï‡•Ä ‡§ï‡§ü‡§æ‡§à ‡§∏‡§´‡§≤! ‡§¨‡§ø‡§ï‡•ç‡§∞‡•Ä ‡§∞‡§æ‡§∂‡§ø: ‚Çπ${totalAmount.toLocaleString('en-IN')}`, 'success');
        }

        function viewTransactions(cropId) {
            const transactions = getRelatedTransactions(cropId, 'crop');
            const crop = getCropById(cropId);
            
            if (transactions.length === 0) {
                showNotification('‡§á‡§∏ ‡§´‡§∏‡§≤ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡•ã‡§à ‡§≤‡•á‡§®‡§¶‡•á‡§® ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡§æ', 'info');
                return;
            }
            
            // Show transactions in a simple alert for now
            // In a full implementation, this would open a detailed modal
            let transactionList = `${crop.name} ‡§ï‡•á ‡§≤‡§ø‡§è ‡§≤‡•á‡§®‡§¶‡•á‡§®:\n\n`;
            transactions.forEach(t => {
                transactionList += `üìÖ ${new Date(t.date).toLocaleDateString('hi-IN')}\n`;
                transactionList += `üìù ${t.description}\n`;
                transactionList += `üí∞ ${t.type === 'income' ? '+' : '-'}‚Çπ${t.amount.toLocaleString('en-IN')}\n\n`;
            });
            
            alert(transactionList);
        }

        // Transaction Management Functions
        function showAddTransactionModal(cropId = null) {
            document.getElementById('addTransactionModal').classList.add('active');
            document.getElementById('transactionDate').value = new Date().toISOString().split('T')[0];
            
            loadCropsIntoDropdowns();
            
            if (cropId) {
                document.getElementById('transactionCropId').value = cropId;
            }
        }

        function updateTransactionCategories() {
            const type = document.getElementById('transactionType').value;
            const categorySelect = document.getElementById('transactionCategory');
            
            let categories = [];
            if (type === 'income') {
                categories = [
                    { value: 'crop-sale', label: 'üåæ ‡§´‡§∏‡§≤ ‡§¨‡§ø‡§ï‡•ç‡§∞‡•Ä' },
                    { value: 'livestock-sale', label: 'üêÑ ‡§™‡§∂‡•Å‡§ß‡§® ‡§¨‡§ø‡§ï‡•ç‡§∞‡•Ä' },
                    { value: 'milk-sale', label: 'ü•õ ‡§¶‡•Ç‡§ß ‡§ï‡•Ä ‡§¨‡§ø‡§ï‡•ç‡§∞‡•Ä' },
                    { value: 'equipment-rent', label: 'üöú ‡§â‡§™‡§ï‡§∞‡§£ ‡§ï‡§ø‡§∞‡§æ‡§Ø‡§æ' },
                    { value: 'land-rent', label: 'üåæ ‡§≠‡•Ç‡§Æ‡§ø ‡§ï‡§ø‡§∞‡§æ‡§Ø‡§æ' },
                    { value: 'government-subsidy', label: 'üèõÔ∏è ‡§∏‡§∞‡§ï‡§æ‡§∞‡•Ä ‡§∏‡§¨‡•ç‡§∏‡§ø‡§°‡•Ä' },
                    { value: 'other-income', label: 'üí∞ ‡§Ö‡§®‡•ç‡§Ø ‡§Ü‡§Ø' }
                ];
            } else if (type === 'expense') {
                categories = [
                    { value: 'seeds', label: 'üå± ‡§¨‡•Ä‡§ú' },
                    { value: 'fertilizers', label: 'üß™ ‡§â‡§∞‡•ç‡§µ‡§∞‡§ï' },
                    { value: 'pesticides', label: 'ü™≤ ‡§ï‡•Ä‡§ü‡§®‡§æ‡§∂‡§ï' },
                    { value: 'equipment', label: 'üöú ‡§â‡§™‡§ï‡§∞‡§£' },
                    { value: 'labor', label: 'üë®‚Äçüåæ ‡§Æ‡§ú‡§¶‡•Ç‡§∞' },
                    { value: 'fuel', label: '‚õΩ ‡§à‡§Ç‡§ß‡§®' },
                    { value: 'irrigation', label: 'üíß ‡§∏‡§ø‡§Ç‡§ö‡§æ‡§à' },
                    { value: 'transportation', label: 'üöö ‡§™‡§∞‡§ø‡§µ‡§π‡§®' },
                    { value: 'feed', label: 'üåæ ‡§™‡§∂‡•Å ‡§Ü‡§π‡§æ‡§∞' },
                    { value: 'veterinary', label: 'üíâ ‡§™‡§∂‡•Å ‡§ö‡§ø‡§ï‡§ø‡§§‡•ç‡§∏‡§æ' },
                    { value: 'maintenance', label: 'üîß ‡§∞‡§ñ‡§∞‡§ñ‡§æ‡§µ' },
                    { value: 'other-expense', label: 'üí≥ ‡§Ö‡§®‡•ç‡§Ø ‡§ñ‡§∞‡•ç‡§ö' }
                ];
            }
            
            categorySelect.innerHTML = '<option value="">‡§∂‡•ç‡§∞‡•á‡§£‡•Ä ‡§ö‡•Å‡§®‡•á‡§Ç</option>' +
                categories.map(cat => `<option value="${cat.value}">${cat.label}</option>`).join('');
        }

        function handleAddTransaction(e) {
            e.preventDefault();
            
            const isEditing = document.getElementById('addTransactionForm').dataset.editingId;
            const transactionData = {
                id: isEditing || Date.now().toString(),
                type: document.getElementById('transactionType').value,
                category: document.getElementById('transactionCategory').value,
                description: document.getElementById('transactionDescription').value,
                amount: parseFloat(document.getElementById('transactionAmount').value),
                date: document.getElementById('transactionDate').value,
                paymentMethod: document.getElementById('transactionPaymentMethod').value,
                cropId: document.getElementById('transactionCropId').value || null,
                contact: document.getElementById('transactionContact').value,
                notes: document.getElementById('transactionNotes').value,
                createdAt: isEditing ? undefined : new Date().toISOString(),
                updatedAt: new Date().toISOString()
            };
            
            let transactions = JSON.parse(localStorage.getItem(STORAGE_KEYS.TRANSACTIONS) || '[]');
            
            if (isEditing) {
                const index = transactions.findIndex(t => t.id === isEditing);
                if (index !== -1) {
                    transactions[index] = { ...transactions[index], ...transactionData };
                }
            } else {
                transactions.push(transactionData);
            }
            
            localStorage.setItem(STORAGE_KEYS.TRANSACTIONS, JSON.stringify(transactions));
            
            // Auto-save to Firebase
            autoSaveToFirebase();
            
            updateDashboardStats();
            loadRecentTransactions();
            loadCrops(); // Refresh to show updated related transactions
            closeModal('addTransactionModal');
            document.getElementById('addTransactionForm').reset();
            delete document.getElementById('addTransactionForm').dataset.editingId;
            
            const emoji = transactionData.type === 'income' ? 'üí∞' : 'üí≥';
            showNotification(
                `${emoji} ${isEditing ? '‡§≤‡•á‡§®‡§¶‡•á‡§® ‡§Ö‡§™‡§°‡•á‡§ü' : '‡§≤‡•á‡§®‡§¶‡•á‡§® ‡§ú‡•ã‡§°‡§º‡§æ ‡§ó‡§Ø‡§æ'} ‡§∏‡§´‡§≤‡§§‡§æ‡§™‡•Ç‡§∞‡•ç‡§µ‡§ï!`, 
                'success'
            );
        }

        // Asset Management Functions
        function loadAssets() {
            const assets = JSON.parse(localStorage.getItem(STORAGE_KEYS.ASSETS) || '[]');
            displayAssets(assets);
            updateAssetCounts(assets);
        }

        function displayAssets(assets) {
            const assetsList = document.getElementById('assetsList');
            
            if (assets.length === 0) {
                assetsList.innerHTML = `
                    <div class="empty-state" style="grid-column: 1 / -1;">
                        <i class="fas fa-tractor"></i>
                        <h3>‡§ï‡•ã‡§à ‡§∏‡§Ç‡§™‡§§‡•ç‡§§‡§ø ‡§¶‡§∞‡•ç‡§ú ‡§®‡§π‡•Ä‡§Ç ‡§ï‡•Ä ‡§ó‡§à</h3>
                        <p>‡§Ö‡§™‡§®‡•á ‡§ï‡•É‡§∑‡§ø ‡§â‡§™‡§ï‡§∞‡§£, ‡§™‡§∂‡•Å‡§ß‡§®, ‡§≠‡•Ç‡§Æ‡§ø ‡§î‡§∞ ‡§á‡§®‡•ç‡§µ‡•á‡§Ç‡§ü‡•ç‡§∞‡•Ä ‡§ï‡•ã ‡§ü‡•ç‡§∞‡•à‡§ï ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ö‡§™‡§®‡•Ä ‡§∏‡§Ç‡§™‡§§‡•ç‡§§‡§ø‡§Ø‡•ã‡§Ç ‡§ï‡•ã ‡§ú‡•ã‡§°‡§º‡§®‡§æ ‡§∂‡•Å‡§∞‡•Ç ‡§ï‡§∞‡•á‡§Ç‡•§</p>
                        <button class="btn btn-primary btn-large" onclick="showAddAssetModal()">
                            <i class="fas fa-plus"></i> ‡§Ö‡§™‡§®‡•Ä ‡§™‡§π‡§≤‡•Ä ‡§∏‡§Ç‡§™‡§§‡•ç‡§§‡§ø ‡§ú‡•ã‡§°‡§º‡•á‡§Ç
                        </button>
                    </div>
                `;
                return;
            }
            
            assetsList.innerHTML = assets.map(asset => {
                const currentValue = calculateCurrentValue(asset);
                const relatedTransactions = getRelatedTransactions(asset.id, 'asset');
                const totalExpenses = relatedTransactions.filter(t => t.type === 'expense').reduce((sum, t) => sum + t.amount, 0);
                const totalIncome = relatedTransactions.filter(t => t.type === 'income').reduce((sum, t) => sum + t.amount, 0);
                
                return `
                    <div class="card asset-card">
                        <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1.5rem;">
                            <i class="${getAssetIcon(asset.type)}" style="font-size: 3rem; color: var(--primary-color);"></i>
                            <div style="flex: 1;">
                                <h3 style="margin: 0; color: var(--primary-color);">${asset.name}</h3>
                                <p style="margin: 0; color: var(--text-secondary); text-transform: capitalize;">${getAssetTypeInHindi(asset.type)}</p>
                            </div>
                            <div style="text-align: right;">
                                <div style="font-size: 1.5rem; font-weight: bold; color: var(--primary-color);">‚Çπ${currentValue.toLocaleString('en-IN')}</div>
                                <div style="font-size: 0.8rem; color: var(--text-secondary);">‡§µ‡§∞‡•ç‡§§‡§Æ‡§æ‡§® ‡§Æ‡•Ç‡§≤‡•ç‡§Ø</div>
                            </div>
                        </div>
                        
                        ${asset.purchaseDate ? `
                            <div style="font-size: 0.9rem; color: var(--text-secondary); margin-bottom: 1rem;">
                                <i class="fas fa-calendar"></i> ‡§ñ‡§∞‡•Ä‡§¶‡•Ä ‡§ó‡§à: ${new Date(asset.purchaseDate).toLocaleDateString('hi-IN')}
                            </div>
                        ` : ''}
                        
                        ${getAssetDetailsInHindi(asset)}
                        
                        <div style="background: rgba(46, 125, 50, 0.05); padding: 1rem; border-radius: 12px; margin: 1rem 0;">
                            <div class="grid grid-3 gap-1" style="font-size: 0.9rem; text-align: center;">
                                <div>
                                    <div style="font-weight: bold; color: var(--success-color);">‚Çπ${totalIncome.toLocaleString('en-IN')}</div>
                                    <div style="color: var(--text-secondary); font-size: 0.8rem;">‡§ï‡•Å‡§≤ ‡§Ü‡§Ø</div>
                                </div>
                                <div>
                                    <div style="font-weight: bold; color: var(--error-color);">‚Çπ${totalExpenses.toLocaleString('en-IN')}</div>
                                    <div style="color: var(--text-secondary); font-size: 0.8rem;">‡§ï‡•Å‡§≤ ‡§ñ‡§∞‡•ç‡§ö</div>
                                </div>
                                <div>
                                    <div style="font-weight: bold; color: var(--primary-color);">${relatedTransactions.length}</div>
                                    <div style="color: var(--text-secondary); font-size: 0.8rem;">‡§≤‡•á‡§®‡§¶‡•á‡§®</div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="action-buttons-enhanced">
                            <button class="btn btn-primary" onclick="showAddTransactionModal(null, '${asset.id}')">
                                <i class="fas fa-coins"></i> ‡§≤‡•á‡§®‡§¶‡•á‡§® ‡§ú‡•ã‡§°‡§º‡•á‡§Ç
                            </button>
                            <button class="btn btn-info" onclick="viewAssetTransactions('${asset.id}')">
                                <i class="fas fa-list"></i> ‡§≤‡•á‡§®‡§¶‡•á‡§® ‡§¶‡•á‡§ñ‡•á‡§Ç
                            </button>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function getAssetIcon(type) {
            const icons = {
                equipment: 'fas fa-tractor',
                livestock: 'fas fa-horse',
                land: 'fas fa-map',
                inventory: 'fas fa-boxes'
            };
            return icons[type] || 'fas fa-box';
        }

        function getAssetTypeInHindi(type) {
            const types = {
                equipment: '‡§â‡§™‡§ï‡§∞‡§£',
                livestock: '‡§™‡§∂‡•Å‡§ß‡§®',
                land: '‡§≠‡•Ç‡§Æ‡§ø',
                inventory: '‡§≠‡§Ç‡§°‡§æ‡§∞'
            };
            return types[type] || type;
        }

        function getAssetDetailsInHindi(asset) {
            switch(asset.type) {
                case 'equipment':
                    return `
                        <div style="background: rgba(46, 125, 50, 0.05); padding: 1rem; border-radius: 8px; margin: 1rem 0;">
                            <div style="margin-bottom: 0.5rem;"><strong>üîß ‡§∏‡•ç‡§•‡§ø‡§§‡§ø:</strong> ${getConditionInHindi(asset.condition || 'good')}</div>
                            ${asset.maintenanceCost ? `<div><strong>üí∞ ‡§µ‡§æ‡§∞‡•ç‡§∑‡§ø‡§ï ‡§∞‡§ñ‡§∞‡§ñ‡§æ‡§µ:</strong> ‚Çπ${asset.maintenanceCost.toLocaleString('en-IN')}</div>` : ''}
                        </div>
                    `;
                case 'livestock':
                    return `
                        <div style="background: rgba(46, 125, 50, 0.05); padding: 1rem; border-radius: 8px; margin: 1rem 0;">
                            <div style="margin-bottom: 0.5rem;"><strong>üî¢ ‡§∏‡§Ç‡§ñ‡•ç‡§Ø‡§æ:</strong> ${asset.count || 1}</div>
                            ${asset.breed ? `<div style="margin-bottom: 0.5rem;"><strong>üêÑ ‡§®‡§∏‡•ç‡§≤:</strong> ${asset.breed}</div>` : ''}
                            <div><strong>üíö ‡§∏‡•ç‡§µ‡§æ‡§∏‡•ç‡§•‡•ç‡§Ø:</strong> <span style="color: ${asset.health === 'healthy' ? 'var(--success-color)' : 'var(--warning-color)'};">${getHealthInHindi(asset.health || 'healthy')}</span></div>
                        </div>
                    `;
                case 'land':
                    return `
                        <div style="background: rgba(46, 125, 50, 0.05); padding: 1rem; border-radius: 8px; margin: 1rem 0;">
                            <div style="margin-bottom: 0.5rem;"><strong>üìè ‡§Ü‡§ï‡§æ‡§∞:</strong> ${asset.size || 0} ‡§è‡§ï‡§°‡§º</div>
                            <div><strong>üè† ‡§™‡•ç‡§∞‡§ï‡§æ‡§∞:</strong> ${getLandTypeInHindi(asset.landType || 'owned')}</div>
                        </div>
                    `;
                case 'inventory':
                    const stockLevel = asset.quantity || 0;
                    const minLevel = asset.minStockLevel || 0;
                    const stockStatus = stockLevel <= minLevel ? '‡§ï‡§Æ ‡§∏‡•ç‡§ü‡•â‡§ï' : '‡§∏‡§æ‡§Æ‡§æ‡§®‡•ç‡§Ø';
                    const stockColor = stockLevel <= minLevel ? 'var(--error-color)' : 'var(--success-color)';
                    
                    return `
                        <div style="background: rgba(46, 125, 50, 0.05); padding: 1rem; border-radius: 8px; margin: 1rem 0;">
                            <div style="margin-bottom: 0.5rem;"><strong>üì¶ ‡§µ‡§∞‡•ç‡§§‡§Æ‡§æ‡§® ‡§∏‡•ç‡§ü‡•â‡§ï:</strong> ${stockLevel} ${getUnitInHindi(asset.unit || 'units')}</div>
                            <div style="margin-bottom: 0.5rem;"><strong>‚ö†Ô∏è ‡§®‡•ç‡§Ø‡•Ç‡§®‡§§‡§Æ ‡§∏‡•ç‡§§‡§∞:</strong> ${minLevel} ${getUnitInHindi(asset.unit || 'units')}</div>
                            <div><strong>üìä ‡§∏‡•ç‡§•‡§ø‡§§‡§ø:</strong> <span style="color: ${stockColor};">${stockStatus}</span></div>
                        </div>
                    `;
                default:
                    return '';
            }
        }

        function getConditionInHindi(condition) {
            const conditions = {
                excellent: '‡§¨‡•á‡§π‡§§‡§∞‡•Ä‡§®',
                good: '‡§Ö‡§ö‡•ç‡§õ‡•Ä',
                fair: '‡§†‡•Ä‡§ï',
                poor: '‡§ñ‡§∞‡§æ‡§¨'
            };
            return conditions[condition] || condition;
        }

        function getHealthInHindi(health) {
            const healthStates = {
                healthy: '‡§∏‡•ç‡§µ‡§∏‡•ç‡§•',
                sick: '‡§¨‡•Ä‡§Æ‡§æ‡§∞',
                recovering: '‡§†‡•Ä‡§ï ‡§π‡•ã ‡§∞‡§π‡§æ'
            };
            return healthStates[health] || health;
        }

        function getLandTypeInHindi(landType) {
            const types = {
                owned: '‡§∏‡•ç‡§µ‡§æ‡§Æ‡§ø‡§§‡•ç‡§µ',
                leased: '‡§™‡§ü‡•ç‡§ü‡•á ‡§™‡§∞',
                rented: '‡§ï‡§ø‡§∞‡§æ‡§è ‡§™‡§∞'
            };
            return types[landType] || landType;
        }

        function getUnitInHindi(unit) {
            const units = {
                kg: '‡§ï‡§ø‡§≤‡•ã‡§ó‡•ç‡§∞‡§æ‡§Æ',
                quintals: '‡§ï‡•ç‡§µ‡§ø‡§Ç‡§ü‡§≤',
                tons: '‡§ü‡§®',
                liters: '‡§≤‡•Ä‡§ü‡§∞',
                pieces: '‡§ü‡•Å‡§ï‡§°‡§º‡•á',
                bags: '‡§¨‡•ã‡§∞‡•Ä',
                units: '‡§á‡§ï‡§æ‡§à'
            };
            return units[unit] || unit;
        }

        function calculateCurrentValue(asset) {
            if (!asset.purchasePrice) return 0;
            
            if (asset.type === 'equipment' && asset.purchaseDate) {
                const years = (new Date().getFullYear() - new Date(asset.purchaseDate).getFullYear());
                const depreciationRate = 0.10;
                return Math.max(asset.purchasePrice * Math.pow(1 - depreciationRate, years), asset.purchasePrice * 0.1);
            }
            
            return asset.purchasePrice;
        }

        function updateAssetCounts(assets) {
            const counts = {
                equipment: assets.filter(a => a.type === 'equipment').length,
                livestock: assets.filter(a => a.type === 'livestock').reduce((sum, a) => sum + (a.count || 1), 0),
                land: assets.filter(a => a.type === 'land').length,
                inventory: assets.filter(a => a.type === 'inventory').length
            };
            
            document.getElementById('equipmentCount').textContent = `${counts.equipment} ‡§µ‡§∏‡•ç‡§§‡•Å‡§è‡§Ç`;
            document.getElementById('livestockCount').textContent = `${counts.livestock} ‡§™‡§∂‡•Å`;
            document.getElementById('landCount').textContent = `${counts.land} ‡§™‡•ç‡§≤‡•â‡§ü`;
            document.getElementById('inventoryCount').textContent = `${counts.inventory} ‡§µ‡§∏‡•ç‡§§‡•Å‡§è‡§Ç`;
        }

        function showAddAssetModal() {
            document.getElementById('addAssetModal').classList.add('active');
            updateAssetFields(); // Hide all specific fields initially
        }

        function updateAssetFields() {
            const type = document.getElementById('assetType').value;
            
            // Hide all specific fields
            document.querySelectorAll('#equipmentFields, #livestockFields, #landFields, #inventoryFields').forEach(el => {
                el.classList.add('hidden');
            });
            
            // Show relevant fields
            if (type) {
                document.getElementById(`${type}Fields`).classList.remove('hidden');
            }
        }

        function handleAddAsset(e) {
            e.preventDefault();
            
            const isEditing = document.getElementById('addAssetForm').dataset.editingId;
            const assetData = {
                id: isEditing || Date.now().toString(),
                type: document.getElementById('assetType').value,
                name: document.getElementById('assetName').value,
                purchaseDate: document.getElementById('assetPurchaseDate').value,
                purchasePrice: parseFloat(document.getElementById('assetPurchasePrice').value) || 0,
                notes: document.getElementById('assetNotes').value,
                createdAt: isEditing ? undefined : new Date().toISOString(),
                updatedAt: new Date().toISOString()
            };
            
            // Add type-specific data
            if (assetData.type === 'equipment') {
                assetData.condition = document.getElementById('equipmentCondition').value;
                assetData.maintenanceCost = parseFloat(document.getElementById('equipmentMaintenanceCost').value) || 0;
            } else if (assetData.type === 'livestock') {
                assetData.count = parseInt(document.getElementById('animalCount').value) || 1;
                assetData.breed = document.getElementById('animalBreed').value;
                assetData.health = document.getElementById('animalHealth').value;
            } else if (assetData.type === 'land') {
                assetData.size = parseFloat(document.getElementById('landSize').value) || 0;
                assetData.landType = document.getElementById('landType').value;
            } else if (assetData.type === 'inventory') {
                assetData.quantity = parseFloat(document.getElementById('inventoryQuantity').value) || 0;
                assetData.unit = document.getElementById('inventoryUnit').value;
                assetData.minStockLevel = parseFloat(document.getElementById('minStockLevel').value) || 0;
                assetData.maxStockLevel = parseFloat(document.getElementById('maxStockLevel').value) || 100;
            }
            
            let assets = JSON.parse(localStorage.getItem(STORAGE_KEYS.ASSETS) || '[]');
            
            if (isEditing) {
                const index = assets.findIndex(a => a.id === isEditing);
                if (index !== -1) {
                    assets[index] = { ...assets[index], ...assetData };
                }
            } else {
                assets.push(assetData);
            }
            
            localStorage.setItem(STORAGE_KEYS.ASSETS, JSON.stringify(assets));
            
            // Auto-save to Firebase
            autoSaveToFirebase();
            
            loadAssets();
            closeModal('addAssetModal');
            document.getElementById('addAssetForm').reset();
            updateAssetFields();
            delete document.getElementById('addAssetForm').dataset.editingId;
            
            showNotification(
                `üèÜ ${isEditing ? '‡§∏‡§Ç‡§™‡§§‡•ç‡§§‡§ø ‡§Ö‡§™‡§°‡•á‡§ü' : '‡§∏‡§Ç‡§™‡§§‡•ç‡§§‡§ø ‡§ú‡•ã‡§°‡§º‡•Ä ‡§ó‡§à'} ‡§∏‡§´‡§≤‡§§‡§æ‡§™‡•Ç‡§∞‡•ç‡§µ‡§ï!`, 
                'success'
            );
        }

        function viewAssetTransactions(assetId) {
            const transactions = getRelatedTransactions(assetId, 'asset');
            const asset = getAssetById(assetId);
            
            if (transactions.length === 0) {
                showNotification('‡§á‡§∏ ‡§∏‡§Ç‡§™‡§§‡•ç‡§§‡§ø ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡•ã‡§à ‡§≤‡•á‡§®‡§¶‡•á‡§® ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡§æ', 'info');
                return;
            }
            
            // Show transactions in a simple alert for now
            let transactionList = `${asset.name} ‡§ï‡•á ‡§≤‡§ø‡§è ‡§≤‡•á‡§®‡§¶‡•á‡§®:\n\n`;
            transactions.forEach(t => {
                transactionList += `üìÖ ${new Date(t.date).toLocaleDateString('hi-IN')}\n`;
                transactionList += `üìù ${t.description}\n`;
                transactionList += `üí∞ ${t.type === 'income' ? '+' : '-'}‚Çπ${t.amount.toLocaleString('en-IN')}\n\n`;
            });
            
            alert(transactionList);
        }

        function getAssetById(assetId) {
            const assets = JSON.parse(localStorage.getItem(STORAGE_KEYS.ASSETS) || '[]');
            return assets.find(a => a.id === assetId);
        }

        function filterAssets(type) {
            const assets = JSON.parse(localStorage.getItem(STORAGE_KEYS.ASSETS) || '[]');
            const filteredAssets = type === 'all' ? assets : assets.filter(asset => asset.type === type);
            displayAssets(filteredAssets);
        }

        function filterCrops() {
            const statusFilter = document.getElementById('cropStatusFilter').value;
            const seasonFilter = document.getElementById('cropSeasonFilter').value;
            const searchFilter = document.getElementById('cropSearchFilter').value.toLowerCase();
            
            const crops = JSON.parse(localStorage.getItem(STORAGE_KEYS.CROPS) || '[]');
            
            const filteredCrops = crops.filter(crop => {
                const matchesStatus = !statusFilter || crop.status === statusFilter;
                const matchesSeason = !seasonFilter || crop.season === seasonFilter;
                const matchesSearch = !searchFilter || 
                    crop.name.toLowerCase().includes(searchFilter) ||
                    (crop.variety && crop.variety.toLowerCase().includes(searchFilter)) ||
                    crop.location.toLowerCase().includes(searchFilter);
                
                return matchesStatus && matchesSeason && matchesSearch;
            });
            
            displayCrops(filteredCrops);
        }

        // Ideas Management Functions
        function loadIdeas() {
            // Load predefined smart farming ideas
            const smartIdeas = [
                {
                    id: '1',
                    category: '‡§∏‡•ç‡§Æ‡§æ‡§∞‡•ç‡§ü ‡§ï‡•É‡§∑‡§ø',
                    title: '‡§°‡•ç‡§∞‡§ø‡§™ ‡§∏‡§ø‡§Ç‡§ö‡§æ‡§à ‡§™‡•ç‡§∞‡§£‡§æ‡§≤‡•Ä',
                    description: '‡§™‡§æ‡§®‡•Ä ‡§ï‡•Ä ‡§¨‡§ö‡§§ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§°‡•ç‡§∞‡§ø‡§™ ‡§∏‡§ø‡§Ç‡§ö‡§æ‡§à ‡§™‡•ç‡§∞‡§£‡§æ‡§≤‡•Ä ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡•á‡§Ç‡•§ ‡§á‡§∏‡§∏‡•á 30-50% ‡§§‡§ï ‡§™‡§æ‡§®‡•Ä ‡§ï‡•Ä ‡§¨‡§ö‡§§ ‡§π‡•ã ‡§∏‡§ï‡§§‡•Ä ‡§π‡•à‡•§',
                    icon: 'fas fa-tint',
                    benefits: ['‡§™‡§æ‡§®‡•Ä ‡§ï‡•Ä ‡§¨‡§ö‡§§', '‡§¨‡•á‡§π‡§§‡§∞ ‡§´‡§∏‡§≤', '‡§ï‡§Æ ‡§≤‡§æ‡§ó‡§§'],
                    implementationSteps: ['‡§∏‡§ø‡§∏‡•ç‡§ü‡§Æ ‡§°‡§ø‡§ú‡§æ‡§á‡§®', '‡§∏‡§æ‡§Æ‡§ó‡•ç‡§∞‡•Ä ‡§ñ‡§∞‡•Ä‡§¶‡•á‡§Ç', '‡§á‡§Ç‡§∏‡•ç‡§ü‡•â‡§≤‡•á‡§∂‡§®', '‡§ü‡•á‡§∏‡•ç‡§ü‡§ø‡§Ç‡§ó'],
                    estimatedCost: '‚Çπ15,000 - ‚Çπ25,000 ‡§™‡•ç‡§∞‡§§‡§ø ‡§è‡§ï‡§°‡§º',
                    timeframe: '2-3 ‡§∏‡§™‡•ç‡§§‡§æ‡§π'
                },
                {
                    id: '2',
                    category: '‡§∏‡§∞‡§ï‡§æ‡§∞‡•Ä ‡§Ø‡•ã‡§ú‡§®‡§æ',
                    title: '‡§™‡•ç‡§∞‡§ß‡§æ‡§®‡§Æ‡§Ç‡§§‡•ç‡§∞‡•Ä ‡§ï‡§ø‡§∏‡§æ‡§® ‡§∏‡§Æ‡•ç‡§Æ‡§æ‡§® ‡§®‡§ø‡§ß‡§ø',
                    description: '‡§∏‡§æ‡§≤‡§æ‡§®‡§æ ‚Çπ6,000 ‡§ï‡•Ä ‡§µ‡§ø‡§§‡•ç‡§§‡•Ä‡§Ø ‡§∏‡§π‡§æ‡§Ø‡§§‡§æ ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞‡•á‡§Ç‡•§ ‡§∏‡§≠‡•Ä ‡§õ‡•ã‡§ü‡•á ‡§î‡§∞ ‡§∏‡•Ä‡§Æ‡§æ‡§Ç‡§§ ‡§ï‡§ø‡§∏‡§æ‡§® ‡§á‡§∏ ‡§Ø‡•ã‡§ú‡§®‡§æ ‡§ï‡§æ ‡§≤‡§æ‡§≠ ‡§â‡§†‡§æ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§',
                    icon: 'fas fa-hand-holding-usd',
                    benefits: ['‡§µ‡§æ‡§∞‡•ç‡§∑‡§ø‡§ï ‚Çπ6,000', '‡§§‡•Å‡§∞‡§Ç‡§§ ‡§≠‡•Å‡§ó‡§§‡§æ‡§®', '‡§ë‡§®‡§≤‡§æ‡§á‡§® ‡§Ü‡§µ‡•á‡§¶‡§®'],
                    implementationSteps: ['‡§Ü‡§ß‡§æ‡§∞ ‡§ï‡§æ‡§∞‡•ç‡§° ‡§§‡•à‡§Ø‡§æ‡§∞ ‡§ï‡§∞‡•á‡§Ç', '‡§¨‡•à‡§Ç‡§ï ‡§°‡§ø‡§ü‡•á‡§≤‡•ç‡§∏', '‡§ë‡§®‡§≤‡§æ‡§á‡§® ‡§∞‡§ú‡§ø‡§∏‡•ç‡§ü‡•ç‡§∞‡•á‡§∂‡§®', '‡§µ‡•á‡§∞‡§ø‡§´‡§ø‡§ï‡•á‡§∂‡§®'],
                    estimatedCost: '‡§®‡§ø‡§É‡§∂‡•Å‡§≤‡•ç‡§ï',
                    timeframe: '‡§§‡•Å‡§∞‡§Ç‡§§'
                },
                {
                    id: '3',
                    category: '‡§â‡§®‡•ç‡§®‡§§ ‡§§‡§ï‡§®‡•Ä‡§ï',
                    title: '‡§∏‡•ã‡§≤‡§∞ ‡§™‡§Ç‡§™ ‡§∏‡§ø‡§∏‡•ç‡§ü‡§Æ',
                    description: '‡§∏‡•Ç‡§∞‡•ç‡§Ø ‡§ï‡•Ä ‡§ä‡§∞‡•ç‡§ú‡§æ ‡§∏‡•á ‡§ö‡§≤‡§®‡•á ‡§µ‡§æ‡§≤‡•á ‡§™‡§Ç‡§™ ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§ï‡•á ‡§¨‡§ø‡§ú‡§≤‡•Ä ‡§ï‡•Ä ‡§≤‡§æ‡§ó‡§§ ‡§¨‡§ö‡§æ‡§è‡§Ç ‡§î‡§∞ ‡§™‡§∞‡•ç‡§Ø‡§æ‡§µ‡§∞‡§£ ‡§ï‡•ã ‡§≠‡•Ä ‡§¨‡§ö‡§æ‡§è‡§Ç‡•§',
                    icon: 'fas fa-solar-panel',
                    benefits: ['‡§¨‡§ø‡§ú‡§≤‡•Ä ‡§ï‡•Ä ‡§¨‡§ö‡§§', '‡§™‡§∞‡•ç‡§Ø‡§æ‡§µ‡§∞‡§£ ‡§Ö‡§®‡•Å‡§ï‡•Ç‡§≤', '‡§≤‡§Ç‡§¨‡•Ä ‡§Ö‡§µ‡§ß‡§ø ‡§ï‡•Ä ‡§¨‡§ö‡§§'],
                    implementationSteps: ['‡§∏‡§æ‡§á‡§ü ‡§∏‡§∞‡•ç‡§µ‡•á', '‡§∏‡§ø‡§∏‡•ç‡§ü‡§Æ ‡§∏‡§æ‡§á‡§ú‡§º‡§ø‡§Ç‡§ó', '‡§á‡§Ç‡§∏‡•ç‡§ü‡•â‡§≤‡•á‡§∂‡§®', '‡§Æ‡•á‡§Ç‡§ü‡•á‡§®‡•á‡§Ç‡§∏'],
                    estimatedCost: '‚Çπ1,50,000 - ‚Çπ3,00,000',
                    timeframe: '1-2 ‡§Æ‡§π‡•Ä‡§®‡•á'
                },
                {
                    id: '4',
                    category: '‡§´‡§∏‡§≤ ‡§™‡•ç‡§∞‡§¨‡§Ç‡§ß‡§®',
                    title: '‡§ú‡•à‡§µ‡§ø‡§ï ‡§ñ‡§æ‡§¶ ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó',
                    description: '‡§∞‡§æ‡§∏‡§æ‡§Ø‡§®‡§ø‡§ï ‡§â‡§∞‡•ç‡§µ‡§∞‡§ï‡•ã‡§Ç ‡§ï‡•á ‡§¨‡§ú‡§æ‡§Ø ‡§ú‡•à‡§µ‡§ø‡§ï ‡§ñ‡§æ‡§¶ ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§ï‡•á ‡§Æ‡§ø‡§ü‡•ç‡§ü‡•Ä ‡§ï‡•Ä ‡§ó‡•Å‡§£‡§µ‡§§‡•ç‡§§‡§æ ‡§¨‡•á‡§π‡§§‡§∞ ‡§¨‡§®‡§æ‡§è‡§Ç‡•§',
                    icon: 'fas fa-seedling',
                    benefits: ['‡§Æ‡§ø‡§ü‡•ç‡§ü‡•Ä ‡§ï‡•Ä ‡§ó‡•Å‡§£‡§µ‡§§‡•ç‡§§‡§æ', '‡§¨‡•á‡§π‡§§‡§∞ ‡§∏‡•ç‡§µ‡§æ‡§∏‡•ç‡§•‡•ç‡§Ø', '‡§ï‡§Æ ‡§≤‡§æ‡§ó‡§§'],
                    implementationSteps: ['‡§ï‡§Ç‡§™‡•ã‡§∏‡•ç‡§ü ‡§§‡•à‡§Ø‡§æ‡§∞ ‡§ï‡§∞‡•á‡§Ç', '‡§µ‡§∞‡•ç‡§Æ‡•Ä ‡§ï‡§Æ‡•ç‡§™‡•ã‡§∏‡•ç‡§ü', '‡§Æ‡§ø‡§ü‡•ç‡§ü‡•Ä ‡§Æ‡•á‡§Ç ‡§Æ‡§ø‡§≤‡§æ‡§è‡§Ç', '‡§®‡§ø‡§Ø‡§Æ‡§ø‡§§ ‡§â‡§™‡§Ø‡•ã‡§ó'],
                    estimatedCost: '‚Çπ2,000 - ‚Çπ5,000 ‡§™‡•ç‡§∞‡§§‡§ø ‡§è‡§ï‡§°‡§º',
                    timeframe: '3-6 ‡§Æ‡§π‡•Ä‡§®‡•á'
                },
                {
                    id: '5',
                    category: '‡§°‡§ø‡§ú‡§ø‡§ü‡§≤ ‡§ï‡•É‡§∑‡§ø',
                    title: '‡§Æ‡•å‡§∏‡§Æ ‡§Ü‡§ß‡§æ‡§∞‡§ø‡§§ ‡§∏‡§≤‡§æ‡§π',
                    description: '‡§Æ‡•å‡§∏‡§Æ ‡§ï‡•Ä ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä ‡§ï‡•á ‡§Ü‡§ß‡§æ‡§∞ ‡§™‡§∞ ‡§´‡§∏‡§≤ ‡§ï‡•Ä ‡§¨‡•Å‡§Ü‡§à, ‡§∏‡§ø‡§Ç‡§ö‡§æ‡§à ‡§î‡§∞ ‡§ï‡§ü‡§æ‡§à ‡§ï‡§æ ‡§∏‡§π‡•Ä ‡§∏‡§Æ‡§Ø ‡§®‡§ø‡§∞‡•ç‡§ß‡§æ‡§∞‡§ø‡§§ ‡§ï‡§∞‡•á‡§Ç‡•§',
                    icon: 'fas fa-cloud-sun',
                    benefits: ['‡§¨‡•á‡§π‡§§‡§∞ ‡§Ø‡•ã‡§ú‡§®‡§æ', '‡§®‡•Å‡§ï‡§∏‡§æ‡§® ‡§∏‡•á ‡§¨‡§ö‡§æ‡§µ', '‡§Ö‡§ß‡§ø‡§ï ‡§â‡§§‡•ç‡§™‡§æ‡§¶‡§®'],
                    implementationSteps: ['‡§Æ‡•å‡§∏‡§Æ ‡§ê‡§™ ‡§°‡§æ‡§â‡§®‡§≤‡•ã‡§°', '‡§¶‡•à‡§®‡§ø‡§ï ‡§Ö‡§™‡§°‡•á‡§ü', '‡§Ø‡•ã‡§ú‡§®‡§æ ‡§¨‡§®‡§æ‡§è‡§Ç', '‡§ï‡§æ‡§∞‡•ç‡§Ø‡§æ‡§®‡•ç‡§µ‡§Ø‡§®'],
                    estimatedCost: '‡§®‡§ø‡§É‡§∂‡•Å‡§≤‡•ç‡§ï',
                    timeframe: '‡§§‡•Å‡§∞‡§Ç‡§§'
                },
                {
                    id: '6',
                    category: '‡§µ‡§ø‡§§‡•ç‡§§‡•Ä‡§Ø ‡§Ø‡•ã‡§ú‡§®‡§æ',
                    title: '‡§´‡§∏‡§≤ ‡§¨‡•Ä‡§Æ‡§æ ‡§Ø‡•ã‡§ú‡§®‡§æ',
                    description: '‡§™‡•ç‡§∞‡§æ‡§ï‡•É‡§§‡§ø‡§ï ‡§Ü‡§™‡§¶‡§æ‡§ì‡§Ç ‡§∏‡•á ‡§π‡•ã‡§®‡•á ‡§µ‡§æ‡§≤‡•á ‡§®‡•Å‡§ï‡§∏‡§æ‡§® ‡§∏‡•á ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§æ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§´‡§∏‡§≤ ‡§¨‡•Ä‡§Æ‡§æ ‡§ï‡§∞‡§æ‡§è‡§Ç‡•§',
                    icon: 'fas fa-shield-alt',
                    benefits: ['‡§ú‡•ã‡§ñ‡§ø‡§Æ ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§æ', '‡§µ‡§ø‡§§‡•ç‡§§‡•Ä‡§Ø ‡§∏‡§π‡§æ‡§Ø‡§§‡§æ', '‡§Æ‡§æ‡§®‡§∏‡§ø‡§ï ‡§∂‡§æ‡§Ç‡§§‡§ø'],
                    implementationSteps: ['‡§¨‡•Ä‡§Æ‡§æ ‡§ï‡§Ç‡§™‡§®‡•Ä ‡§ö‡•Å‡§®‡•á‡§Ç', '‡§¶‡§∏‡•ç‡§§‡§æ‡§µ‡•á‡§ú ‡§§‡•à‡§Ø‡§æ‡§∞ ‡§ï‡§∞‡•á‡§Ç', '‡§Ü‡§µ‡•á‡§¶‡§® ‡§≠‡§∞‡•á‡§Ç', '‡§™‡•ç‡§∞‡•Ä‡§Æ‡§ø‡§Ø‡§Æ ‡§≠‡•Å‡§ó‡§§‡§æ‡§®'],
                    estimatedCost: '‚Çπ500 - ‚Çπ2,000 ‡§™‡•ç‡§∞‡§§‡§ø ‡§è‡§ï‡§°‡§º',
                    timeframe: '1 ‡§∏‡§™‡•ç‡§§‡§æ‡§π'
                }
            ];
            
            displayIdeas(smartIdeas);
        }

        function displayIdeas(ideas) {
            const ideasGrid = document.getElementById('ideasGrid');
            
            ideasGrid.innerHTML = ideas.map(idea => `
                <div class="idea-card">
                    <div class="idea-category">${idea.category}</div>
                    <i class="${idea.icon} idea-icon"></i>
                    <h3 style="color: var(--primary-color); margin-bottom: 1rem;">${idea.title}</h3>
                    <p style="margin-bottom: 1.5rem; line-height: 1.6;">${idea.description}</p>
                    
                    <div style="margin-bottom: 1.5rem;">
                        <h4 style="color: var(--primary-color); margin-bottom: 0.5rem;"><i class="fas fa-star"></i> ‡§≤‡§æ‡§≠</h4>
                        <ul style="list-style: none; padding: 0;">
                            ${idea.benefits.map(benefit => `<li style="padding: 0.25rem 0; color: var(--success-color);"><i class="fas fa-check-circle"></i> ${benefit}</li>`).join('')}
                        </ul>
                    </div>
                    
                    <div style="background: rgba(46, 125, 50, 0.05); padding: 1rem; border-radius: 12px; margin-bottom: 1.5rem;">
                        <div style="margin-bottom: 0.5rem;"><strong>üí∞ ‡§Ö‡§®‡•Å‡§Æ‡§æ‡§®‡§ø‡§§ ‡§≤‡§æ‡§ó‡§§:</strong> ${idea.estimatedCost}</div>
                        <div><strong>‚è±Ô∏è ‡§∏‡§Æ‡§Ø ‡§∏‡•Ä‡§Æ‡§æ:</strong> ${idea.timeframe}</div>
                    </div>
                    
                    <div style="margin-bottom: 1.5rem;">
                        <h4 style="color: var(--primary-color); margin-bottom: 0.5rem;"><i class="fas fa-list-ol"></i> ‡§ï‡§æ‡§∞‡•ç‡§Ø‡§æ‡§®‡•ç‡§µ‡§Ø‡§® ‡§ö‡§∞‡§£</h4>
                        <ol style="padding-left: 1.5rem;">
                            ${idea.implementationSteps.map(step => `<li style="padding: 0.25rem 0;">${step}</li>`).join('')}
                        </ol>
                    </div>
                    
                    <div class="flex gap-2">
                        <button class="btn btn-primary" onclick="implementIdea('${idea.id}')">
                            <i class="fas fa-rocket"></i> ‡§∂‡•Å‡§∞‡•Ç ‡§ï‡§∞‡•á‡§Ç
                        </button>
                        <button class="btn btn-secondary" onclick="saveIdeaForLater('${idea.id}')">
                            <i class="fas fa-bookmark"></i> ‡§¨‡§æ‡§¶ ‡§Æ‡•á‡§Ç
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function implementIdea(ideaId) {
            showNotification('‡§Ø‡§π ‡§∏‡•Å‡§ù‡§æ‡§µ ‡§Ü‡§™‡§ï‡•Ä ‡§Ø‡•ã‡§ú‡§®‡§æ ‡§Æ‡•á‡§Ç ‡§ú‡•ã‡§°‡§º ‡§¶‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§π‡•à! üí°', 'success');
            
            // In a full implementation, this would create action items or reminders
            const userIdeas = JSON.parse(localStorage.getItem(STORAGE_KEYS.IDEAS) || '[]');
            userIdeas.push({
                id: ideaId,
                status: 'implementing',
                startDate: new Date().toISOString(),
                notes: ''
            });
            localStorage.setItem(STORAGE_KEYS.IDEAS, JSON.stringify(userIdeas));
            autoSaveToFirebase();
        }

        function saveIdeaForLater(ideaId) {
            showNotification('‡§∏‡•Å‡§ù‡§æ‡§µ ‡§∏‡•á‡§µ ‡§ï‡§∞ ‡§¶‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§π‡•à! üìå', 'info');
            
            const userIdeas = JSON.parse(localStorage.getItem(STORAGE_KEYS.IDEAS) || '[]');
            userIdeas.push({
                id: ideaId,
                status: 'saved',
                savedDate: new Date().toISOString(),
                notes: ''
            });
            localStorage.setItem(STORAGE_KEYS.IDEAS, JSON.stringify(userIdeas));
            autoSaveToFirebase();
        }

        // Weather Functions
        async function getCurrentLocationWeather() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(
                    async (position) => {
                        try {
                            const lat = position.coords.latitude;
                            const lon = position.coords.longitude;
                            
                            // Get location name from coordinates
                            await getLocationName(lat, lon);
                            await getWeatherByCoordinates(lat, lon);
                        } catch (error) {
                            console.error('Weather error:', error);
                            showSampleWeatherData();
                        }
                    },
                    () => {
                        console.log('Location access denied');
                        showSampleWeatherData();
                    }
                );
            } else {
                showSampleWeatherData();
            }
        }

        async function getLocationName(lat, lon) {
            try {
                const response = await fetch(`https://api.openweathermap.org/geo/1.0/reverse?lat=${lat}&lon=${lon}&limit=1&appid=${WEATHER_API_KEY}`);
                if (response.ok) {
                    const data = await response.json();
                    if (data.length > 0) {
                        const locationName = `${data[0].name}, ${data[0].state || data[0].country}`;
                        document.getElementById('locationName').textContent = locationName;
                    }
                }
            } catch (error) {
                console.error('Location name error:', error);
                document.getElementById('locationName').textContent = '‡§Ü‡§™‡§ï‡§æ ‡§∏‡•ç‡§•‡§æ‡§®';
            }
        }

        async function getWeatherByCoordinates(lat, lon) {
            try {
                // Current weather
                const currentResponse = await fetch(`${WEATHER_API_BASE}/weather?lat=${lat}&lon=${lon}&appid=${WEATHER_API_KEY}&units=metric&lang=hi`);
                if (currentResponse.ok) {
                    const currentData = await currentResponse.json();
                    updateWeatherDisplay(currentData);
                }
                
                // 5-day forecast
                const forecastResponse = await fetch(`${WEATHER_API_BASE}/forecast?lat=${lat}&lon=${lon}&appid=${WEATHER_API_KEY}&units=metric&lang=hi`);
                if (forecastResponse.ok) {
                    const forecastData = await forecastResponse.json();
                    updateForecastDisplay(forecastData);
                }
            } catch (error) {
                console.error('Weather API error:', error);
                showSampleWeatherData();
            }
        }

        async function getWeatherData(location) {
            try {
                const response = await fetch(`${WEATHER_API_BASE}/weather?q=${location}&appid=${WEATHER_API_KEY}&units=metric&lang=hi`);
                
                if (!response.ok) {
                    throw new Error(`Weather API error: ${response.status}`);
                }
                
                const data = await response.json();
                updateWeatherDisplay(data);
                
                // Cache weather data
                localStorage.setItem(STORAGE_KEYS.WEATHER_CACHE, JSON.stringify({
                    data: data,
                    timestamp: Date.now(),
                    location: location
                }));
                
            } catch (error) {
                console.error('Weather API error:', error);
                showSampleWeatherData();
            }
        }

        function updateWeatherDisplay(data) {
            const temp = Math.round(data.main?.temp || 25);
            const description = data.weather?.[0]?.description || '‡§∏‡§æ‡§´ ‡§Æ‡•å‡§∏‡§Æ';
            const humidity = data.main?.humidity || 65;
            const windSpeed = Math.round((data.wind?.speed || 5) * 3.6); // Convert m/s to km/h
            const feelsLike = Math.round(data.main?.feels_like || temp + 2);
            const pressure = data.main?.pressure || 1013;
            const visibility = Math.round((data.visibility || 10000) / 1000); // Convert m to km
            
            // Update dashboard weather widget
            document.getElementById('weatherTemp').textContent = `${temp}¬∞C`;
            document.getElementById('weatherDesc').textContent = description.charAt(0).toUpperCase() + description.slice(1);
            document.getElementById('weatherHumidity').textContent = `${humidity}%`;
            document.getElementById('weatherWind').textContent = `${windSpeed} km/h`;
            document.getElementById('weatherFeels').textContent = `${feelsLike}¬∞C`;
            document.getElementById('weatherRain').textContent = `${Math.floor(Math.random() * 100)}%`;
            
            // Update header weather
            document.getElementById('headerTemp').textContent = `${temp}¬∞C`;
            
            // Update detailed weather section if visible
            const currentWeatherDisplay = document.getElementById('currentWeatherDisplay');
            if (currentWeatherDisplay && !document.getElementById('weather').classList.contains('hidden')) {
                document.getElementById('currentWeatherTemp').textContent = `${temp}¬∞C`;
                document.getElementById('currentWeatherDesc').textContent = description.charAt(0).toUpperCase() + description.slice(1);
                document.getElementById('currentWeatherHumidity').textContent = `${humidity}%`;
                document.getElementById('currentWeatherWind').textContent = `${windSpeed} km/h`;
                document.getElementById('currentWeatherPressure').textContent = `${pressure} hPa`;
                document.getElementById('currentWeatherVisibility').textContent = `${visibility} km`;
            }
            
            // Update weather icon
            updateWeatherIcon((data.weather?.[0]?.main || 'Clear').toLowerCase());
        }

        function updateForecastDisplay(forecastData) {
            const forecastDays = document.getElementById('forecastDays');
            if (!forecastDays) return;
            
            // Get forecast for next 5 days (every 24 hours)
            const dailyForecasts = [];
            const today = new Date();
            
            for (let i = 0; i < 5; i++) {
                const targetDate = new Date(today);
                targetDate.setDate(today.getDate() + i);
                
                // Find forecast entry closest to noon of target date
                const targetTime = new Date(targetDate);
                targetTime.setHours(12, 0, 0, 0);
                
                let closestForecast = null;
                let minTimeDiff = Infinity;
                
                forecastData.list.forEach(forecast => {
                    const forecastDate = new Date(forecast.dt * 1000);
                    const timeDiff = Math.abs(forecastDate - targetTime);
                    
                    if (timeDiff < minTimeDiff) {
                        minTimeDiff = timeDiff;
                        closestForecast = forecast;
                    }
                });
                
                if (closestForecast) {
                    dailyForecasts.push({
                        day: i === 0 ? '‡§Ü‡§ú' : i === 1 ? '‡§ï‡§≤' : targetDate.toLocaleDateString('hi-IN', { weekday: 'short' }),
                        temp: Math.round(closestForecast.main.temp),
                        icon: getWeatherIconClass(closestForecast.weather[0].main.toLowerCase()),
                        rain: Math.floor(Math.random() * 100) // Mock rain percentage
                    });
                }
            }
            
            forecastDays.innerHTML = dailyForecasts.map(forecast => `
                <div class="forecast-day">
                    <div style="font-size: 0.8rem; margin-bottom: 0.5rem; font-weight: 600;">${forecast.day}</div>
                    <i class="${forecast.icon}" style="margin-bottom: 0.5rem; font-size: 1.5rem;"></i>
                    <div style="font-size: 0.9rem; font-weight: bold; margin-bottom: 0.25rem;">${forecast.temp}¬∞C</div>
                    <div style="font-size: 0.7rem; color: var(--info-color);">${forecast.rain}% üåßÔ∏è</div>
                </div>
            `).join('');
        }

        function updateWeatherIcon(condition) {
            const iconClass = getWeatherIconClass(condition);
            
            const weatherIcon = document.getElementById('weatherIcon');
            const currentWeatherIcon = document.getElementById('currentWeatherIcon');
            
            if (weatherIcon) weatherIcon.innerHTML = `<i class="${iconClass}"></i>`;
            if (currentWeatherIcon) currentWeatherIcon.innerHTML = `<i class="${iconClass}"></i>`;
        }

        function getWeatherIconClass(condition) {
            const icons = {
                clear: 'fas fa-sun',
                clouds: 'fas fa-cloud',
                rain: 'fas fa-cloud-rain',
                drizzle: 'fas fa-cloud-drizzle',
                thunderstorm: 'fas fa-bolt',
                snow: 'fas fa-snowflake',
                mist: 'fas fa-smog',
                fog: 'fas fa-smog',
                haze: 'fas fa-smog'
            };
            
            return icons[condition] || 'fas fa-sun';
        }

        function showSampleWeatherData() {
            const temp = 28 + Math.round(Math.random() * 10 - 5);
            const humidity = 60 + Math.round(Math.random() * 30);
            const windSpeed = 5 + Math.round(Math.random() * 15);
            
            document.getElementById('weatherTemp').textContent = `${temp}¬∞C`;
            document.getElementById('weatherDesc').textContent = '‡§Ü‡§Ç‡§∂‡§ø‡§ï ‡§¨‡§æ‡§¶‡§≤';
            document.getElementById('weatherHumidity').textContent = `${humidity}%`;
            document.getElementById('weatherWind').textContent = `${windSpeed} km/h`;
            document.getElementById('weatherFeels').textContent = `${temp + 2}¬∞C`;
            document.getElementById('weatherRain').textContent = `${Math.floor(Math.random() * 100)}%`;
            
            document.getElementById('headerTemp').textContent = `${temp}¬∞C`;
            document.getElementById('locationName').textContent = '‡§Ü‡§™‡§ï‡§æ ‡§∏‡•ç‡§•‡§æ‡§®';
            
            updateWeatherIcon('clouds');
        }

        // Quick Actions Functions
        function showQuickActions() {
            const menu = document.getElementById('quickActionsMenu');
            if (quickActionsVisible) {
                hideQuickActions();
            } else {
                menu.classList.add('show');
                quickActionsVisible = true;
                document.getElementById('fabButton').innerHTML = '<i class="fas fa-times"></i>';
            }
        }

        function hideQuickActions() {
            const menu = document.getElementById('quickActionsMenu');
            menu.classList.remove('show');
            quickActionsVisible = false;
            document.getElementById('fabButton').innerHTML = '<i class="fas fa-plus"></i>';
        }

        // Chart Functions
        function initializeCharts() {
            if (document.getElementById('incomeExpenseChart')) {
                createIncomeExpenseChart();
            }
        }

        function createIncomeExpenseChart() {
            const ctx = document.getElementById('incomeExpenseChart');
            if (!ctx) return;
            
            const transactions = JSON.parse(localStorage.getItem(STORAGE_KEYS.TRANSACTIONS) || '[]');
            const monthlyData = processMonthlyTransactions(transactions);
            
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: monthlyData.labels,
                    datasets: [{
                        label: '‡§Ü‡§Ø',
                        data: monthlyData.income,
                        backgroundColor: 'rgba(76, 175, 80, 0.8)',
                        borderColor: 'rgba(76, 175, 80, 1)',
                        borderWidth: 2,
                        borderRadius: 8,
                        borderSkipped: false,
                    }, {
                        label: '‡§ñ‡§∞‡•ç‡§ö',
                        data: monthlyData.expenses,
                        backgroundColor: 'rgba(244, 67, 54, 0.8)',
                        borderColor: 'rgba(244, 67, 54, 1)',
                        borderWidth: 2,
                        borderRadius: 8,
                        borderSkipped: false,
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            labels: {
                                usePointStyle: true,
                                padding: 20,
                                font: {
                                    size: 14,
                                    weight: 'bold'
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            grid: {
                                display: false
                            },
                            ticks: {
                                font: {
                                    weight: 'bold'
                                }
                            }
                        },
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return '‚Çπ' + (value / 1000) + 'K';
                                },
                                font: {
                                    weight: 'bold'
                                }
                            }
                        }
                    }
                }
            });
        }

        function processMonthlyTransactions(transactions) {
            const months = ['‡§ú‡§®‡§µ‡§∞‡•Ä', '‡§´‡§∞‡§µ‡§∞‡•Ä', '‡§Æ‡§æ‡§∞‡•ç‡§ö', '‡§Ö‡§™‡•ç‡§∞‡•à‡§≤', '‡§Æ‡§à', '‡§ú‡•Ç‡§®'];
            const income = new Array(6).fill(0);
            const expenses = new Array(6).fill(0);
            
            const now = new Date();
            
            transactions.forEach(transaction => {
                const transactionDate = new Date(transaction.date);
                const monthsAgo = (now.getFullYear() - transactionDate.getFullYear()) * 12 + 
                                 (now.getMonth() - transactionDate.getMonth());
                
                if (monthsAgo >= 0 && monthsAgo < 6) {
                    const index = 5 - monthsAgo;
                    if (transaction.type === 'income') {
                        income[index] += transaction.amount;
                    } else {
                        expenses[index] += transaction.amount;
                    }
                }
            });
            
            return { labels: months, income, expenses };
        }

        // Settings and Profile Functions
        function loadSettings() {
            const settings = JSON.parse(localStorage.getItem(STORAGE_KEYS.SETTINGS) || '{}');
            
            if (settings.theme) {
                setTheme(settings.theme);
            }
            
            if (settings.language) {
                changeLanguage(settings.language);
            }
        }

        function saveSettings() {
            const settings = {
                theme: currentTheme,
                language: currentLanguage,
                lastSaved: new Date().toISOString()
            };
            
            localStorage.setItem(STORAGE_KEYS.SETTINGS, JSON.stringify(settings));
            autoSaveToFirebase();
        }

        function toggleTheme() {
            currentTheme = currentTheme === 'light' ? 'dark' : 'light';
            setTheme(currentTheme);
        }

        function setTheme(theme) {
            currentTheme = theme;
            document.documentElement.setAttribute('data-theme', theme);
            updateThemeIcon();
            saveSettings();
        }

        function updateThemeIcon() {
            const icon = document.querySelector('#themeToggle i');
            if (icon) {
                icon.className = currentTheme === 'light' ? 'fas fa-moon' : 'fas fa-sun';
            }
        }

        function changeLanguage(language) {
            currentLanguage = language;
            document.getElementById('languageSelect').value = language;
            document.getElementById('settingsLanguage').value = language;
            
            applyTranslations();
            saveSettings();
        }

        function applyTranslations() {
            const elements = document.querySelectorAll('[id]');
            elements.forEach(element => {
                const key = element.id;
                if (translations[currentLanguage] && translations[currentLanguage][key]) {
                    if (element.tagName === 'INPUT' && element.placeholder) {
                        element.placeholder = translations[currentLanguage][key];
                    } else if (element.textContent) {
                        element.textContent = translations[currentLanguage][key];
                    }
                }
            });
            
            // Apply language-specific CSS classes
            if (currentLanguage === 'hi') {
                document.body.classList.add('hindi-text');
                document.body.classList.remove('telugu-text');
            } else if (currentLanguage === 'te') {
                document.body.classList.add('telugu-text');
                document.body.classList.remove('hindi-text');
            } else {
                document.body.classList.remove('hindi-text', 'telugu-text');
            }
        }

        async function handleUpdateProfile(e) {
            e.preventDefault();
            
            const profileData = {
                name: document.getElementById('profileName').value,
                email: document.getElementById('profileEmail').value,
                phone: document.getElementById('profilePhone').value,
                location: document.getElementById('profileLocation').value,
                farmSize: parseFloat(document.getElementById('profileFarmSize').value) || 0,
                updatedAt: new Date().toISOString()
            };
            
            try {
                if (currentUser && currentUser.uid) {
                    // Update in Firestore
                    await db.collection('users').doc(currentUser.uid).update(profileData);
                }
                
                // Update locally
                const userData = JSON.parse(localStorage.getItem(STORAGE_KEYS.USER_DATA) || '{}');
                localStorage.setItem(STORAGE_KEYS.USER_DATA, JSON.stringify({...userData, ...profileData}));
                
                // Update location display
                if (profileData.location) {
                    document.getElementById('locationName').textContent = profileData.location;
                    getWeatherData(profileData.location);
                }
                
                showNotification('üë§ ‡§™‡•ç‡§∞‡•ã‡§´‡§º‡§æ‡§á‡§≤ ‡§∏‡§´‡§≤‡§§‡§æ‡§™‡•Ç‡§∞‡•ç‡§µ‡§ï ‡§Ö‡§™‡§°‡•á‡§ü ‡§ï‡•Ä ‡§ó‡§à!', 'success');
                autoSaveToFirebase();
            } catch (error) {
                console.error('Profile update error:', error);
                showNotification('‡§™‡•ç‡§∞‡•ã‡§´‡§º‡§æ‡§á‡§≤ ‡§Ö‡§™‡§°‡•á‡§ü ‡§ï‡§∞‡§®‡•á ‡§Æ‡•á‡§Ç ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø', 'error');
            }
        }

        // Data Management Functions
        async function exportAllData() {
            try {
                showNotification('üìÑ ‡§µ‡•ç‡§Ø‡§æ‡§™‡§ï ‡§ï‡•É‡§∑‡§ø ‡§∞‡§ø‡§™‡•ã‡§∞‡•ç‡§ü ‡§§‡•à‡§Ø‡§æ‡§∞ ‡§ï‡•Ä ‡§ú‡§æ ‡§∞‡§π‡•Ä ‡§π‡•à...', 'info');
                
                const userData = JSON.parse(localStorage.getItem(STORAGE_KEYS.USER_DATA) || '{}');
                const crops = JSON.parse(localStorage.getItem(STORAGE_KEYS.CROPS) || '[]');
                const transactions = JSON.parse(localStorage.getItem(STORAGE_KEYS.TRANSACTIONS) || '[]');
                const assets = JSON.parse(localStorage.getItem(STORAGE_KEYS.ASSETS) || '[]');
                
                const { jsPDF } = window.jspdf;
                const doc = new jsPDF();
                
                let yPos = 20;
                
                // Header
                doc.setFontSize(24);
                doc.text('JamaApp ‡§ï‡•É‡§∑‡§ø ‡§∞‡§ø‡§™‡•ã‡§∞‡•ç‡§ü', 20, yPos);
                yPos += 10;
                doc.setFontSize(12);
                doc.text(`‡§§‡•à‡§Ø‡§æ‡§∞ ‡§ï‡•Ä ‡§ó‡§à: ${new Date().toLocaleDateString('hi-IN')}`, 20, yPos);
                yPos += 20;
                
                // Farm Overview
                doc.setFontSize(16);
                doc.text('‡§ï‡•É‡§∑‡§ø ‡§Ö‡§µ‡§≤‡•ã‡§ï‡§®', 20, yPos);
                yPos += 10;
                doc.setFontSize(12);
                doc.text(`‡§ï‡§ø‡§∏‡§æ‡§®: ${userData.name || '‡§®‡§ø‡§∞‡•ç‡§¶‡§ø‡§∑‡•ç‡§ü ‡§®‡§π‡•Ä‡§Ç'}`, 20, yPos);
                yPos += 8;
                doc.text(`‡§∏‡•ç‡§•‡§æ‡§®: ${userData.location || '‡§®‡§ø‡§∞‡•ç‡§¶‡§ø‡§∑‡•ç‡§ü ‡§®‡§π‡•Ä‡§Ç'}`, 20, yPos);
                yPos += 8;
                doc.text(`‡§ñ‡•á‡§§ ‡§ï‡§æ ‡§Ü‡§ï‡§æ‡§∞: ${userData.farmSize || 0} ‡§è‡§ï‡§°‡§º`, 20, yPos);
                yPos += 15;
                
                // Financial Summary
                const totalIncome = transactions.filter(t => t.type === 'income').reduce((sum, t) => sum + t.amount, 0);
                const totalExpenses = transactions.filter(t => t.type === 'expense').reduce((sum, t) => sum + t.amount, 0);
                
                doc.setFontSize(16);
                doc.text('‡§µ‡§ø‡§§‡•ç‡§§‡•Ä‡§Ø ‡§∏‡§æ‡§∞‡§æ‡§Ç‡§∂', 20, yPos);
                yPos += 10;
                doc.setFontSize(12);
                doc.text(`‡§ï‡•Å‡§≤ ‡§Ü‡§Ø: ‚Çπ${totalIncome.toLocaleString('hi-IN')}`, 20, yPos);
                yPos += 8;
                doc.text(`‡§ï‡•Å‡§≤ ‡§ñ‡§∞‡•ç‡§ö: ‚Çπ${totalExpenses.toLocaleString('hi-IN')}`, 20, yPos);
                yPos += 8;
                doc.text(`‡§∂‡•Å‡§¶‡•ç‡§ß ‡§≤‡§æ‡§≠: ‚Çπ${(totalIncome - totalExpenses).toLocaleString('hi-IN')}`, 20, yPos);
                yPos += 8;
                doc.text(`‡§ï‡•Å‡§≤ ‡§≤‡•á‡§®‡§¶‡•á‡§®: ${transactions.length}`, 20, yPos);
                yPos += 15;
                
                // Crop Summary
                doc.setFontSize(16);
                doc.text('‡§´‡§∏‡§≤ ‡§∏‡§æ‡§∞‡§æ‡§Ç‡§∂', 20, yPos);
                yPos += 10;
                doc.setFontSize(12);
                doc.text(`‡§ï‡•Å‡§≤ ‡§´‡§∏‡§≤‡•á‡§Ç: ${crops.length}`, 20, yPos);
                yPos += 8;
                doc.text(`‡§∏‡§ï‡•ç‡§∞‡§ø‡§Ø ‡§´‡§∏‡§≤‡•á‡§Ç: ${crops.filter(c => c.status === 'active').length}`, 20, yPos);
                yPos += 8;
                doc.text(`‡§ï‡§ü‡§æ‡§à ‡§ï‡•Ä ‡§ó‡§à ‡§´‡§∏‡§≤‡•á‡§Ç: ${crops.filter(c => c.status === 'harvested').length}`, 20, yPos);
                yPos += 15;
                
                // Asset Summary
                doc.setFontSize(16);
                doc.text('‡§∏‡§Ç‡§™‡§§‡•ç‡§§‡§ø ‡§∏‡§æ‡§∞‡§æ‡§Ç‡§∂', 20, yPos);
                yPos += 10;
                doc.setFontSize(12);
                doc.text(`‡§ï‡•Å‡§≤ ‡§∏‡§Ç‡§™‡§§‡•ç‡§§‡§ø‡§Ø‡§æ‡§Ç: ${assets.length}`, 20, yPos);
                yPos += 8;
                doc.text(`‡§â‡§™‡§ï‡§∞‡§£: ${assets.filter(a => a.type === 'equipment').length}`, 20, yPos);
                yPos += 8;
                doc.text(`‡§™‡§∂‡•Å‡§ß‡§®: ${assets.filter(a => a.type === 'livestock').length}`, 20, yPos);
                yPos += 8;
                doc.text(`‡§≠‡•Ç‡§Æ‡§ø ‡§™‡•ç‡§≤‡•â‡§ü: ${assets.filter(a => a.type === 'land').length}`, 20, yPos);
                
                // Save the PDF
                doc.save(`JamaApp-‡§ï‡•É‡§∑‡§ø-‡§∞‡§ø‡§™‡•ã‡§∞‡•ç‡§ü-${new Date().toISOString().split('T')[0]}.pdf`);
                showNotification('üìä ‡§ï‡•É‡§∑‡§ø ‡§∞‡§ø‡§™‡•ã‡§∞‡•ç‡§ü ‡§∏‡§´‡§≤‡§§‡§æ‡§™‡•Ç‡§∞‡•ç‡§µ‡§ï ‡§®‡§ø‡§∞‡•ç‡§Ø‡§æ‡§§ ‡§ï‡•Ä ‡§ó‡§à!', 'success');
            } catch (error) {
                console.error('Export error:', error);
                showNotification('‡§°‡•á‡§ü‡§æ ‡§®‡§ø‡§∞‡•ç‡§Ø‡§æ‡§§ ‡§ï‡§∞‡§®‡•á ‡§Æ‡•á‡§Ç ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø', 'error');
            }
        }

        async function backupData() {
            if (currentUser && currentUser.uid) {
                showNotification('‚òÅÔ∏è ‡§Ü‡§™‡§ï‡§æ ‡§ï‡•É‡§∑‡§ø ‡§°‡•á‡§ü‡§æ ‡§ï‡•ç‡§≤‡§æ‡§â‡§° ‡§™‡§∞ ‡§¨‡•à‡§ï‡§Ö‡§™ ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à...', 'info');
                await autoSaveToFirebase();
                showNotification('‚úÖ ‡§°‡•á‡§ü‡§æ ‡§∏‡§´‡§≤‡§§‡§æ‡§™‡•Ç‡§∞‡•ç‡§µ‡§ï ‡§ï‡•ç‡§≤‡§æ‡§â‡§° ‡§™‡§∞ ‡§¨‡•à‡§ï‡§Ö‡§™ ‡§π‡•ã ‡§ó‡§Ø‡§æ!', 'success');
            } else {
                showNotification('‡§ï‡•ç‡§≤‡§æ‡§â‡§° ‡§¨‡•à‡§ï‡§Ö‡§™ ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡•É‡§™‡§Ø‡§æ ‡§∏‡§æ‡§á‡§® ‡§á‡§® ‡§ï‡§∞‡•á‡§Ç', 'warning');
            }
        }

        function clearAllData() {
            const confirmation = prompt('‚ö†Ô∏è ‡§ö‡•á‡§§‡§æ‡§µ‡§®‡•Ä: ‡§á‡§∏‡§∏‡•á ‡§Ü‡§™‡§ï‡§æ ‡§∏‡§≠‡•Ä ‡§ï‡•É‡§∑‡§ø ‡§°‡•á‡§ü‡§æ ‡§π‡§ü ‡§ú‡§æ‡§è‡§ó‡§æ!\n\n"‡§∏‡§≠‡•Ä ‡§°‡•á‡§ü‡§æ ‡§π‡§ü‡§æ‡§è‡§Ç" ‡§ü‡§æ‡§á‡§™ ‡§ï‡§∞‡§ï‡•á ‡§™‡•Å‡§∑‡•ç‡§ü‡§ø ‡§ï‡§∞‡•á‡§Ç:');
            if (confirmation === '‡§∏‡§≠‡•Ä ‡§°‡•á‡§ü‡§æ ‡§π‡§ü‡§æ‡§è‡§Ç') {
                Object.values(STORAGE_KEYS).forEach(key => {
                    localStorage.removeItem(key);
                });
                showNotification('üóëÔ∏è ‡§∏‡§≠‡•Ä ‡§°‡•á‡§ü‡§æ ‡§∏‡§æ‡§´ ‡§ï‡§∞ ‡§¶‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ! ‡§™‡•Å‡§®‡§É ‡§≤‡•ã‡§° ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à...', 'warning');
                setTimeout(() => {
                    location.reload();
                }, 2000);
            } else {
                showNotification('‚ùå ‡§°‡•á‡§ü‡§æ ‡§π‡§ü‡§æ‡§®‡§æ ‡§∞‡§¶‡•ç‡§¶ ‡§ï‡§∞ ‡§¶‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ', 'info');
            }
        }

        // Utility Functions
        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
            
            // Reset forms
            const form = document.querySelector(`#${modalId} form`);
            if (form) {
                form.reset();
                form.removeAttribute('data-editing-id');
            }
            
            // Reset specific modal states
            if (modalId === 'addCropModal') {
                document.getElementById('cropImagePreview').style.display = 'none';
                updateAreaValue(1);
            } else if (modalId === 'addAssetModal') {
                updateAssetFields();
            } else if (modalId === 'harvestModal') {
                document.getElementById('harvestConfirmation').style.display = 'block';
                document.getElementById('harvestForm').style.display = 'none';
            }
        }

        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            
            let icon = 'fas fa-info-circle';
            switch(type) {
                case 'success': icon = 'fas fa-check-circle'; break;
                case 'error': icon = 'fas fa-exclamation-circle'; break;
                case 'warning': icon = 'fas fa-exclamation-triangle'; break;
            }
            
            notification.innerHTML = `<i class="${icon}" style="margin-right: 0.75rem;"></i>${message}`;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.opacity = '0';
                notification.style.transform = 'translateX(100%)';
                setTimeout(() => {
                    if (document.body.contains(notification)) {
                        document.body.removeChild(notification);
                    }
                }, 300);
            }, 5000);
        }

        function getErrorMessage(errorCode) {
            const errorMessages = {
                'auth/invalid-email': '‡§ó‡§≤‡§§ ‡§à‡§Æ‡•á‡§≤ ‡§™‡§§‡§æ',
                'auth/user-disabled': '‡§Ø‡§π ‡§ñ‡§æ‡§§‡§æ ‡§®‡§ø‡§∑‡•ç‡§ï‡•ç‡§∞‡§ø‡§Ø ‡§ï‡§∞ ‡§¶‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§π‡•à',
                'auth/user-not-found': '‡§á‡§∏ ‡§à‡§Æ‡•á‡§≤ ‡§∏‡•á ‡§ï‡•ã‡§à ‡§ñ‡§æ‡§§‡§æ ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡§æ',
                'auth/wrong-password': '‡§ó‡§≤‡§§ ‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§°',
                'auth/email-already-in-use': '‡§à‡§Æ‡•á‡§≤ ‡§™‡§§‡§æ ‡§™‡§π‡§≤‡•á ‡§∏‡•á ‡§™‡§Ç‡§ú‡•Ä‡§ï‡•É‡§§ ‡§π‡•à',
                'auth/weak-password': '‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° ‡§ï‡§Æ ‡§∏‡•á ‡§ï‡§Æ 6 ‡§Ö‡§ï‡•ç‡§∑‡§∞ ‡§ï‡§æ ‡§π‡•ã‡§®‡§æ ‡§ö‡§æ‡§π‡§ø‡§è',
                'auth/network-request-failed': '‡§®‡•á‡§ü‡§µ‡§∞‡•ç‡§ï ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø‡•§ ‡§ï‡•É‡§™‡§Ø‡§æ ‡§Ö‡§™‡§®‡§æ ‡§á‡§Ç‡§ü‡§∞‡§®‡•á‡§ü ‡§ï‡§®‡•á‡§ï‡•ç‡§∂‡§® ‡§ú‡§æ‡§Ç‡§ö‡•á‡§Ç',
                'auth/too-many-requests': '‡§¨‡§π‡•Å‡§§ ‡§∏‡§æ‡§∞‡•á ‡§Ö‡§∏‡§´‡§≤ ‡§™‡•ç‡§∞‡§Ø‡§æ‡§∏‡•§ ‡§ï‡•É‡§™‡§Ø‡§æ ‡§¨‡§æ‡§¶ ‡§Æ‡•á‡§Ç ‡§ï‡•ã‡§∂‡§ø‡§∂ ‡§ï‡§∞‡•á‡§Ç',
                'auth/invalid-phone-number': '‡§ó‡§≤‡§§ ‡§´‡•ã‡§® ‡§®‡§Ç‡§¨‡§∞ ‡§´‡•â‡§∞‡•ç‡§Æ‡•á‡§ü',
                'auth/missing-phone-number': '‡§´‡•ã‡§® ‡§®‡§Ç‡§¨‡§∞ ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï ‡§π‡•à',
                'auth/quota-exceeded': 'SMS ‡§ï‡•ã‡§ü‡§æ ‡§∏‡§Æ‡§æ‡§™‡•ç‡§§‡•§ ‡§ï‡•É‡§™‡§Ø‡§æ ‡§¨‡§æ‡§¶ ‡§Æ‡•á‡§Ç ‡§ï‡•ã‡§∂‡§ø‡§∂ ‡§ï‡§∞‡•á‡§Ç'
            };
            
            return errorMessages[errorCode] || '‡§ï‡•ã‡§à ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø ‡§π‡•Å‡§à‡•§ ‡§ï‡•É‡§™‡§Ø‡§æ ‡§´‡§ø‡§∞ ‡§∏‡•á ‡§ï‡•ã‡§∂‡§ø‡§∂ ‡§ï‡§∞‡•á‡§Ç‡•§';
        }

        // Initialize when page loads
        window.addEventListener('load', () => {
            // Apply initial theme
            const savedTheme = JSON.parse(localStorage.getItem(STORAGE_KEYS.SETTINGS) || '{}').theme;
            if (savedTheme) {
                setTheme(savedTheme);
            }
            
            // Apply initial language
            const savedLanguage = JSON.parse(localStorage.getItem(STORAGE_KEYS.SETTINGS) || '{}').language || 'hi';
            changeLanguage(savedLanguage);
        });
    </script>
</body>
</html>
